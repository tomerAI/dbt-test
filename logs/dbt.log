[0m18:25:50.696448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241AC63FFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241AF37AC60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241AF37BD70>]}


============================== 18:25:50.701448 | a676ace5-e368-441a-a74c-61affbd8832b ==============================
[0m18:25:50.701448 [info ] [MainThread]: Running with dbt=1.8.6
[0m18:25:50.702449 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt init', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:25:55.404732 [debug] [MainThread]: Starter project path: C:\Users\Thomas\anaconda3\envs\dbtTest\Lib\site-packages\dbt\include\starter_project
[0m18:25:55.432735 [info ] [MainThread]: 
Your new dbt project "test_project" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m18:25:55.434734 [info ] [MainThread]: Setting up your profile.
[0m18:26:24.157884 [info ] [MainThread]: Profile test_project written to C:\Users\Thomas\OneDrive - Aarhus universitet\Data Engineering\dbt-test\profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m18:26:24.160395 [debug] [MainThread]: Command `dbt init` succeeded at 18:26:24.160395 after 33.62 seconds
[0m18:26:24.160395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241AFEE9730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241B014C170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000241B02444A0>]}
[0m18:26:24.161396 [debug] [MainThread]: Flushing usage events
[0m18:26:36.605950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B11DE359A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B11DC773B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B11D66F860>]}


============================== 18:26:36.609952 | d331975e-3eed-489a-b7c0-d928400d49b6 ==============================
[0m18:26:36.609952 [info ] [MainThread]: Running with dbt=1.8.6
[0m18:26:36.610951 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test', 'log_path': 'logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:26:36.636537 [info ] [MainThread]: dbt version: 1.8.6
[0m18:26:36.637537 [info ] [MainThread]: python version: 3.12.4
[0m18:26:36.638537 [info ] [MainThread]: python path: C:\Users\Thomas\anaconda3\envs\dbtTest\python.exe
[0m18:26:36.639538 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m18:26:36.747051 [info ] [MainThread]: Using profiles dir at C:\Users\Thomas\OneDrive - Aarhus universitet\Data Engineering\dbt-test
[0m18:26:36.748052 [info ] [MainThread]: Using profiles.yml file at C:\Users\Thomas\OneDrive - Aarhus universitet\Data Engineering\dbt-test\profiles.yml
[0m18:26:36.749052 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Thomas\OneDrive - Aarhus universitet\Data Engineering\dbt-test\dbt_project.yml
[0m18:26:36.750051 [info ] [MainThread]: adapter type: postgres
[0m18:26:36.751055 [info ] [MainThread]: adapter version: 1.8.2
[0m18:26:36.752056 [info ] [MainThread]: Configuration:
[0m18:26:36.753057 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:26:36.754056 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m18:26:36.755055 [info ] [MainThread]: Required dependencies:
[0m18:26:36.755055 [debug] [MainThread]: Executing "git --help"
[0m18:26:36.825075 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:26:36.826077 [debug] [MainThread]: STDERR: "b''"
[0m18:26:36.827073 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:26:36.828073 [info ] [MainThread]: Connection:
[0m18:26:36.828073 [info ] [MainThread]:   host: localhost
[0m18:26:36.829074 [info ] [MainThread]:   port: 5432
[0m18:26:36.830074 [info ] [MainThread]:   user: postgres
[0m18:26:36.831073 [info ] [MainThread]:   database: test_db
[0m18:26:36.831073 [info ] [MainThread]:   schema: public
[0m18:26:36.832618 [info ] [MainThread]:   connect_timeout: 10
[0m18:26:36.833626 [info ] [MainThread]:   role: None
[0m18:26:36.833626 [info ] [MainThread]:   search_path: None
[0m18:26:36.834625 [info ] [MainThread]:   keepalives_idle: 0
[0m18:26:36.835626 [info ] [MainThread]:   sslmode: None
[0m18:26:36.836624 [info ] [MainThread]:   sslcert: None
[0m18:26:36.836624 [info ] [MainThread]:   sslkey: None
[0m18:26:36.837624 [info ] [MainThread]:   sslrootcert: None
[0m18:26:36.838625 [info ] [MainThread]:   application_name: dbt
[0m18:26:36.838625 [info ] [MainThread]:   retries: 1
[0m18:26:36.839626 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:26:36.840626 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:26:37.016657 [debug] [MainThread]: Using postgres connection "debug"
[0m18:26:37.017656 [debug] [MainThread]: On debug: select 1 as id
[0m18:26:37.017656 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:26:37.097738 [debug] [MainThread]: SQL status: SELECT 1 in 0.080 seconds
[0m18:26:37.099734 [debug] [MainThread]: On debug: Close
[0m18:26:37.100734 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:26:37.101733 [info ] [MainThread]: [31m1 check failed:[0m
[0m18:26:37.102735 [info ] [MainThread]: Project loading failed for the following reason:
 project path <C:\Users\Thomas\OneDrive - Aarhus universitet\Data Engineering\dbt-test\dbt_project.yml> not found

[0m18:26:37.104733 [debug] [MainThread]: Command `dbt debug` failed at 18:26:37.104733 after 0.64 seconds
[0m18:26:37.104733 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:26:37.105732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B11DBD36B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B11D66F860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B11DD3CCB0>]}
[0m18:26:37.105732 [debug] [MainThread]: Flushing usage events
[0m18:28:17.384940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB8E658E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB9116A240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB91168D40>]}


============================== 18:28:17.389941 | 811897c0-dc17-4f0b-9ad8-92919b21346c ==============================
[0m18:28:17.389941 [info ] [MainThread]: Running with dbt=1.8.6
[0m18:28:17.390942 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:28:17.413446 [info ] [MainThread]: dbt version: 1.8.6
[0m18:28:17.414452 [info ] [MainThread]: python version: 3.12.4
[0m18:28:17.415452 [info ] [MainThread]: python path: C:\Users\Thomas\anaconda3\envs\dbtTest\python.exe
[0m18:28:17.416452 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m18:28:17.508036 [info ] [MainThread]: Using profiles dir at C:\Users\Thomas\OneDrive - Aarhus universitet\Data Engineering\dbt-test
[0m18:28:17.509036 [info ] [MainThread]: Using profiles.yml file at C:\Users\Thomas\OneDrive - Aarhus universitet\Data Engineering\dbt-test\profiles.yml
[0m18:28:17.510038 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Thomas\OneDrive - Aarhus universitet\Data Engineering\dbt-test\dbt_project.yml
[0m18:28:17.512037 [info ] [MainThread]: adapter type: postgres
[0m18:28:17.512037 [info ] [MainThread]: adapter version: 1.8.2
[0m18:28:17.513541 [info ] [MainThread]: Configuration:
[0m18:28:17.514548 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:28:17.514548 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m18:28:17.515547 [info ] [MainThread]: Required dependencies:
[0m18:28:17.516549 [debug] [MainThread]: Executing "git --help"
[0m18:28:17.582548 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:28:17.583547 [debug] [MainThread]: STDERR: "b''"
[0m18:28:17.584547 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:28:17.585547 [info ] [MainThread]: Connection:
[0m18:28:17.586547 [info ] [MainThread]:   host: localhost
[0m18:28:17.586547 [info ] [MainThread]:   port: 5432
[0m18:28:17.587547 [info ] [MainThread]:   user: postgres
[0m18:28:17.588547 [info ] [MainThread]:   database: test_db
[0m18:28:17.589547 [info ] [MainThread]:   schema: public
[0m18:28:17.589547 [info ] [MainThread]:   connect_timeout: 10
[0m18:28:17.590552 [info ] [MainThread]:   role: None
[0m18:28:17.591552 [info ] [MainThread]:   search_path: None
[0m18:28:17.591552 [info ] [MainThread]:   keepalives_idle: 0
[0m18:28:17.592552 [info ] [MainThread]:   sslmode: None
[0m18:28:17.593551 [info ] [MainThread]:   sslcert: None
[0m18:28:17.593551 [info ] [MainThread]:   sslkey: None
[0m18:28:17.594547 [info ] [MainThread]:   sslrootcert: None
[0m18:28:17.595547 [info ] [MainThread]:   application_name: dbt
[0m18:28:17.596549 [info ] [MainThread]:   retries: 1
[0m18:28:17.597548 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:28:17.598547 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:28:17.763150 [debug] [MainThread]: Using postgres connection "debug"
[0m18:28:17.764150 [debug] [MainThread]: On debug: select 1 as id
[0m18:28:17.765151 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:28:17.847121 [debug] [MainThread]: SQL status: SELECT 1 in 0.082 seconds
[0m18:28:17.849121 [debug] [MainThread]: On debug: Close
[0m18:28:17.849121 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:28:17.850119 [info ] [MainThread]: [31m1 check failed:[0m
[0m18:28:17.851120 [info ] [MainThread]: Project loading failed for the following reason:
 project path <C:\Users\Thomas\OneDrive - Aarhus universitet\Data Engineering\dbt-test\dbt_project.yml> not found

[0m18:28:17.853122 [debug] [MainThread]: Command `dbt debug` failed at 18:28:17.853122 after 0.62 seconds
[0m18:28:17.854120 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:28:17.855119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB90440680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB8E658E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB911BF230>]}
[0m18:28:17.856119 [debug] [MainThread]: Flushing usage events
[0m18:28:37.217853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEADBB2EA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEADBB1850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEADBB3800>]}


============================== 18:28:37.222356 | 2a1e6162-00b1-4ad6-9f38-c0f6a1bd3a84 ==============================
[0m18:28:37.222356 [info ] [MainThread]: Running with dbt=1.8.6
[0m18:28:37.223361 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:28:37.245360 [info ] [MainThread]: dbt version: 1.8.6
[0m18:28:37.246360 [info ] [MainThread]: python version: 3.12.4
[0m18:28:37.247366 [info ] [MainThread]: python path: C:\Users\Thomas\anaconda3\envs\dbtTest\python.exe
[0m18:28:37.248363 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m18:28:37.337415 [info ] [MainThread]: Using profiles dir at C:\Users\Thomas\OneDrive - Aarhus universitet\Data Engineering\dbt-test
[0m18:28:37.338420 [info ] [MainThread]: Using profiles.yml file at C:\Users\Thomas\OneDrive - Aarhus universitet\Data Engineering\dbt-test\profiles.yml
[0m18:28:37.339417 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Thomas\OneDrive - Aarhus universitet\Data Engineering\dbt-test\dbt_project.yml
[0m18:28:37.340414 [info ] [MainThread]: adapter type: postgres
[0m18:28:37.341414 [info ] [MainThread]: adapter version: 1.8.2
[0m18:28:37.414419 [info ] [MainThread]: Configuration:
[0m18:28:37.415419 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:28:37.416422 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:28:37.417420 [info ] [MainThread]: Required dependencies:
[0m18:28:37.418419 [debug] [MainThread]: Executing "git --help"
[0m18:28:37.484518 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:28:37.485518 [debug] [MainThread]: STDERR: "b''"
[0m18:28:37.486519 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:28:37.487519 [info ] [MainThread]: Connection:
[0m18:28:37.487519 [info ] [MainThread]:   host: localhost
[0m18:28:37.488518 [info ] [MainThread]:   port: 5432
[0m18:28:37.489518 [info ] [MainThread]:   user: postgres
[0m18:28:37.490518 [info ] [MainThread]:   database: test_db
[0m18:28:37.490518 [info ] [MainThread]:   schema: public
[0m18:28:37.491518 [info ] [MainThread]:   connect_timeout: 10
[0m18:28:37.492523 [info ] [MainThread]:   role: None
[0m18:28:37.492523 [info ] [MainThread]:   search_path: None
[0m18:28:37.493519 [info ] [MainThread]:   keepalives_idle: 0
[0m18:28:37.494519 [info ] [MainThread]:   sslmode: None
[0m18:28:37.495521 [info ] [MainThread]:   sslcert: None
[0m18:28:37.495521 [info ] [MainThread]:   sslkey: None
[0m18:28:37.496522 [info ] [MainThread]:   sslrootcert: None
[0m18:28:37.497520 [info ] [MainThread]:   application_name: dbt
[0m18:28:37.498525 [info ] [MainThread]:   retries: 1
[0m18:28:37.499522 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:28:37.500518 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:28:37.667114 [debug] [MainThread]: Using postgres connection "debug"
[0m18:28:37.668116 [debug] [MainThread]: On debug: select 1 as id
[0m18:28:37.668116 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:28:37.746634 [debug] [MainThread]: SQL status: SELECT 1 in 0.078 seconds
[0m18:28:37.747634 [debug] [MainThread]: On debug: Close
[0m18:28:37.748634 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:28:37.749635 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:28:37.751637 [debug] [MainThread]: Command `dbt debug` succeeded at 18:28:37.751637 after 0.67 seconds
[0m18:28:37.752636 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:28:37.752636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEAD99C4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEABAD2180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BEAE7AA5A0>]}
[0m18:28:37.753635 [debug] [MainThread]: Flushing usage events
[0m19:15:01.517443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169ECC6F170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169EC1F10A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169EC752DE0>]}


============================== 19:15:01.521448 | b056b6f2-1795-4e43-8bfc-a3291de9ff9e ==============================
[0m19:15:01.521448 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:15:01.522448 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test', 'log_path': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:15:01.733997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b056b6f2-1795-4e43-8bfc-a3291de9ff9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169ECDF4560>]}
[0m19:15:01.782480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b056b6f2-1795-4e43-8bfc-a3291de9ff9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169ECF85430>]}
[0m19:15:01.784484 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:15:01.791993 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m19:15:01.793996 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:15:01.793996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b056b6f2-1795-4e43-8bfc-a3291de9ff9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169ED115970>]}
[0m19:15:02.503762 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.test_project.example
[0m19:15:02.508273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b056b6f2-1795-4e43-8bfc-a3291de9ff9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169ED486D20>]}
[0m19:15:02.582870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b056b6f2-1795-4e43-8bfc-a3291de9ff9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169ED485370>]}
[0m19:15:02.584866 [info ] [MainThread]: Found 417 macros
[0m19:15:02.585371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b056b6f2-1795-4e43-8bfc-a3291de9ff9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169ED46A780>]}
[0m19:15:02.587378 [info ] [MainThread]: 
[0m19:15:02.587378 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:15:02.588378 [debug] [MainThread]: Command end result
[0m19:15:02.616919 [debug] [MainThread]: Command `dbt run` succeeded at 19:15:02.616919 after 1.28 seconds
[0m19:15:02.617919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169EC5ACA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169E9523A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169EC2B7680>]}
[0m19:15:02.618918 [debug] [MainThread]: Flushing usage events
[0m19:21:08.927968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDFA858C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDFD255A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDF9972330>]}


============================== 19:21:08.932481 | bb01e56b-fe82-4761-a9c4-c9b92107a031 ==============================
[0m19:21:08.932481 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:21:08.933486 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:21:09.149003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb01e56b-fe82-4761-a9c4-c9b92107a031', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDFD48E480>]}
[0m19:21:09.197811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb01e56b-fe82-4761-a9c4-c9b92107a031', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDFC9F2420>]}
[0m19:21:09.200323 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:21:09.208326 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m19:21:09.346935 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:21:09.346935 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:21:09.347940 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.test_project.example
[0m19:21:09.353448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb01e56b-fe82-4761-a9c4-c9b92107a031', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDFD645460>]}
[0m19:21:09.425803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb01e56b-fe82-4761-a9c4-c9b92107a031', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDFE7DA330>]}
[0m19:21:09.426805 [info ] [MainThread]: Found 417 macros
[0m19:21:09.427806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb01e56b-fe82-4761-a9c4-c9b92107a031', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDFE7C18B0>]}
[0m19:21:09.429806 [info ] [MainThread]: 
[0m19:21:09.429806 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:21:09.432808 [debug] [MainThread]: Command end result
[0m19:21:09.458483 [debug] [MainThread]: Command `dbt run` succeeded at 19:21:09.458483 after 0.68 seconds
[0m19:21:09.458483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDFD255A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDFD759EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDFD0976E0>]}
[0m19:21:09.459987 [debug] [MainThread]: Flushing usage events
[0m19:22:52.247816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0C96C1AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0CB9719A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0CC189E20>]}


============================== 19:22:52.251337 | 2228a136-bdfc-4812-bd48-f74343c90fa8 ==============================
[0m19:22:52.251337 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:22:52.252334 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:22:52.453923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2228a136-bdfc-4812-bd48-f74343c90fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0CC4E2B40>]}
[0m19:22:52.500009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2228a136-bdfc-4812-bd48-f74343c90fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0CBB41FD0>]}
[0m19:22:52.502009 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:22:52.510040 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m19:22:52.643498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:22:52.643498 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:22:52.645002 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.test_project.example
[0m19:22:52.650007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2228a136-bdfc-4812-bd48-f74343c90fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0CC7BFF20>]}
[0m19:22:52.732267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2228a136-bdfc-4812-bd48-f74343c90fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0CDA7E810>]}
[0m19:22:52.732267 [info ] [MainThread]: Found 417 macros
[0m19:22:52.733266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2228a136-bdfc-4812-bd48-f74343c90fa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0CC86DCA0>]}
[0m19:22:52.735270 [info ] [MainThread]: 
[0m19:22:52.736339 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:22:52.738265 [debug] [MainThread]: Command end result
[0m19:22:52.763606 [debug] [MainThread]: Command `dbt test` succeeded at 19:22:52.763606 after 0.66 seconds
[0m19:22:52.764604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0C96C1AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0CB4D3B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0CC496FF0>]}
[0m19:22:52.765108 [debug] [MainThread]: Flushing usage events
[0m19:23:55.498937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE19645670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE16C7CB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE18E83830>]}


============================== 19:23:55.503506 | c5c0590b-5e76-4242-b2ee-8aeebf12e819 ==============================
[0m19:23:55.503506 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:23:55.505011 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:23:55.712749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5c0590b-5e76-4242-b2ee-8aeebf12e819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE1957C560>]}
[0m19:23:55.760224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5c0590b-5e76-4242-b2ee-8aeebf12e819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE171A2FC0>]}
[0m19:23:55.762224 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:23:55.769832 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m19:23:55.907731 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:23:55.908729 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:23:55.908729 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.test_project.example
[0m19:23:55.914239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5c0590b-5e76-4242-b2ee-8aeebf12e819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE196456A0>]}
[0m19:23:55.984867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5c0590b-5e76-4242-b2ee-8aeebf12e819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE1ABB6420>]}
[0m19:23:55.984867 [info ] [MainThread]: Found 417 macros
[0m19:23:55.986110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5c0590b-5e76-4242-b2ee-8aeebf12e819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE19A442C0>]}
[0m19:23:55.988109 [info ] [MainThread]: 
[0m19:23:55.989110 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:23:55.990621 [debug] [MainThread]: Command end result
[0m19:23:56.015766 [debug] [MainThread]: Command `dbt run` succeeded at 19:23:56.015766 after 0.67 seconds
[0m19:23:56.016687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE19330E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE193A82F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE1ABAF410>]}
[0m19:23:56.017686 [debug] [MainThread]: Flushing usage events
[0m19:24:15.317623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4515B5FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C44DCC25D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C451407980>]}


============================== 19:24:15.321629 | eae8f02e-9443-4b50-b0dd-48d86ffee87d ==============================
[0m19:24:15.321629 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:24:15.322628 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:24:15.527011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eae8f02e-9443-4b50-b0dd-48d86ffee87d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4516D2A50>]}
[0m19:24:15.572883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eae8f02e-9443-4b50-b0dd-48d86ffee87d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C451407980>]}
[0m19:24:15.574882 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:24:15.581881 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m19:24:15.717499 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:24:15.718499 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:24:15.719502 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.test_project.example
[0m19:24:15.723502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eae8f02e-9443-4b50-b0dd-48d86ffee87d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4518C6E10>]}
[0m19:24:15.796131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eae8f02e-9443-4b50-b0dd-48d86ffee87d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C451B3A4E0>]}
[0m19:24:15.796131 [info ] [MainThread]: Found 417 macros
[0m19:24:15.797638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eae8f02e-9443-4b50-b0dd-48d86ffee87d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4517A3E00>]}
[0m19:24:15.799643 [info ] [MainThread]: 
[0m19:24:15.799643 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:24:15.801643 [debug] [MainThread]: Command end result
[0m19:24:15.827686 [debug] [MainThread]: Command `dbt run` succeeded at 19:24:15.827686 after 0.65 seconds
[0m19:24:15.828690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4514F7C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4514F57C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4516D30E0>]}
[0m19:24:15.828690 [debug] [MainThread]: Flushing usage events
[0m19:24:56.498021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001667DEBF9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001660104D820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001660104FF20>]}


============================== 19:24:56.502020 | ae9d6f67-0b5b-4859-b60a-7032e9d98f37 ==============================
[0m19:24:56.502020 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:24:56.503022 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test', 'log_path': 'logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:24:56.504021 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path C:\Users\Thomas\OneDrive - Aarhus universitet\Data Engineering\dbt-test\dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m19:24:56.506021 [debug] [MainThread]: Command `dbt run` failed at 19:24:56.506021 after 0.15 seconds
[0m19:24:56.506021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001667FD43620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001667DEBF9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166017C1730>]}
[0m19:24:56.507022 [debug] [MainThread]: Flushing usage events
[0m19:25:08.333263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019096088E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019098823440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190988235C0>]}


============================== 19:25:08.338261 | c033cafe-be23-4159-ab6a-1dff012aabe0 ==============================
[0m19:25:08.338261 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:25:08.339261 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test', 'log_path': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:25:08.560404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c033cafe-be23-4159-ab6a-1dff012aabe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019092BF2BD0>]}
[0m19:25:08.614743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c033cafe-be23-4159-ab6a-1dff012aabe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190965AF020>]}
[0m19:25:08.616893 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:25:08.626220 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m19:25:08.772002 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:25:08.772523 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:25:08.773558 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.test_project.example
[0m19:25:08.778824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c033cafe-be23-4159-ab6a-1dff012aabe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019098DB2450>]}
[0m19:25:08.853168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c033cafe-be23-4159-ab6a-1dff012aabe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019099FAA420>]}
[0m19:25:08.854168 [info ] [MainThread]: Found 417 macros
[0m19:25:08.855173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c033cafe-be23-4159-ab6a-1dff012aabe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019098DE42C0>]}
[0m19:25:08.856239 [info ] [MainThread]: 
[0m19:25:08.857175 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:25:08.859681 [debug] [MainThread]: Command end result
[0m19:25:08.884812 [debug] [MainThread]: Command `dbt run` succeeded at 19:25:08.884812 after 0.70 seconds
[0m19:25:08.885809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190989EF9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190982EC590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019098E35430>]}
[0m19:25:08.886809 [debug] [MainThread]: Flushing usage events
[0m19:25:39.959468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DDAF565D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DDC9F8C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DDD0B8D40>]}


============================== 19:25:39.963470 | a3c750d1-7242-4574-87e0-fb79483c057d ==============================
[0m19:25:39.963470 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:25:39.964465 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:25:40.173523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3c750d1-7242-4574-87e0-fb79483c057d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DDD566210>]}
[0m19:25:40.224034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3c750d1-7242-4574-87e0-fb79483c057d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DDD496810>]}
[0m19:25:40.226040 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:25:40.236044 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m19:25:40.271637 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:25:40.272638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a3c750d1-7242-4574-87e0-fb79483c057d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DDCC821E0>]}
[0m19:25:41.301572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3c750d1-7242-4574-87e0-fb79483c057d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DDDA8A900>]}
[0m19:25:41.398801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3c750d1-7242-4574-87e0-fb79483c057d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DDD836BD0>]}
[0m19:25:41.399801 [info ] [MainThread]: Found 3 models, 4 data tests, 417 macros
[0m19:25:41.400800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3c750d1-7242-4574-87e0-fb79483c057d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DDD99DCD0>]}
[0m19:25:41.402305 [info ] [MainThread]: 
[0m19:25:41.403310 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:25:41.406377 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_db'
[0m19:25:41.586136 [debug] [ThreadPool]: Using postgres connection "list_test_db"
[0m19:25:41.586136 [debug] [ThreadPool]: On list_test_db: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "list_test_db"} */

    select distinct nspname from pg_namespace
  
[0m19:25:41.587136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:25:41.666493 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.080 seconds
[0m19:25:41.668436 [debug] [ThreadPool]: On list_test_db: Close
[0m19:25:41.670436 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_db_public'
[0m19:25:41.675948 [debug] [ThreadPool]: Using postgres connection "list_test_db_public"
[0m19:25:41.676949 [debug] [ThreadPool]: On list_test_db_public: BEGIN
[0m19:25:41.677949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:25:41.848445 [debug] [ThreadPool]: SQL status: BEGIN in 0.171 seconds
[0m19:25:41.849449 [debug] [ThreadPool]: Using postgres connection "list_test_db_public"
[0m19:25:41.849449 [debug] [ThreadPool]: On list_test_db_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "list_test_db_public"} */
select
      'test_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'test_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:25:41.854955 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m19:25:41.856955 [debug] [ThreadPool]: On list_test_db_public: ROLLBACK
[0m19:25:41.856955 [debug] [ThreadPool]: On list_test_db_public: Close
[0m19:25:41.861465 [debug] [MainThread]: Using postgres connection "master"
[0m19:25:41.862464 [debug] [MainThread]: On master: BEGIN
[0m19:25:41.862464 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:25:41.937719 [debug] [MainThread]: SQL status: BEGIN in 0.075 seconds
[0m19:25:41.938245 [debug] [MainThread]: Using postgres connection "master"
[0m19:25:41.939290 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:25:41.944958 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m19:25:41.946015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3c750d1-7242-4574-87e0-fb79483c057d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DDDA8A600>]}
[0m19:25:41.946957 [debug] [MainThread]: On master: ROLLBACK
[0m19:25:41.946957 [debug] [MainThread]: Using postgres connection "master"
[0m19:25:41.948263 [debug] [MainThread]: On master: BEGIN
[0m19:25:41.949292 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:25:41.949816 [debug] [MainThread]: On master: COMMIT
[0m19:25:41.950340 [debug] [MainThread]: Using postgres connection "master"
[0m19:25:41.950862 [debug] [MainThread]: On master: COMMIT
[0m19:25:41.951386 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:25:41.951940 [debug] [MainThread]: On master: Close
[0m19:25:41.952990 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:25:41.953521 [info ] [MainThread]: 
[0m19:25:41.957725 [debug] [Thread-1 (]: Began running node model.test_project.example_model
[0m19:25:41.958244 [info ] [Thread-1 (]: 1 of 3 START sql view model public.example_model ............................... [RUN]
[0m19:25:41.959283 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.test_project.example_model'
[0m19:25:41.960341 [debug] [Thread-1 (]: Began compiling node model.test_project.example_model
[0m19:25:41.966272 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_project.example_model"
[0m19:25:41.970453 [debug] [Thread-1 (]: Began executing node model.test_project.example_model
[0m19:25:42.001923 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_project.example_model"
[0m19:25:42.006168 [debug] [Thread-1 (]: Using postgres connection "model.test_project.example_model"
[0m19:25:42.006690 [debug] [Thread-1 (]: On model.test_project.example_model: BEGIN
[0m19:25:42.007223 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:25:42.079144 [debug] [Thread-1 (]: SQL status: BEGIN in 0.072 seconds
[0m19:25:42.080147 [debug] [Thread-1 (]: Using postgres connection "model.test_project.example_model"
[0m19:25:42.081147 [debug] [Thread-1 (]: On model.test_project.example_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.example_model"} */

  create view "test_db"."public"."example_model__dbt_tmp"
    
    
  as (
    -- models/example_model.sql

select 1 as id, 'dbt' as name
  );
[0m19:25:42.085144 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m19:25:42.090656 [debug] [Thread-1 (]: Using postgres connection "model.test_project.example_model"
[0m19:25:42.091656 [debug] [Thread-1 (]: On model.test_project.example_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.example_model"} */
alter table "test_db"."public"."example_model__dbt_tmp" rename to "example_model"
[0m19:25:42.092658 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:25:42.105692 [debug] [Thread-1 (]: On model.test_project.example_model: COMMIT
[0m19:25:42.106692 [debug] [Thread-1 (]: Using postgres connection "model.test_project.example_model"
[0m19:25:42.107695 [debug] [Thread-1 (]: On model.test_project.example_model: COMMIT
[0m19:25:42.108862 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:25:42.114872 [debug] [Thread-1 (]: Applying DROP to: "test_db"."public"."example_model__dbt_backup"
[0m19:25:42.119118 [debug] [Thread-1 (]: Using postgres connection "model.test_project.example_model"
[0m19:25:42.120675 [debug] [Thread-1 (]: On model.test_project.example_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.example_model"} */
drop view if exists "test_db"."public"."example_model__dbt_backup" cascade
[0m19:25:42.120675 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m19:25:42.123188 [debug] [Thread-1 (]: On model.test_project.example_model: Close
[0m19:25:42.124192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3c750d1-7242-4574-87e0-fb79483c057d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DDAF9E3F0>]}
[0m19:25:42.125187 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.example_model .......................... [[32mCREATE VIEW[0m in 0.16s]
[0m19:25:42.126188 [debug] [Thread-1 (]: Finished running node model.test_project.example_model
[0m19:25:42.127693 [debug] [Thread-1 (]: Began running node model.test_project.my_first_dbt_model
[0m19:25:42.127693 [info ] [Thread-1 (]: 2 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m19:25:42.128697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.test_project.example_model, now model.test_project.my_first_dbt_model)
[0m19:25:42.129698 [debug] [Thread-1 (]: Began compiling node model.test_project.my_first_dbt_model
[0m19:25:42.183790 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_project.my_first_dbt_model"
[0m19:25:42.187307 [debug] [Thread-1 (]: Began executing node model.test_project.my_first_dbt_model
[0m19:25:42.205341 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_project.my_first_dbt_model"
[0m19:25:42.208459 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_first_dbt_model"
[0m19:25:42.209460 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: BEGIN
[0m19:25:42.210459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:25:42.285363 [debug] [Thread-1 (]: SQL status: BEGIN in 0.076 seconds
[0m19:25:42.286429 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_first_dbt_model"
[0m19:25:42.287369 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.my_first_dbt_model"} */

  
    

  create  table "test_db"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m19:25:42.290881 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m19:25:42.293884 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_first_dbt_model"
[0m19:25:42.294883 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.my_first_dbt_model"} */
alter table "test_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:25:42.296884 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:25:42.300914 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: COMMIT
[0m19:25:42.301915 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_first_dbt_model"
[0m19:25:42.302915 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: COMMIT
[0m19:25:42.303913 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:25:42.305914 [debug] [Thread-1 (]: Applying DROP to: "test_db"."public"."my_first_dbt_model__dbt_backup"
[0m19:25:42.308434 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_first_dbt_model"
[0m19:25:42.309434 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.my_first_dbt_model"} */
drop table if exists "test_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m19:25:42.310433 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m19:25:42.311947 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: Close
[0m19:25:42.311947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3c750d1-7242-4574-87e0-fb79483c057d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DDED00CE0>]}
[0m19:25:42.312946 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.18s]
[0m19:25:42.313946 [debug] [Thread-1 (]: Finished running node model.test_project.my_first_dbt_model
[0m19:25:42.314946 [debug] [Thread-1 (]: Began running node model.test_project.my_second_dbt_model
[0m19:25:42.315947 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m19:25:42.315947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.test_project.my_first_dbt_model, now model.test_project.my_second_dbt_model)
[0m19:25:42.317498 [debug] [Thread-1 (]: Began compiling node model.test_project.my_second_dbt_model
[0m19:25:42.319507 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_project.my_second_dbt_model"
[0m19:25:42.323014 [debug] [Thread-1 (]: Began executing node model.test_project.my_second_dbt_model
[0m19:25:42.326020 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_project.my_second_dbt_model"
[0m19:25:42.328022 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_second_dbt_model"
[0m19:25:42.329021 [debug] [Thread-1 (]: On model.test_project.my_second_dbt_model: BEGIN
[0m19:25:42.329527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:25:42.407684 [debug] [Thread-1 (]: SQL status: BEGIN in 0.079 seconds
[0m19:25:42.408693 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_second_dbt_model"
[0m19:25:42.409692 [debug] [Thread-1 (]: On model.test_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.my_second_dbt_model"} */

  create view "test_db"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "test_db"."public"."my_first_dbt_model"
where id = 1
  );
[0m19:25:42.412688 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:25:42.415749 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_second_dbt_model"
[0m19:25:42.415749 [debug] [Thread-1 (]: On model.test_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.my_second_dbt_model"} */
alter table "test_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:25:42.417203 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:25:42.418209 [debug] [Thread-1 (]: On model.test_project.my_second_dbt_model: COMMIT
[0m19:25:42.419208 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_second_dbt_model"
[0m19:25:42.420211 [debug] [Thread-1 (]: On model.test_project.my_second_dbt_model: COMMIT
[0m19:25:42.421211 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:25:42.423212 [debug] [Thread-1 (]: Applying DROP to: "test_db"."public"."my_second_dbt_model__dbt_backup"
[0m19:25:42.424209 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_second_dbt_model"
[0m19:25:42.424209 [debug] [Thread-1 (]: On model.test_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.my_second_dbt_model"} */
drop view if exists "test_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m19:25:42.425210 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m19:25:42.427210 [debug] [Thread-1 (]: On model.test_project.my_second_dbt_model: Close
[0m19:25:42.427210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3c750d1-7242-4574-87e0-fb79483c057d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DDEABD550>]}
[0m19:25:42.428265 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.11s]
[0m19:25:42.430272 [debug] [Thread-1 (]: Finished running node model.test_project.my_second_dbt_model
[0m19:25:42.431271 [debug] [MainThread]: Using postgres connection "master"
[0m19:25:42.432272 [debug] [MainThread]: On master: BEGIN
[0m19:25:42.432272 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:25:42.508618 [debug] [MainThread]: SQL status: BEGIN in 0.076 seconds
[0m19:25:42.509616 [debug] [MainThread]: On master: COMMIT
[0m19:25:42.510614 [debug] [MainThread]: Using postgres connection "master"
[0m19:25:42.511616 [debug] [MainThread]: On master: COMMIT
[0m19:25:42.513616 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:25:42.513616 [debug] [MainThread]: On master: Close
[0m19:25:42.514615 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:25:42.515620 [debug] [MainThread]: Connection 'list_test_db' was properly closed.
[0m19:25:42.515688 [debug] [MainThread]: Connection 'list_test_db_public' was properly closed.
[0m19:25:42.516614 [debug] [MainThread]: Connection 'model.test_project.my_second_dbt_model' was properly closed.
[0m19:25:42.516614 [info ] [MainThread]: 
[0m19:25:42.517657 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 1.11 seconds (1.11s).
[0m19:25:42.518658 [debug] [MainThread]: Command end result
[0m19:25:42.548349 [info ] [MainThread]: 
[0m19:25:42.549352 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:25:42.550354 [info ] [MainThread]: 
[0m19:25:42.551350 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m19:25:42.552349 [debug] [MainThread]: Command `dbt run` succeeded at 19:25:42.552349 after 2.74 seconds
[0m19:25:42.553348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DDD12FD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DDD10B770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DD9BB2450>]}
[0m19:25:42.554352 [debug] [MainThread]: Flushing usage events
[0m19:31:01.632487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209CEF0FB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209D1427560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209D1427F80>]}


============================== 19:31:01.636997 | 8bb4284e-bf2f-4c2c-8b5d-4229d2b71a9d ==============================
[0m19:31:01.636997 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:31:01.637998 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test\\logs', 'profiles_dir': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:31:01.849405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8bb4284e-bf2f-4c2c-8b5d-4229d2b71a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209D1406210>]}
[0m19:31:01.898892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8bb4284e-bf2f-4c2c-8b5d-4229d2b71a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209D1452D50>]}
[0m19:31:01.900892 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:31:01.909403 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m19:31:02.092872 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:31:02.093873 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:31:02.123967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8bb4284e-bf2f-4c2c-8b5d-4229d2b71a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209D17FF800>]}
[0m19:31:02.230420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8bb4284e-bf2f-4c2c-8b5d-4229d2b71a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209D2B0D8E0>]}
[0m19:31:02.231416 [info ] [MainThread]: Found 3 models, 4 data tests, 417 macros
[0m19:31:02.232422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bb4284e-bf2f-4c2c-8b5d-4229d2b71a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209D294BD40>]}
[0m19:31:02.234927 [info ] [MainThread]: 
[0m19:31:02.235933 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:31:02.239932 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_db_public'
[0m19:31:02.535630 [debug] [ThreadPool]: Using postgres connection "list_test_db_public"
[0m19:31:02.536680 [debug] [ThreadPool]: On list_test_db_public: BEGIN
[0m19:31:02.537208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:31:02.620150 [debug] [ThreadPool]: SQL status: BEGIN in 0.084 seconds
[0m19:31:02.621152 [debug] [ThreadPool]: Using postgres connection "list_test_db_public"
[0m19:31:02.622151 [debug] [ThreadPool]: On list_test_db_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "list_test_db_public"} */
select
      'test_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'test_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:31:02.627665 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m19:31:02.629670 [debug] [ThreadPool]: On list_test_db_public: ROLLBACK
[0m19:31:02.630668 [debug] [ThreadPool]: On list_test_db_public: Close
[0m19:31:02.636184 [debug] [MainThread]: Using postgres connection "master"
[0m19:31:02.636184 [debug] [MainThread]: On master: BEGIN
[0m19:31:02.637184 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:31:02.714562 [debug] [MainThread]: SQL status: BEGIN in 0.077 seconds
[0m19:31:02.715607 [debug] [MainThread]: Using postgres connection "master"
[0m19:31:02.716662 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:31:02.722946 [debug] [MainThread]: SQL status: SELECT 1 in 0.006 seconds
[0m19:31:02.724523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bb4284e-bf2f-4c2c-8b5d-4229d2b71a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209D170FEF0>]}
[0m19:31:02.725033 [debug] [MainThread]: On master: ROLLBACK
[0m19:31:02.726081 [debug] [MainThread]: Using postgres connection "master"
[0m19:31:02.726665 [debug] [MainThread]: On master: BEGIN
[0m19:31:02.727704 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:31:02.728230 [debug] [MainThread]: On master: COMMIT
[0m19:31:02.729292 [debug] [MainThread]: Using postgres connection "master"
[0m19:31:02.729824 [debug] [MainThread]: On master: COMMIT
[0m19:31:02.730355 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:31:02.731664 [debug] [MainThread]: On master: Close
[0m19:31:02.732169 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:31:02.733035 [info ] [MainThread]: 
[0m19:31:02.738094 [debug] [Thread-1 (]: Began running node test.test_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:31:02.739093 [info ] [Thread-1 (]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m19:31:02.740096 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.test_project.not_null_my_first_dbt_model_id.5fb22c2710'
[0m19:31:02.741096 [debug] [Thread-1 (]: Began compiling node test.test_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:31:02.756225 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:31:02.760225 [debug] [Thread-1 (]: Began executing node test.test_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:31:02.775245 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:31:02.778763 [debug] [Thread-1 (]: Using postgres connection "test.test_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:31:02.779761 [debug] [Thread-1 (]: On test.test_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m19:31:02.780759 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:31:02.855472 [debug] [Thread-1 (]: SQL status: BEGIN in 0.075 seconds
[0m19:31:02.856480 [debug] [Thread-1 (]: Using postgres connection "test.test_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:31:02.857481 [debug] [Thread-1 (]: On test.test_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "test.test_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "test_db"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m19:31:02.858480 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:31:02.863481 [debug] [Thread-1 (]: On test.test_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m19:31:02.863481 [debug] [Thread-1 (]: On test.test_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m19:31:02.864989 [error] [Thread-1 (]: 1 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.12s]
[0m19:31:02.865997 [debug] [Thread-1 (]: Finished running node test.test_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:31:02.866994 [debug] [Thread-1 (]: Began running node test.test_project.not_null_my_second_dbt_model_id.151b76d778
[0m19:31:02.867995 [info ] [Thread-1 (]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m19:31:02.868995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_project.not_null_my_first_dbt_model_id.5fb22c2710, now test.test_project.not_null_my_second_dbt_model_id.151b76d778)
[0m19:31:02.868995 [debug] [Thread-1 (]: Began compiling node test.test_project.not_null_my_second_dbt_model_id.151b76d778
[0m19:31:02.872994 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_project.not_null_my_second_dbt_model_id.151b76d778"
[0m19:31:02.876513 [debug] [Thread-1 (]: Began executing node test.test_project.not_null_my_second_dbt_model_id.151b76d778
[0m19:31:02.879033 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_project.not_null_my_second_dbt_model_id.151b76d778"
[0m19:31:02.881030 [debug] [Thread-1 (]: Using postgres connection "test.test_project.not_null_my_second_dbt_model_id.151b76d778"
[0m19:31:02.882031 [debug] [Thread-1 (]: On test.test_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m19:31:02.882031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:31:02.959258 [debug] [Thread-1 (]: SQL status: BEGIN in 0.077 seconds
[0m19:31:02.960256 [debug] [Thread-1 (]: Using postgres connection "test.test_project.not_null_my_second_dbt_model_id.151b76d778"
[0m19:31:02.961258 [debug] [Thread-1 (]: On test.test_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "test.test_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "test_db"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m19:31:02.963259 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:31:02.965260 [debug] [Thread-1 (]: On test.test_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m19:31:02.965772 [debug] [Thread-1 (]: On test.test_project.not_null_my_second_dbt_model_id.151b76d778: Close
[0m19:31:02.966782 [info ] [Thread-1 (]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.10s]
[0m19:31:02.967778 [debug] [Thread-1 (]: Finished running node test.test_project.not_null_my_second_dbt_model_id.151b76d778
[0m19:31:02.968779 [debug] [Thread-1 (]: Began running node test.test_project.unique_my_first_dbt_model_id.16e066b321
[0m19:31:02.969781 [info ] [Thread-1 (]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m19:31:02.970779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_project.not_null_my_second_dbt_model_id.151b76d778, now test.test_project.unique_my_first_dbt_model_id.16e066b321)
[0m19:31:02.970779 [debug] [Thread-1 (]: Began compiling node test.test_project.unique_my_first_dbt_model_id.16e066b321
[0m19:31:02.977289 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_project.unique_my_first_dbt_model_id.16e066b321"
[0m19:31:02.980476 [debug] [Thread-1 (]: Began executing node test.test_project.unique_my_first_dbt_model_id.16e066b321
[0m19:31:02.982473 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_project.unique_my_first_dbt_model_id.16e066b321"
[0m19:31:02.984977 [debug] [Thread-1 (]: Using postgres connection "test.test_project.unique_my_first_dbt_model_id.16e066b321"
[0m19:31:02.985983 [debug] [Thread-1 (]: On test.test_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m19:31:02.986983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:31:03.062013 [debug] [Thread-1 (]: SQL status: BEGIN in 0.076 seconds
[0m19:31:03.063015 [debug] [Thread-1 (]: Using postgres connection "test.test_project.unique_my_first_dbt_model_id.16e066b321"
[0m19:31:03.064017 [debug] [Thread-1 (]: On test.test_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "test.test_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "test_db"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:31:03.065523 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:31:03.067530 [debug] [Thread-1 (]: On test.test_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m19:31:03.068531 [debug] [Thread-1 (]: On test.test_project.unique_my_first_dbt_model_id.16e066b321: Close
[0m19:31:03.069533 [info ] [Thread-1 (]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.10s]
[0m19:31:03.070529 [debug] [Thread-1 (]: Finished running node test.test_project.unique_my_first_dbt_model_id.16e066b321
[0m19:31:03.071528 [debug] [Thread-1 (]: Began running node test.test_project.unique_my_second_dbt_model_id.57a0f8c493
[0m19:31:03.072528 [info ] [Thread-1 (]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m19:31:03.073531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_project.unique_my_first_dbt_model_id.16e066b321, now test.test_project.unique_my_second_dbt_model_id.57a0f8c493)
[0m19:31:03.073531 [debug] [Thread-1 (]: Began compiling node test.test_project.unique_my_second_dbt_model_id.57a0f8c493
[0m19:31:03.077049 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:31:03.080562 [debug] [Thread-1 (]: Began executing node test.test_project.unique_my_second_dbt_model_id.57a0f8c493
[0m19:31:03.082562 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:31:03.086073 [debug] [Thread-1 (]: Using postgres connection "test.test_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:31:03.087073 [debug] [Thread-1 (]: On test.test_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m19:31:03.087073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:31:03.163504 [debug] [Thread-1 (]: SQL status: BEGIN in 0.077 seconds
[0m19:31:03.165012 [debug] [Thread-1 (]: Using postgres connection "test.test_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:31:03.166020 [debug] [Thread-1 (]: On test.test_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "test.test_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "test_db"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:31:03.168023 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:31:03.169018 [debug] [Thread-1 (]: On test.test_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m19:31:03.170017 [debug] [Thread-1 (]: On test.test_project.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m19:31:03.171018 [info ] [Thread-1 (]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.10s]
[0m19:31:03.172023 [debug] [Thread-1 (]: Finished running node test.test_project.unique_my_second_dbt_model_id.57a0f8c493
[0m19:31:03.174018 [debug] [MainThread]: Using postgres connection "master"
[0m19:31:03.174018 [debug] [MainThread]: On master: BEGIN
[0m19:31:03.175017 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:31:03.251677 [debug] [MainThread]: SQL status: BEGIN in 0.077 seconds
[0m19:31:03.252677 [debug] [MainThread]: On master: COMMIT
[0m19:31:03.253678 [debug] [MainThread]: Using postgres connection "master"
[0m19:31:03.253678 [debug] [MainThread]: On master: COMMIT
[0m19:31:03.255184 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:31:03.256194 [debug] [MainThread]: On master: Close
[0m19:31:03.257194 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:31:03.257194 [debug] [MainThread]: Connection 'list_test_db_public' was properly closed.
[0m19:31:03.258194 [debug] [MainThread]: Connection 'test.test_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m19:31:03.259194 [info ] [MainThread]: 
[0m19:31:03.260193 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 1.02 seconds (1.02s).
[0m19:31:03.261190 [debug] [MainThread]: Command end result
[0m19:31:03.293246 [info ] [MainThread]: 
[0m19:31:03.294246 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:31:03.294246 [info ] [MainThread]: 
[0m19:31:03.295249 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (test_project/models\example\schema.yml)[0m
[0m19:31:03.296340 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m19:31:03.297341 [info ] [MainThread]: 
[0m19:31:03.298341 [info ] [MainThread]:   compiled code at target\compiled\test_project\test_project/models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m19:31:03.299339 [info ] [MainThread]: 
[0m19:31:03.300340 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m19:31:03.301344 [debug] [MainThread]: Command `dbt test` failed at 19:31:03.301344 after 1.82 seconds
[0m19:31:03.302343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209D0BC2600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209D14DB200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209D0F49730>]}
[0m19:31:03.303343 [debug] [MainThread]: Flushing usage events
[0m19:35:03.122597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EEEF93FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EF170FB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EEF1BF860>]}


============================== 19:35:03.127120 | bd85f810-c966-4f12-ab98-5caddaf6781a ==============================
[0m19:35:03.127120 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:35:03.128122 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:35:03.335026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd85f810-c966-4f12-ab98-5caddaf6781a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EF10120C0>]}
[0m19:35:03.382123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd85f810-c966-4f12-ab98-5caddaf6781a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EF1E36360>]}
[0m19:35:03.384123 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:35:03.393270 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m19:35:03.576303 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:35:03.577304 [debug] [MainThread]: Partial parsing: updated file: test_project://test_project/models\example\my_first_dbt_model.sql
[0m19:35:03.893449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd85f810-c966-4f12-ab98-5caddaf6781a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EF3586330>]}
[0m19:35:03.997571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd85f810-c966-4f12-ab98-5caddaf6781a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EF386E990>]}
[0m19:35:03.998574 [info ] [MainThread]: Found 3 models, 4 data tests, 417 macros
[0m19:35:03.999571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd85f810-c966-4f12-ab98-5caddaf6781a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EF3446210>]}
[0m19:35:04.001573 [info ] [MainThread]: 
[0m19:35:04.002575 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:35:04.007088 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_db_public'
[0m19:35:04.187267 [debug] [ThreadPool]: Using postgres connection "list_test_db_public"
[0m19:35:04.188267 [debug] [ThreadPool]: On list_test_db_public: BEGIN
[0m19:35:04.189271 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:35:04.272643 [debug] [ThreadPool]: SQL status: BEGIN in 0.084 seconds
[0m19:35:04.273644 [debug] [ThreadPool]: Using postgres connection "list_test_db_public"
[0m19:35:04.273644 [debug] [ThreadPool]: On list_test_db_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "list_test_db_public"} */
select
      'test_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'test_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:35:04.280160 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m19:35:04.281162 [debug] [ThreadPool]: On list_test_db_public: ROLLBACK
[0m19:35:04.282159 [debug] [ThreadPool]: On list_test_db_public: Close
[0m19:35:04.287671 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:04.287671 [debug] [MainThread]: On master: BEGIN
[0m19:35:04.288672 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:35:04.364399 [debug] [MainThread]: SQL status: BEGIN in 0.076 seconds
[0m19:35:04.365427 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:04.366013 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:35:04.372905 [debug] [MainThread]: SQL status: SELECT 1 in 0.006 seconds
[0m19:35:04.374983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd85f810-c966-4f12-ab98-5caddaf6781a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EF386E810>]}
[0m19:35:04.375509 [debug] [MainThread]: On master: ROLLBACK
[0m19:35:04.376559 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:04.377084 [debug] [MainThread]: On master: BEGIN
[0m19:35:04.378139 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:35:04.378656 [debug] [MainThread]: On master: COMMIT
[0m19:35:04.379708 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:04.380233 [debug] [MainThread]: On master: COMMIT
[0m19:35:04.380755 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:35:04.381803 [debug] [MainThread]: On master: Close
[0m19:35:04.382318 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:35:04.383341 [info ] [MainThread]: 
[0m19:35:04.387600 [debug] [Thread-1 (]: Began running node test.test_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:35:04.388131 [info ] [Thread-1 (]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m19:35:04.389244 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.test_project.not_null_my_first_dbt_model_id.5fb22c2710'
[0m19:35:04.390301 [debug] [Thread-1 (]: Began compiling node test.test_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:35:04.405606 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:35:04.407701 [debug] [Thread-1 (]: Began executing node test.test_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:35:04.421558 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:35:04.424192 [debug] [Thread-1 (]: Using postgres connection "test.test_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:35:04.424192 [debug] [Thread-1 (]: On test.test_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m19:35:04.425199 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:35:04.504024 [debug] [Thread-1 (]: SQL status: BEGIN in 0.079 seconds
[0m19:35:04.505529 [debug] [Thread-1 (]: Using postgres connection "test.test_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:35:04.505529 [debug] [Thread-1 (]: On test.test_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "test.test_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "test_db"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m19:35:04.507534 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:35:04.511536 [debug] [Thread-1 (]: On test.test_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m19:35:04.512536 [debug] [Thread-1 (]: On test.test_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m19:35:04.513536 [error] [Thread-1 (]: 1 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.12s]
[0m19:35:04.515042 [debug] [Thread-1 (]: Finished running node test.test_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:35:04.516050 [debug] [Thread-1 (]: Began running node test.test_project.not_null_my_second_dbt_model_id.151b76d778
[0m19:35:04.517049 [info ] [Thread-1 (]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m19:35:04.518047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_project.not_null_my_first_dbt_model_id.5fb22c2710, now test.test_project.not_null_my_second_dbt_model_id.151b76d778)
[0m19:35:04.519046 [debug] [Thread-1 (]: Began compiling node test.test_project.not_null_my_second_dbt_model_id.151b76d778
[0m19:35:04.523047 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_project.not_null_my_second_dbt_model_id.151b76d778"
[0m19:35:04.525046 [debug] [Thread-1 (]: Began executing node test.test_project.not_null_my_second_dbt_model_id.151b76d778
[0m19:35:04.526554 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_project.not_null_my_second_dbt_model_id.151b76d778"
[0m19:35:04.528557 [debug] [Thread-1 (]: Using postgres connection "test.test_project.not_null_my_second_dbt_model_id.151b76d778"
[0m19:35:04.529560 [debug] [Thread-1 (]: On test.test_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m19:35:04.530558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:35:04.616011 [debug] [Thread-1 (]: SQL status: BEGIN in 0.085 seconds
[0m19:35:04.616531 [debug] [Thread-1 (]: Using postgres connection "test.test_project.not_null_my_second_dbt_model_id.151b76d778"
[0m19:35:04.617574 [debug] [Thread-1 (]: On test.test_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "test.test_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "test_db"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m19:35:04.619159 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:35:04.620811 [debug] [Thread-1 (]: On test.test_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m19:35:04.621847 [debug] [Thread-1 (]: On test.test_project.not_null_my_second_dbt_model_id.151b76d778: Close
[0m19:35:04.622854 [info ] [Thread-1 (]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.10s]
[0m19:35:04.623789 [debug] [Thread-1 (]: Finished running node test.test_project.not_null_my_second_dbt_model_id.151b76d778
[0m19:35:04.623789 [debug] [Thread-1 (]: Began running node test.test_project.unique_my_first_dbt_model_id.16e066b321
[0m19:35:04.625302 [info ] [Thread-1 (]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m19:35:04.626307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_project.not_null_my_second_dbt_model_id.151b76d778, now test.test_project.unique_my_first_dbt_model_id.16e066b321)
[0m19:35:04.627308 [debug] [Thread-1 (]: Began compiling node test.test_project.unique_my_first_dbt_model_id.16e066b321
[0m19:35:04.634030 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_project.unique_my_first_dbt_model_id.16e066b321"
[0m19:35:04.636119 [debug] [Thread-1 (]: Began executing node test.test_project.unique_my_first_dbt_model_id.16e066b321
[0m19:35:04.639811 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_project.unique_my_first_dbt_model_id.16e066b321"
[0m19:35:04.641912 [debug] [Thread-1 (]: Using postgres connection "test.test_project.unique_my_first_dbt_model_id.16e066b321"
[0m19:35:04.642963 [debug] [Thread-1 (]: On test.test_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m19:35:04.642963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:35:04.718352 [debug] [Thread-1 (]: SQL status: BEGIN in 0.075 seconds
[0m19:35:04.719351 [debug] [Thread-1 (]: Using postgres connection "test.test_project.unique_my_first_dbt_model_id.16e066b321"
[0m19:35:04.720351 [debug] [Thread-1 (]: On test.test_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "test.test_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "test_db"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:35:04.722352 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:35:04.723352 [debug] [Thread-1 (]: On test.test_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m19:35:04.724910 [debug] [Thread-1 (]: On test.test_project.unique_my_first_dbt_model_id.16e066b321: Close
[0m19:35:04.725860 [info ] [Thread-1 (]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.10s]
[0m19:35:04.726861 [debug] [Thread-1 (]: Finished running node test.test_project.unique_my_first_dbt_model_id.16e066b321
[0m19:35:04.727862 [debug] [Thread-1 (]: Began running node test.test_project.unique_my_second_dbt_model_id.57a0f8c493
[0m19:35:04.728861 [info ] [Thread-1 (]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m19:35:04.729861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_project.unique_my_first_dbt_model_id.16e066b321, now test.test_project.unique_my_second_dbt_model_id.57a0f8c493)
[0m19:35:04.729861 [debug] [Thread-1 (]: Began compiling node test.test_project.unique_my_second_dbt_model_id.57a0f8c493
[0m19:35:04.734861 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:35:04.736371 [debug] [Thread-1 (]: Began executing node test.test_project.unique_my_second_dbt_model_id.57a0f8c493
[0m19:35:04.739376 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:35:04.741374 [debug] [Thread-1 (]: Using postgres connection "test.test_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:35:04.742375 [debug] [Thread-1 (]: On test.test_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m19:35:04.743375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:35:04.819188 [debug] [Thread-1 (]: SQL status: BEGIN in 0.076 seconds
[0m19:35:04.820187 [debug] [Thread-1 (]: Using postgres connection "test.test_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:35:04.820187 [debug] [Thread-1 (]: On test.test_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "test.test_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "test_db"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:35:04.822187 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:35:04.824187 [debug] [Thread-1 (]: On test.test_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m19:35:04.825187 [debug] [Thread-1 (]: On test.test_project.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m19:35:04.826273 [info ] [Thread-1 (]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.10s]
[0m19:35:04.827271 [debug] [Thread-1 (]: Finished running node test.test_project.unique_my_second_dbt_model_id.57a0f8c493
[0m19:35:04.829271 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:04.830270 [debug] [MainThread]: On master: BEGIN
[0m19:35:04.830270 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:35:05.011110 [debug] [MainThread]: SQL status: BEGIN in 0.181 seconds
[0m19:35:05.012110 [debug] [MainThread]: On master: COMMIT
[0m19:35:05.013111 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:05.013111 [debug] [MainThread]: On master: COMMIT
[0m19:35:05.014110 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:35:05.015110 [debug] [MainThread]: On master: Close
[0m19:35:05.016169 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:35:05.017170 [debug] [MainThread]: Connection 'list_test_db_public' was properly closed.
[0m19:35:05.017170 [debug] [MainThread]: Connection 'test.test_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m19:35:05.018175 [info ] [MainThread]: 
[0m19:35:05.019177 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 1.02 seconds (1.02s).
[0m19:35:05.021178 [debug] [MainThread]: Command end result
[0m19:35:05.050541 [info ] [MainThread]: 
[0m19:35:05.052542 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:35:05.052542 [info ] [MainThread]: 
[0m19:35:05.054046 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (test_project/models\example\schema.yml)[0m
[0m19:35:05.055052 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m19:35:05.055557 [info ] [MainThread]: 
[0m19:35:05.056563 [info ] [MainThread]:   compiled code at target\compiled\test_project\test_project/models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m19:35:05.057563 [info ] [MainThread]: 
[0m19:35:05.058567 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m19:35:05.060565 [debug] [MainThread]: Command `dbt test` failed at 19:35:05.060565 after 2.09 seconds
[0m19:35:05.061564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EF1C42780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EEFB60140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EF1F965D0>]}
[0m19:35:05.061564 [debug] [MainThread]: Flushing usage events
[0m19:37:08.033231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0007B2EA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E000E99D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E07D6523C0>]}


============================== 19:37:08.037395 | 6dafca35-92f1-45ae-8dde-b03b0ac7e24a ==============================
[0m19:37:08.037395 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:37:08.038446 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --models my_first_dbt_model', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:37:08.239104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6dafca35-92f1-45ae-8dde-b03b0ac7e24a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0010D2A80>]}
[0m19:37:08.285645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6dafca35-92f1-45ae-8dde-b03b0ac7e24a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E000F26270>]}
[0m19:37:08.286650 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:37:08.296559 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m19:37:08.473066 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:37:08.474065 [debug] [MainThread]: Partial parsing: updated file: test_project://test_project/models\example\my_first_dbt_model.sql
[0m19:37:08.805009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6dafca35-92f1-45ae-8dde-b03b0ac7e24a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0025ECE30>]}
[0m19:37:08.897558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6dafca35-92f1-45ae-8dde-b03b0ac7e24a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0013728A0>]}
[0m19:37:08.898559 [info ] [MainThread]: Found 3 models, 4 data tests, 417 macros
[0m19:37:08.899558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dafca35-92f1-45ae-8dde-b03b0ac7e24a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E00141CFB0>]}
[0m19:37:08.900558 [info ] [MainThread]: 
[0m19:37:08.902142 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:37:08.903149 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_db'
[0m19:37:09.183991 [debug] [ThreadPool]: Using postgres connection "list_test_db"
[0m19:37:09.184991 [debug] [ThreadPool]: On list_test_db: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "list_test_db"} */

    select distinct nspname from pg_namespace
  
[0m19:37:09.184991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:37:09.266559 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.081 seconds
[0m19:37:09.268561 [debug] [ThreadPool]: On list_test_db: Close
[0m19:37:09.273561 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_db_public'
[0m19:37:09.279071 [debug] [ThreadPool]: Using postgres connection "list_test_db_public"
[0m19:37:09.279071 [debug] [ThreadPool]: On list_test_db_public: BEGIN
[0m19:37:09.280073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:37:09.353746 [debug] [ThreadPool]: SQL status: BEGIN in 0.075 seconds
[0m19:37:09.355252 [debug] [ThreadPool]: Using postgres connection "list_test_db_public"
[0m19:37:09.356261 [debug] [ThreadPool]: On list_test_db_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "list_test_db_public"} */
select
      'test_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'test_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:37:09.362263 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m19:37:09.363265 [debug] [ThreadPool]: On list_test_db_public: ROLLBACK
[0m19:37:09.364265 [debug] [ThreadPool]: On list_test_db_public: Close
[0m19:37:09.368776 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:09.369777 [debug] [MainThread]: On master: BEGIN
[0m19:37:09.370777 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:37:09.448013 [debug] [MainThread]: SQL status: BEGIN in 0.077 seconds
[0m19:37:09.448013 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:09.449013 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:37:09.455012 [debug] [MainThread]: SQL status: SELECT 1 in 0.006 seconds
[0m19:37:09.457502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dafca35-92f1-45ae-8dde-b03b0ac7e24a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E002AE51C0>]}
[0m19:37:09.458502 [debug] [MainThread]: On master: ROLLBACK
[0m19:37:09.458502 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:09.459502 [debug] [MainThread]: On master: BEGIN
[0m19:37:09.460502 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:37:09.461503 [debug] [MainThread]: On master: COMMIT
[0m19:37:09.461503 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:09.462502 [debug] [MainThread]: On master: COMMIT
[0m19:37:09.462502 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:37:09.463502 [debug] [MainThread]: On master: Close
[0m19:37:09.465007 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:37:09.466014 [info ] [MainThread]: 
[0m19:37:09.469015 [debug] [Thread-1 (]: Began running node model.test_project.my_first_dbt_model
[0m19:37:09.470013 [info ] [Thread-1 (]: 1 of 1 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m19:37:09.471013 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.test_project.my_first_dbt_model'
[0m19:37:09.472012 [debug] [Thread-1 (]: Began compiling node model.test_project.my_first_dbt_model
[0m19:37:09.478527 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_project.my_first_dbt_model"
[0m19:37:09.480528 [debug] [Thread-1 (]: Began executing node model.test_project.my_first_dbt_model
[0m19:37:09.513619 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_project.my_first_dbt_model"
[0m19:37:09.516138 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_first_dbt_model"
[0m19:37:09.517138 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: BEGIN
[0m19:37:09.518142 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:37:09.596062 [debug] [Thread-1 (]: SQL status: BEGIN in 0.078 seconds
[0m19:37:09.597064 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_first_dbt_model"
[0m19:37:09.598063 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.my_first_dbt_model"} */

  
    

  create  table "test_db"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m19:37:09.602062 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m19:37:09.608261 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_first_dbt_model"
[0m19:37:09.608261 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.my_first_dbt_model"} */
alter table "test_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:37:09.609264 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:37:09.612261 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_first_dbt_model"
[0m19:37:09.613261 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.my_first_dbt_model"} */
alter table "test_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:37:09.615261 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:37:09.634295 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: COMMIT
[0m19:37:09.634295 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_first_dbt_model"
[0m19:37:09.635295 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: COMMIT
[0m19:37:09.636572 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:37:09.642572 [debug] [Thread-1 (]: Applying DROP to: "test_db"."public"."my_first_dbt_model__dbt_backup"
[0m19:37:09.648088 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_first_dbt_model"
[0m19:37:09.649091 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.my_first_dbt_model"} */
drop table if exists "test_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m19:37:09.652089 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m19:37:09.654087 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: Close
[0m19:37:09.656379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dafca35-92f1-45ae-8dde-b03b0ac7e24a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E07EA62150>]}
[0m19:37:09.657379 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.18s]
[0m19:37:09.658383 [debug] [Thread-1 (]: Finished running node model.test_project.my_first_dbt_model
[0m19:37:09.659384 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:09.660387 [debug] [MainThread]: On master: BEGIN
[0m19:37:09.660387 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:37:09.741075 [debug] [MainThread]: SQL status: BEGIN in 0.081 seconds
[0m19:37:09.742077 [debug] [MainThread]: On master: COMMIT
[0m19:37:09.743076 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:09.744075 [debug] [MainThread]: On master: COMMIT
[0m19:37:09.744075 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:37:09.745584 [debug] [MainThread]: On master: Close
[0m19:37:09.745584 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:37:09.746590 [debug] [MainThread]: Connection 'list_test_db' was properly closed.
[0m19:37:09.746590 [debug] [MainThread]: Connection 'list_test_db_public' was properly closed.
[0m19:37:09.747595 [debug] [MainThread]: Connection 'model.test_project.my_first_dbt_model' was properly closed.
[0m19:37:09.748595 [info ] [MainThread]: 
[0m19:37:09.749595 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m19:37:09.750595 [debug] [MainThread]: Command end result
[0m19:37:09.781715 [info ] [MainThread]: 
[0m19:37:09.783715 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:37:09.783715 [info ] [MainThread]: 
[0m19:37:09.785221 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:37:09.787226 [debug] [MainThread]: Command `dbt run` succeeded at 19:37:09.787226 after 1.92 seconds
[0m19:37:09.788227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E00044D820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E00044FF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0010F4F20>]}
[0m19:37:09.789229 [debug] [MainThread]: Flushing usage events
[0m19:37:22.329016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9E4F9A240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9E48B2690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9E1722390>]}


============================== 19:37:22.333568 | 62aa40bf-0169-4988-b73f-67e01076b584 ==============================
[0m19:37:22.333568 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:37:22.334072 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m19:37:22.543020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62aa40bf-0169-4988-b73f-67e01076b584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9E4DA35F0>]}
[0m19:37:22.590179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62aa40bf-0169-4988-b73f-67e01076b584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9E5213260>]}
[0m19:37:22.592176 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:37:22.600699 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m19:37:22.782419 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:37:22.783421 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:37:22.811934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62aa40bf-0169-4988-b73f-67e01076b584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9E5413FE0>]}
[0m19:37:22.918970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62aa40bf-0169-4988-b73f-67e01076b584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9E671E240>]}
[0m19:37:22.919968 [info ] [MainThread]: Found 3 models, 4 data tests, 417 macros
[0m19:37:22.920972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62aa40bf-0169-4988-b73f-67e01076b584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9E655BFB0>]}
[0m19:37:22.922969 [info ] [MainThread]: 
[0m19:37:22.923969 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:37:22.929493 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_db_public'
[0m19:37:23.106584 [debug] [ThreadPool]: Using postgres connection "list_test_db_public"
[0m19:37:23.107584 [debug] [ThreadPool]: On list_test_db_public: BEGIN
[0m19:37:23.107584 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:37:23.188365 [debug] [ThreadPool]: SQL status: BEGIN in 0.080 seconds
[0m19:37:23.189365 [debug] [ThreadPool]: Using postgres connection "list_test_db_public"
[0m19:37:23.189365 [debug] [ThreadPool]: On list_test_db_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "list_test_db_public"} */
select
      'test_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'test_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:37:23.195368 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m19:37:23.196882 [debug] [ThreadPool]: On list_test_db_public: ROLLBACK
[0m19:37:23.197882 [debug] [ThreadPool]: On list_test_db_public: Close
[0m19:37:23.202879 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:23.203881 [debug] [MainThread]: On master: BEGIN
[0m19:37:23.203881 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:37:23.279984 [debug] [MainThread]: SQL status: BEGIN in 0.075 seconds
[0m19:37:23.279984 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:23.280987 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:37:23.288494 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m19:37:23.289495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62aa40bf-0169-4988-b73f-67e01076b584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9E5210080>]}
[0m19:37:23.290495 [debug] [MainThread]: On master: ROLLBACK
[0m19:37:23.291499 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:23.291499 [debug] [MainThread]: On master: BEGIN
[0m19:37:23.292494 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:37:23.293498 [debug] [MainThread]: On master: COMMIT
[0m19:37:23.293498 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:23.293498 [debug] [MainThread]: On master: COMMIT
[0m19:37:23.295004 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:37:23.296011 [debug] [MainThread]: On master: Close
[0m19:37:23.296011 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:37:23.298014 [info ] [MainThread]: 
[0m19:37:23.302009 [debug] [Thread-1 (]: Began running node test.test_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:37:23.303009 [info ] [Thread-1 (]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m19:37:23.304009 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.test_project.not_null_my_first_dbt_model_id.5fb22c2710'
[0m19:37:23.305011 [debug] [Thread-1 (]: Began compiling node test.test_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:37:23.320124 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:37:23.322125 [debug] [Thread-1 (]: Began executing node test.test_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:37:23.336465 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:37:23.338468 [debug] [Thread-1 (]: Using postgres connection "test.test_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:37:23.339468 [debug] [Thread-1 (]: On test.test_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m19:37:23.340465 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:37:23.417155 [debug] [Thread-1 (]: SQL status: BEGIN in 0.076 seconds
[0m19:37:23.417155 [debug] [Thread-1 (]: Using postgres connection "test.test_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:37:23.418163 [debug] [Thread-1 (]: On test.test_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "test.test_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "test_db"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m19:37:23.420162 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:37:23.424164 [debug] [Thread-1 (]: On test.test_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m19:37:23.425163 [debug] [Thread-1 (]: On test.test_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m19:37:23.425673 [error] [Thread-1 (]: 1 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.12s]
[0m19:37:23.426679 [debug] [Thread-1 (]: Finished running node test.test_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:37:23.427678 [debug] [Thread-1 (]: Began running node test.test_project.not_null_my_second_dbt_model_id.151b76d778
[0m19:37:23.428679 [info ] [Thread-1 (]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m19:37:23.429679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_project.not_null_my_first_dbt_model_id.5fb22c2710, now test.test_project.not_null_my_second_dbt_model_id.151b76d778)
[0m19:37:23.430679 [debug] [Thread-1 (]: Began compiling node test.test_project.not_null_my_second_dbt_model_id.151b76d778
[0m19:37:23.433678 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_project.not_null_my_second_dbt_model_id.151b76d778"
[0m19:37:23.436193 [debug] [Thread-1 (]: Began executing node test.test_project.not_null_my_second_dbt_model_id.151b76d778
[0m19:37:23.438191 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_project.not_null_my_second_dbt_model_id.151b76d778"
[0m19:37:23.440193 [debug] [Thread-1 (]: Using postgres connection "test.test_project.not_null_my_second_dbt_model_id.151b76d778"
[0m19:37:23.441195 [debug] [Thread-1 (]: On test.test_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m19:37:23.441195 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:23.517059 [debug] [Thread-1 (]: SQL status: BEGIN in 0.076 seconds
[0m19:37:23.518057 [debug] [Thread-1 (]: Using postgres connection "test.test_project.not_null_my_second_dbt_model_id.151b76d778"
[0m19:37:23.519055 [debug] [Thread-1 (]: On test.test_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "test.test_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "test_db"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m19:37:23.520058 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.my_second_dbt_model" does not exist
LINE 14: from "test_db"."public"."my_second_dbt_model"
              ^

[0m19:37:23.521056 [debug] [Thread-1 (]: On test.test_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m19:37:23.522055 [debug] [Thread-1 (]: On test.test_project.not_null_my_second_dbt_model_id.151b76d778: Close
[0m19:37:23.529215 [debug] [Thread-1 (]: Database Error in test not_null_my_second_dbt_model_id (test_project/models\example\schema.yml)
  relation "public.my_second_dbt_model" does not exist
  LINE 14: from "test_db"."public"."my_second_dbt_model"
                ^
  compiled Code at target\run\test_project\test_project/models\example\schema.yml\not_null_my_second_dbt_model_id.sql
[0m19:37:23.530214 [error] [Thread-1 (]: 2 of 4 ERROR not_null_my_second_dbt_model_id ................................... [[31mERROR[0m in 0.10s]
[0m19:37:23.531215 [debug] [Thread-1 (]: Finished running node test.test_project.not_null_my_second_dbt_model_id.151b76d778
[0m19:37:23.532216 [debug] [Thread-1 (]: Began running node test.test_project.unique_my_first_dbt_model_id.16e066b321
[0m19:37:23.533217 [info ] [Thread-1 (]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m19:37:23.534217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_project.not_null_my_second_dbt_model_id.151b76d778, now test.test_project.unique_my_first_dbt_model_id.16e066b321)
[0m19:37:23.535217 [debug] [Thread-1 (]: Began compiling node test.test_project.unique_my_first_dbt_model_id.16e066b321
[0m19:37:23.540737 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_project.unique_my_first_dbt_model_id.16e066b321"
[0m19:37:23.542736 [debug] [Thread-1 (]: Began executing node test.test_project.unique_my_first_dbt_model_id.16e066b321
[0m19:37:23.545248 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_project.unique_my_first_dbt_model_id.16e066b321"
[0m19:37:23.547255 [debug] [Thread-1 (]: Using postgres connection "test.test_project.unique_my_first_dbt_model_id.16e066b321"
[0m19:37:23.548306 [debug] [Thread-1 (]: On test.test_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m19:37:23.548811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:23.727675 [debug] [Thread-1 (]: SQL status: BEGIN in 0.178 seconds
[0m19:37:23.728676 [debug] [Thread-1 (]: Using postgres connection "test.test_project.unique_my_first_dbt_model_id.16e066b321"
[0m19:37:23.728676 [debug] [Thread-1 (]: On test.test_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "test.test_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "test_db"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:37:23.730674 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:37:23.732676 [debug] [Thread-1 (]: On test.test_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m19:37:23.733674 [debug] [Thread-1 (]: On test.test_project.unique_my_first_dbt_model_id.16e066b321: Close
[0m19:37:23.733674 [info ] [Thread-1 (]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.20s]
[0m19:37:23.735180 [debug] [Thread-1 (]: Finished running node test.test_project.unique_my_first_dbt_model_id.16e066b321
[0m19:37:23.736190 [debug] [Thread-1 (]: Began running node test.test_project.unique_my_second_dbt_model_id.57a0f8c493
[0m19:37:23.737189 [info ] [Thread-1 (]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m19:37:23.738186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_project.unique_my_first_dbt_model_id.16e066b321, now test.test_project.unique_my_second_dbt_model_id.57a0f8c493)
[0m19:37:23.738186 [debug] [Thread-1 (]: Began compiling node test.test_project.unique_my_second_dbt_model_id.57a0f8c493
[0m19:37:23.742187 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:37:23.744187 [debug] [Thread-1 (]: Began executing node test.test_project.unique_my_second_dbt_model_id.57a0f8c493
[0m19:37:23.746710 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:37:23.748708 [debug] [Thread-1 (]: Using postgres connection "test.test_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:37:23.749707 [debug] [Thread-1 (]: On test.test_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m19:37:23.750708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:23.825375 [debug] [Thread-1 (]: SQL status: BEGIN in 0.075 seconds
[0m19:37:23.825879 [debug] [Thread-1 (]: Using postgres connection "test.test_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:37:23.826885 [debug] [Thread-1 (]: On test.test_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "test.test_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "test_db"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:37:23.827891 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.my_second_dbt_model" does not exist
LINE 15: from "test_db"."public"."my_second_dbt_model"
              ^

[0m19:37:23.828891 [debug] [Thread-1 (]: On test.test_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m19:37:23.829892 [debug] [Thread-1 (]: On test.test_project.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m19:37:23.833892 [debug] [Thread-1 (]: Database Error in test unique_my_second_dbt_model_id (test_project/models\example\schema.yml)
  relation "public.my_second_dbt_model" does not exist
  LINE 15: from "test_db"."public"."my_second_dbt_model"
                ^
  compiled Code at target\run\test_project\test_project/models\example\schema.yml\unique_my_second_dbt_model_id.sql
[0m19:37:23.833892 [error] [Thread-1 (]: 4 of 4 ERROR unique_my_second_dbt_model_id ..................................... [[31mERROR[0m in 0.10s]
[0m19:37:23.836011 [debug] [Thread-1 (]: Finished running node test.test_project.unique_my_second_dbt_model_id.57a0f8c493
[0m19:37:23.837013 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:23.838013 [debug] [MainThread]: On master: BEGIN
[0m19:37:23.838013 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:37:23.916592 [debug] [MainThread]: SQL status: BEGIN in 0.078 seconds
[0m19:37:23.917592 [debug] [MainThread]: On master: COMMIT
[0m19:37:23.918595 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:23.918595 [debug] [MainThread]: On master: COMMIT
[0m19:37:23.919593 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:37:23.920593 [debug] [MainThread]: On master: Close
[0m19:37:23.920593 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:37:23.921594 [debug] [MainThread]: Connection 'list_test_db_public' was properly closed.
[0m19:37:23.922592 [debug] [MainThread]: Connection 'test.test_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m19:37:23.923594 [info ] [MainThread]: 
[0m19:37:23.923594 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 1.00 seconds (1.00s).
[0m19:37:23.926106 [debug] [MainThread]: Command end result
[0m19:37:23.956445 [info ] [MainThread]: 
[0m19:37:23.956950 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m19:37:23.957959 [info ] [MainThread]: 
[0m19:37:23.958957 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (test_project/models\example\schema.yml)[0m
[0m19:37:23.959959 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m19:37:23.960958 [info ] [MainThread]: 
[0m19:37:23.961957 [info ] [MainThread]:   compiled code at target\compiled\test_project\test_project/models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m19:37:23.962958 [info ] [MainThread]: 
[0m19:37:23.963957 [error] [MainThread]:   Database Error in test not_null_my_second_dbt_model_id (test_project/models\example\schema.yml)
  relation "public.my_second_dbt_model" does not exist
  LINE 14: from "test_db"."public"."my_second_dbt_model"
                ^
  compiled Code at target\run\test_project\test_project/models\example\schema.yml\not_null_my_second_dbt_model_id.sql
[0m19:37:23.965007 [info ] [MainThread]: 
[0m19:37:23.966006 [error] [MainThread]:   Database Error in test unique_my_second_dbt_model_id (test_project/models\example\schema.yml)
  relation "public.my_second_dbt_model" does not exist
  LINE 15: from "test_db"."public"."my_second_dbt_model"
                ^
  compiled Code at target\run\test_project\test_project/models\example\schema.yml\unique_my_second_dbt_model_id.sql
[0m19:37:23.967008 [info ] [MainThread]: 
[0m19:37:23.968005 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=0 TOTAL=4
[0m19:37:23.969005 [debug] [MainThread]: Command `dbt test` failed at 19:37:23.969005 after 1.81 seconds
[0m19:37:23.970004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9E51176B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9E15DD640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9E6B09820>]}
[0m19:37:23.971006 [debug] [MainThread]: Flushing usage events
[0m19:37:51.805551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223A1D63230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223A17C5220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002239FB946B0>]}


============================== 19:37:51.809560 | 7064017c-71a0-49b5-a339-43e1fd58e541 ==============================
[0m19:37:51.809560 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:37:51.810556 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test\\logs', 'profiles_dir': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:37:52.023781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7064017c-71a0-49b5-a339-43e1fd58e541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223A2525370>]}
[0m19:37:52.071390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7064017c-71a0-49b5-a339-43e1fd58e541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223A162AB40>]}
[0m19:37:52.073387 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:37:52.081898 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m19:37:52.289843 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:37:52.290842 [debug] [MainThread]: Partial parsing: updated file: test_project://test_project/models\example\my_first_dbt_model.sql
[0m19:37:52.626367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7064017c-71a0-49b5-a339-43e1fd58e541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223A3B61A60>]}
[0m19:37:52.721307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7064017c-71a0-49b5-a339-43e1fd58e541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223A29DE600>]}
[0m19:37:52.721307 [info ] [MainThread]: Found 3 models, 4 data tests, 417 macros
[0m19:37:52.722308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7064017c-71a0-49b5-a339-43e1fd58e541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223A2A86B10>]}
[0m19:37:52.725302 [info ] [MainThread]: 
[0m19:37:52.725810 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:37:52.729823 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_db'
[0m19:37:52.913713 [debug] [ThreadPool]: Using postgres connection "list_test_db"
[0m19:37:52.915218 [debug] [ThreadPool]: On list_test_db: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "list_test_db"} */

    select distinct nspname from pg_namespace
  
[0m19:37:52.915218 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:37:53.003469 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.087 seconds
[0m19:37:53.005980 [debug] [ThreadPool]: On list_test_db: Close
[0m19:37:53.007986 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_db_public'
[0m19:37:53.013981 [debug] [ThreadPool]: Using postgres connection "list_test_db_public"
[0m19:37:53.014980 [debug] [ThreadPool]: On list_test_db_public: BEGIN
[0m19:37:53.014980 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:37:53.103753 [debug] [ThreadPool]: SQL status: BEGIN in 0.088 seconds
[0m19:37:53.104279 [debug] [ThreadPool]: Using postgres connection "list_test_db_public"
[0m19:37:53.104279 [debug] [ThreadPool]: On list_test_db_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "list_test_db_public"} */
select
      'test_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'test_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:37:53.110939 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.005 seconds
[0m19:37:53.112534 [debug] [ThreadPool]: On list_test_db_public: ROLLBACK
[0m19:37:53.113192 [debug] [ThreadPool]: On list_test_db_public: Close
[0m19:37:53.117962 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:53.118490 [debug] [MainThread]: On master: BEGIN
[0m19:37:53.119551 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:37:53.198007 [debug] [MainThread]: SQL status: BEGIN in 0.079 seconds
[0m19:37:53.199005 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:53.200007 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:37:53.206166 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m19:37:53.207733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7064017c-71a0-49b5-a339-43e1fd58e541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223A21C2A20>]}
[0m19:37:53.208738 [debug] [MainThread]: On master: ROLLBACK
[0m19:37:53.208738 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:53.209741 [debug] [MainThread]: On master: BEGIN
[0m19:37:53.210740 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:37:53.210740 [debug] [MainThread]: On master: COMMIT
[0m19:37:53.211740 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:53.212740 [debug] [MainThread]: On master: COMMIT
[0m19:37:53.212740 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:37:53.213739 [debug] [MainThread]: On master: Close
[0m19:37:53.213739 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:37:53.215250 [info ] [MainThread]: 
[0m19:37:53.219258 [debug] [Thread-1 (]: Began running node model.test_project.example_model
[0m19:37:53.220256 [info ] [Thread-1 (]: 1 of 3 START sql view model public.example_model ............................... [RUN]
[0m19:37:53.221256 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.test_project.example_model'
[0m19:37:53.222256 [debug] [Thread-1 (]: Began compiling node model.test_project.example_model
[0m19:37:53.228773 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_project.example_model"
[0m19:37:53.230773 [debug] [Thread-1 (]: Began executing node model.test_project.example_model
[0m19:37:53.262329 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_project.example_model"
[0m19:37:53.265332 [debug] [Thread-1 (]: Using postgres connection "model.test_project.example_model"
[0m19:37:53.265842 [debug] [Thread-1 (]: On model.test_project.example_model: BEGIN
[0m19:37:53.266849 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:37:53.354847 [debug] [Thread-1 (]: SQL status: BEGIN in 0.089 seconds
[0m19:37:53.355881 [debug] [Thread-1 (]: Using postgres connection "model.test_project.example_model"
[0m19:37:53.356881 [debug] [Thread-1 (]: On model.test_project.example_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.example_model"} */

  create view "test_db"."public"."example_model__dbt_tmp"
    
    
  as (
    -- models/example_model.sql

select 1 as id, 'dbt' as name
  );
[0m19:37:53.360111 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m19:37:53.365964 [debug] [Thread-1 (]: Using postgres connection "model.test_project.example_model"
[0m19:37:53.366965 [debug] [Thread-1 (]: On model.test_project.example_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.example_model"} */
alter table "test_db"."public"."example_model" rename to "example_model__dbt_backup"
[0m19:37:53.367964 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:37:53.369965 [debug] [Thread-1 (]: Using postgres connection "model.test_project.example_model"
[0m19:37:53.370965 [debug] [Thread-1 (]: On model.test_project.example_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.example_model"} */
alter table "test_db"."public"."example_model__dbt_tmp" rename to "example_model"
[0m19:37:53.371965 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:37:53.389111 [debug] [Thread-1 (]: On model.test_project.example_model: COMMIT
[0m19:37:53.389640 [debug] [Thread-1 (]: Using postgres connection "model.test_project.example_model"
[0m19:37:53.390698 [debug] [Thread-1 (]: On model.test_project.example_model: COMMIT
[0m19:37:53.392228 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:37:53.397736 [debug] [Thread-1 (]: Applying DROP to: "test_db"."public"."example_model__dbt_backup"
[0m19:37:53.402737 [debug] [Thread-1 (]: Using postgres connection "model.test_project.example_model"
[0m19:37:53.402737 [debug] [Thread-1 (]: On model.test_project.example_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.example_model"} */
drop view if exists "test_db"."public"."example_model__dbt_backup" cascade
[0m19:37:53.403737 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m19:37:53.407249 [debug] [Thread-1 (]: On model.test_project.example_model: Close
[0m19:37:53.408253 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7064017c-71a0-49b5-a339-43e1fd58e541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223A00A1E20>]}
[0m19:37:53.409255 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.example_model .......................... [[32mCREATE VIEW[0m in 0.19s]
[0m19:37:53.410890 [debug] [Thread-1 (]: Finished running node model.test_project.example_model
[0m19:37:53.411897 [debug] [Thread-1 (]: Began running node model.test_project.my_first_dbt_model
[0m19:37:53.412898 [info ] [Thread-1 (]: 2 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m19:37:53.412898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.test_project.example_model, now model.test_project.my_first_dbt_model)
[0m19:37:53.413897 [debug] [Thread-1 (]: Began compiling node model.test_project.my_first_dbt_model
[0m19:37:53.417152 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_project.my_first_dbt_model"
[0m19:37:53.419153 [debug] [Thread-1 (]: Began executing node model.test_project.my_first_dbt_model
[0m19:37:53.439180 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_project.my_first_dbt_model"
[0m19:37:53.442181 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_first_dbt_model"
[0m19:37:53.442181 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: BEGIN
[0m19:37:53.443182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:53.520865 [debug] [Thread-1 (]: SQL status: BEGIN in 0.077 seconds
[0m19:37:53.520865 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_first_dbt_model"
[0m19:37:53.521863 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.my_first_dbt_model"} */

  
    

  create  table "test_db"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

where id is not null
  );
  
[0m19:37:53.525372 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:37:53.528887 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_first_dbt_model"
[0m19:37:53.529886 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.my_first_dbt_model"} */
alter table "test_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:37:53.530886 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:37:53.533886 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_first_dbt_model"
[0m19:37:53.533886 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.my_first_dbt_model"} */
alter table "test_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:37:53.536404 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:37:53.541403 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: COMMIT
[0m19:37:53.541403 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_first_dbt_model"
[0m19:37:53.542405 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: COMMIT
[0m19:37:53.543406 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:37:53.545919 [debug] [Thread-1 (]: Applying DROP to: "test_db"."public"."my_first_dbt_model__dbt_backup"
[0m19:37:53.547919 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_first_dbt_model"
[0m19:37:53.548919 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.my_first_dbt_model"} */
drop table if exists "test_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m19:37:53.551920 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m19:37:53.552925 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: Close
[0m19:37:53.553921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7064017c-71a0-49b5-a339-43e1fd58e541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223A4169D30>]}
[0m19:37:53.555438 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 1[0m in 0.14s]
[0m19:37:53.556446 [debug] [Thread-1 (]: Finished running node model.test_project.my_first_dbt_model
[0m19:37:53.557445 [debug] [Thread-1 (]: Began running node model.test_project.my_second_dbt_model
[0m19:37:53.558449 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m19:37:53.559448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.test_project.my_first_dbt_model, now model.test_project.my_second_dbt_model)
[0m19:37:53.560448 [debug] [Thread-1 (]: Began compiling node model.test_project.my_second_dbt_model
[0m19:37:53.562448 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_project.my_second_dbt_model"
[0m19:37:53.564951 [debug] [Thread-1 (]: Began executing node model.test_project.my_second_dbt_model
[0m19:37:53.568960 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_project.my_second_dbt_model"
[0m19:37:53.570959 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_second_dbt_model"
[0m19:37:53.571957 [debug] [Thread-1 (]: On model.test_project.my_second_dbt_model: BEGIN
[0m19:37:53.571957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:53.650150 [debug] [Thread-1 (]: SQL status: BEGIN in 0.078 seconds
[0m19:37:53.651144 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_second_dbt_model"
[0m19:37:53.652147 [debug] [Thread-1 (]: On model.test_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.my_second_dbt_model"} */

  create view "test_db"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "test_db"."public"."my_first_dbt_model"
where id = 1
  );
[0m19:37:53.655650 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m19:37:53.659656 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_second_dbt_model"
[0m19:37:53.660656 [debug] [Thread-1 (]: On model.test_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.my_second_dbt_model"} */
alter table "test_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:37:53.660656 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:37:53.662656 [debug] [Thread-1 (]: On model.test_project.my_second_dbt_model: COMMIT
[0m19:37:53.663656 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_second_dbt_model"
[0m19:37:53.663656 [debug] [Thread-1 (]: On model.test_project.my_second_dbt_model: COMMIT
[0m19:37:53.665161 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:37:53.668167 [debug] [Thread-1 (]: Applying DROP to: "test_db"."public"."my_second_dbt_model__dbt_backup"
[0m19:37:53.669167 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_second_dbt_model"
[0m19:37:53.670167 [debug] [Thread-1 (]: On model.test_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.my_second_dbt_model"} */
drop view if exists "test_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m19:37:53.670167 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m19:37:53.672167 [debug] [Thread-1 (]: On model.test_project.my_second_dbt_model: Close
[0m19:37:53.673167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7064017c-71a0-49b5-a339-43e1fd58e541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223A423DAC0>]}
[0m19:37:53.673167 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.11s]
[0m19:37:53.675167 [debug] [Thread-1 (]: Finished running node model.test_project.my_second_dbt_model
[0m19:37:53.676675 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:53.676675 [debug] [MainThread]: On master: BEGIN
[0m19:37:53.677681 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:37:53.758279 [debug] [MainThread]: SQL status: BEGIN in 0.081 seconds
[0m19:37:53.759279 [debug] [MainThread]: On master: COMMIT
[0m19:37:53.760279 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:53.761278 [debug] [MainThread]: On master: COMMIT
[0m19:37:53.761278 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:37:53.762277 [debug] [MainThread]: On master: Close
[0m19:37:53.763279 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:37:53.764279 [debug] [MainThread]: Connection 'list_test_db' was properly closed.
[0m19:37:53.764279 [debug] [MainThread]: Connection 'list_test_db_public' was properly closed.
[0m19:37:53.765278 [debug] [MainThread]: Connection 'model.test_project.my_second_dbt_model' was properly closed.
[0m19:37:53.766659 [info ] [MainThread]: 
[0m19:37:53.766659 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 1.04 seconds (1.04s).
[0m19:37:53.768664 [debug] [MainThread]: Command end result
[0m19:37:53.799203 [info ] [MainThread]: 
[0m19:37:53.800203 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:37:53.801203 [info ] [MainThread]: 
[0m19:37:53.802208 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m19:37:53.804203 [debug] [MainThread]: Command `dbt run` succeeded at 19:37:53.804203 after 2.15 seconds
[0m19:37:53.804203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223A1DE57C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223A3B62090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223A1BC4BF0>]}
[0m19:37:53.805203 [debug] [MainThread]: Flushing usage events
[0m19:37:59.246566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CDEA32720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE49D7D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE49D6D80>]}


============================== 19:37:59.251570 | f48a7b86-5ef1-4086-865c-de5c1255ef57 ==============================
[0m19:37:59.251570 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:37:59.252567 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:37:59.455459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f48a7b86-5ef1-4086-865c-de5c1255ef57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE3A32030>]}
[0m19:37:59.504100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f48a7b86-5ef1-4086-865c-de5c1255ef57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE48C5AC0>]}
[0m19:37:59.505102 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:37:59.513415 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m19:37:59.691175 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:37:59.692175 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:37:59.721729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f48a7b86-5ef1-4086-865c-de5c1255ef57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE4C4E030>]}
[0m19:37:59.827585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f48a7b86-5ef1-4086-865c-de5c1255ef57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE603D850>]}
[0m19:37:59.828586 [info ] [MainThread]: Found 3 models, 4 data tests, 417 macros
[0m19:37:59.828586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f48a7b86-5ef1-4086-865c-de5c1255ef57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE5E8C5F0>]}
[0m19:37:59.831090 [info ] [MainThread]: 
[0m19:37:59.832097 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:37:59.836158 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_db_public'
[0m19:38:00.017837 [debug] [ThreadPool]: Using postgres connection "list_test_db_public"
[0m19:38:00.018836 [debug] [ThreadPool]: On list_test_db_public: BEGIN
[0m19:38:00.018836 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:38:00.104927 [debug] [ThreadPool]: SQL status: BEGIN in 0.086 seconds
[0m19:38:00.106026 [debug] [ThreadPool]: Using postgres connection "list_test_db_public"
[0m19:38:00.107028 [debug] [ThreadPool]: On list_test_db_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "list_test_db_public"} */
select
      'test_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'test_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:38:00.113026 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m19:38:00.115026 [debug] [ThreadPool]: On list_test_db_public: ROLLBACK
[0m19:38:00.115026 [debug] [ThreadPool]: On list_test_db_public: Close
[0m19:38:00.121087 [debug] [MainThread]: Using postgres connection "master"
[0m19:38:00.122085 [debug] [MainThread]: On master: BEGIN
[0m19:38:00.122085 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:38:00.198276 [debug] [MainThread]: SQL status: BEGIN in 0.076 seconds
[0m19:38:00.199274 [debug] [MainThread]: Using postgres connection "master"
[0m19:38:00.200273 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:38:00.207338 [debug] [MainThread]: SQL status: SELECT 1 in 0.006 seconds
[0m19:38:00.208342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f48a7b86-5ef1-4086-865c-de5c1255ef57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE4BF2A50>]}
[0m19:38:00.209341 [debug] [MainThread]: On master: ROLLBACK
[0m19:38:00.210341 [debug] [MainThread]: Using postgres connection "master"
[0m19:38:00.211339 [debug] [MainThread]: On master: BEGIN
[0m19:38:00.211339 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:38:00.212339 [debug] [MainThread]: On master: COMMIT
[0m19:38:00.213340 [debug] [MainThread]: Using postgres connection "master"
[0m19:38:00.213340 [debug] [MainThread]: On master: COMMIT
[0m19:38:00.214342 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:38:00.215339 [debug] [MainThread]: On master: Close
[0m19:38:00.215843 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:38:00.216854 [info ] [MainThread]: 
[0m19:38:00.222850 [debug] [Thread-1 (]: Began running node test.test_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:38:00.222850 [info ] [Thread-1 (]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m19:38:00.223852 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.test_project.not_null_my_first_dbt_model_id.5fb22c2710'
[0m19:38:00.224852 [debug] [Thread-1 (]: Began compiling node test.test_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:38:00.240033 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:38:00.242032 [debug] [Thread-1 (]: Began executing node test.test_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:38:00.257072 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:38:00.259067 [debug] [Thread-1 (]: Using postgres connection "test.test_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:38:00.260071 [debug] [Thread-1 (]: On test.test_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m19:38:00.260938 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:38:00.455145 [debug] [Thread-1 (]: SQL status: BEGIN in 0.195 seconds
[0m19:38:00.456155 [debug] [Thread-1 (]: Using postgres connection "test.test_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:38:00.457156 [debug] [Thread-1 (]: On test.test_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "test.test_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "test_db"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m19:38:00.458153 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:38:00.462149 [debug] [Thread-1 (]: On test.test_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m19:38:00.463151 [debug] [Thread-1 (]: On test.test_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m19:38:00.464155 [info ] [Thread-1 (]: 1 of 4 PASS not_null_my_first_dbt_model_id ..................................... [[32mPASS[0m in 0.24s]
[0m19:38:00.465154 [debug] [Thread-1 (]: Finished running node test.test_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:38:00.465154 [debug] [Thread-1 (]: Began running node test.test_project.not_null_my_second_dbt_model_id.151b76d778
[0m19:38:00.466478 [info ] [Thread-1 (]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m19:38:00.467478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_project.not_null_my_first_dbt_model_id.5fb22c2710, now test.test_project.not_null_my_second_dbt_model_id.151b76d778)
[0m19:38:00.468477 [debug] [Thread-1 (]: Began compiling node test.test_project.not_null_my_second_dbt_model_id.151b76d778
[0m19:38:00.472476 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_project.not_null_my_second_dbt_model_id.151b76d778"
[0m19:38:00.473478 [debug] [Thread-1 (]: Began executing node test.test_project.not_null_my_second_dbt_model_id.151b76d778
[0m19:38:00.476996 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_project.not_null_my_second_dbt_model_id.151b76d778"
[0m19:38:00.478994 [debug] [Thread-1 (]: Using postgres connection "test.test_project.not_null_my_second_dbt_model_id.151b76d778"
[0m19:38:00.479994 [debug] [Thread-1 (]: On test.test_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m19:38:00.479994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:38:00.564744 [debug] [Thread-1 (]: SQL status: BEGIN in 0.084 seconds
[0m19:38:00.565789 [debug] [Thread-1 (]: Using postgres connection "test.test_project.not_null_my_second_dbt_model_id.151b76d778"
[0m19:38:00.566325 [debug] [Thread-1 (]: On test.test_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "test.test_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "test_db"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m19:38:00.568423 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:38:00.569471 [debug] [Thread-1 (]: On test.test_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m19:38:00.570477 [debug] [Thread-1 (]: On test.test_project.not_null_my_second_dbt_model_id.151b76d778: Close
[0m19:38:00.572477 [info ] [Thread-1 (]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.10s]
[0m19:38:00.573478 [debug] [Thread-1 (]: Finished running node test.test_project.not_null_my_second_dbt_model_id.151b76d778
[0m19:38:00.573478 [debug] [Thread-1 (]: Began running node test.test_project.unique_my_first_dbt_model_id.16e066b321
[0m19:38:00.574983 [info ] [Thread-1 (]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m19:38:00.575989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_project.not_null_my_second_dbt_model_id.151b76d778, now test.test_project.unique_my_first_dbt_model_id.16e066b321)
[0m19:38:00.576990 [debug] [Thread-1 (]: Began compiling node test.test_project.unique_my_first_dbt_model_id.16e066b321
[0m19:38:00.581991 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_project.unique_my_first_dbt_model_id.16e066b321"
[0m19:38:00.583990 [debug] [Thread-1 (]: Began executing node test.test_project.unique_my_first_dbt_model_id.16e066b321
[0m19:38:00.587140 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_project.unique_my_first_dbt_model_id.16e066b321"
[0m19:38:00.589140 [debug] [Thread-1 (]: Using postgres connection "test.test_project.unique_my_first_dbt_model_id.16e066b321"
[0m19:38:00.590140 [debug] [Thread-1 (]: On test.test_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m19:38:00.591141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:38:00.668915 [debug] [Thread-1 (]: SQL status: BEGIN in 0.078 seconds
[0m19:38:00.669918 [debug] [Thread-1 (]: Using postgres connection "test.test_project.unique_my_first_dbt_model_id.16e066b321"
[0m19:38:00.670919 [debug] [Thread-1 (]: On test.test_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "test.test_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "test_db"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:38:00.672915 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:38:00.673920 [debug] [Thread-1 (]: On test.test_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m19:38:00.674918 [debug] [Thread-1 (]: On test.test_project.unique_my_first_dbt_model_id.16e066b321: Close
[0m19:38:00.675978 [info ] [Thread-1 (]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.10s]
[0m19:38:00.676976 [debug] [Thread-1 (]: Finished running node test.test_project.unique_my_first_dbt_model_id.16e066b321
[0m19:38:00.677979 [debug] [Thread-1 (]: Began running node test.test_project.unique_my_second_dbt_model_id.57a0f8c493
[0m19:38:00.678977 [info ] [Thread-1 (]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m19:38:00.679975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_project.unique_my_first_dbt_model_id.16e066b321, now test.test_project.unique_my_second_dbt_model_id.57a0f8c493)
[0m19:38:00.679975 [debug] [Thread-1 (]: Began compiling node test.test_project.unique_my_second_dbt_model_id.57a0f8c493
[0m19:38:00.683974 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:38:00.686130 [debug] [Thread-1 (]: Began executing node test.test_project.unique_my_second_dbt_model_id.57a0f8c493
[0m19:38:00.689130 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:38:00.691129 [debug] [Thread-1 (]: Using postgres connection "test.test_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:38:00.692132 [debug] [Thread-1 (]: On test.test_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m19:38:00.693131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:38:00.770354 [debug] [Thread-1 (]: SQL status: BEGIN in 0.077 seconds
[0m19:38:00.771358 [debug] [Thread-1 (]: Using postgres connection "test.test_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:38:00.772354 [debug] [Thread-1 (]: On test.test_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "test.test_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "test_db"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:38:00.773356 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:38:00.775868 [debug] [Thread-1 (]: On test.test_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m19:38:00.776869 [debug] [Thread-1 (]: On test.test_project.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m19:38:00.777871 [info ] [Thread-1 (]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.10s]
[0m19:38:00.778872 [debug] [Thread-1 (]: Finished running node test.test_project.unique_my_second_dbt_model_id.57a0f8c493
[0m19:38:00.780869 [debug] [MainThread]: Using postgres connection "master"
[0m19:38:00.780869 [debug] [MainThread]: On master: BEGIN
[0m19:38:00.781867 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:38:00.859502 [debug] [MainThread]: SQL status: BEGIN in 0.078 seconds
[0m19:38:00.860506 [debug] [MainThread]: On master: COMMIT
[0m19:38:00.861506 [debug] [MainThread]: Using postgres connection "master"
[0m19:38:00.861506 [debug] [MainThread]: On master: COMMIT
[0m19:38:00.862506 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:38:00.862506 [debug] [MainThread]: On master: Close
[0m19:38:00.863506 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:38:00.863506 [debug] [MainThread]: Connection 'list_test_db_public' was properly closed.
[0m19:38:00.865015 [debug] [MainThread]: Connection 'test.test_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m19:38:00.865015 [info ] [MainThread]: 
[0m19:38:00.866023 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 1.03 seconds (1.03s).
[0m19:38:00.868022 [debug] [MainThread]: Command end result
[0m19:38:00.900110 [info ] [MainThread]: 
[0m19:38:00.901106 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:38:00.902109 [info ] [MainThread]: 
[0m19:38:00.902109 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:38:00.904107 [debug] [MainThread]: Command `dbt test` succeeded at 19:38:00.904107 after 1.80 seconds
[0m19:38:00.905109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE398B2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE25DA0C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE40D33E0>]}
[0m19:38:00.905620 [debug] [MainThread]: Flushing usage events
[0m19:39:47.095409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223B39ACAA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223B5769D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223B6496330>]}


============================== 19:39:47.100549 | 22b3cfb7-b9eb-4d0a-b535-21e2654f78ad ==============================
[0m19:39:47.100549 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:39:47.101746 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test\\logs', 'profiles_dir': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models my_first_dbt_model', 'send_anonymous_usage_stats': 'True'}
[0m19:39:47.333290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22b3cfb7-b9eb-4d0a-b535-21e2654f78ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223B5511D60>]}
[0m19:39:47.381664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22b3cfb7-b9eb-4d0a-b535-21e2654f78ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223B6605A30>]}
[0m19:39:47.383665 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:39:47.392175 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m19:39:47.568026 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:39:47.569031 [debug] [MainThread]: Partial parsing: updated file: test_project://test_project/models\example\my_first_dbt_model.sql
[0m19:39:47.877730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22b3cfb7-b9eb-4d0a-b535-21e2654f78ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223B79C13A0>]}
[0m19:39:47.968742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22b3cfb7-b9eb-4d0a-b535-21e2654f78ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223B686A9F0>]}
[0m19:39:47.969509 [info ] [MainThread]: Found 3 models, 4 data tests, 417 macros
[0m19:39:47.970507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22b3cfb7-b9eb-4d0a-b535-21e2654f78ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223B7A80380>]}
[0m19:39:47.971509 [info ] [MainThread]: 
[0m19:39:47.973014 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:39:47.974525 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_db'
[0m19:39:48.144314 [debug] [ThreadPool]: Using postgres connection "list_test_db"
[0m19:39:48.145314 [debug] [ThreadPool]: On list_test_db: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "list_test_db"} */

    select distinct nspname from pg_namespace
  
[0m19:39:48.145314 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:48.228084 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.082 seconds
[0m19:39:48.230080 [debug] [ThreadPool]: On list_test_db: Close
[0m19:39:48.235082 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_db_public'
[0m19:39:48.240199 [debug] [ThreadPool]: Using postgres connection "list_test_db_public"
[0m19:39:48.241167 [debug] [ThreadPool]: On list_test_db_public: BEGIN
[0m19:39:48.241167 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:48.315114 [debug] [ThreadPool]: SQL status: BEGIN in 0.073 seconds
[0m19:39:48.315620 [debug] [ThreadPool]: Using postgres connection "list_test_db_public"
[0m19:39:48.316626 [debug] [ThreadPool]: On list_test_db_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "list_test_db_public"} */
select
      'test_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'test_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:39:48.321135 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m19:39:48.323137 [debug] [ThreadPool]: On list_test_db_public: ROLLBACK
[0m19:39:48.324136 [debug] [ThreadPool]: On list_test_db_public: Close
[0m19:39:48.328137 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:48.329139 [debug] [MainThread]: On master: BEGIN
[0m19:39:48.330137 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:39:48.402897 [debug] [MainThread]: SQL status: BEGIN in 0.073 seconds
[0m19:39:48.402897 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:48.403901 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:39:48.410909 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m19:39:48.411910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22b3cfb7-b9eb-4d0a-b535-21e2654f78ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223B7BEC4A0>]}
[0m19:39:48.412906 [debug] [MainThread]: On master: ROLLBACK
[0m19:39:48.413908 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:48.414907 [debug] [MainThread]: On master: BEGIN
[0m19:39:48.414907 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:39:48.415908 [debug] [MainThread]: On master: COMMIT
[0m19:39:48.416907 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:48.416907 [debug] [MainThread]: On master: COMMIT
[0m19:39:48.417907 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:39:48.418907 [debug] [MainThread]: On master: Close
[0m19:39:48.418907 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:39:48.419907 [info ] [MainThread]: 
[0m19:39:48.423907 [debug] [Thread-1 (]: Began running node model.test_project.my_first_dbt_model
[0m19:39:48.423907 [info ] [Thread-1 (]: 1 of 1 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m19:39:48.424909 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.test_project.my_first_dbt_model'
[0m19:39:48.426163 [debug] [Thread-1 (]: Began compiling node model.test_project.my_first_dbt_model
[0m19:39:48.432163 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_project.my_first_dbt_model"
[0m19:39:48.434164 [debug] [Thread-1 (]: Began executing node model.test_project.my_first_dbt_model
[0m19:39:48.467744 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_project.my_first_dbt_model"
[0m19:39:48.469750 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_first_dbt_model"
[0m19:39:48.470753 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: BEGIN
[0m19:39:48.470753 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:39:48.547254 [debug] [Thread-1 (]: SQL status: BEGIN in 0.076 seconds
[0m19:39:48.548254 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_first_dbt_model"
[0m19:39:48.548254 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.my_first_dbt_model"} */

  
    

  create  table "test_db"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

--where id is not null
  );
  
[0m19:39:48.553255 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.003 seconds
[0m19:39:48.558766 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_first_dbt_model"
[0m19:39:48.558766 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.my_first_dbt_model"} */
alter table "test_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:39:48.559768 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:39:48.562766 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_first_dbt_model"
[0m19:39:48.563766 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.my_first_dbt_model"} */
alter table "test_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:39:48.564765 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:39:48.583527 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: COMMIT
[0m19:39:48.584528 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_first_dbt_model"
[0m19:39:48.585529 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: COMMIT
[0m19:39:48.586788 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:39:48.591797 [debug] [Thread-1 (]: Applying DROP to: "test_db"."public"."my_first_dbt_model__dbt_backup"
[0m19:39:48.596800 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_first_dbt_model"
[0m19:39:48.597798 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.my_first_dbt_model"} */
drop table if exists "test_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m19:39:48.600801 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m19:39:48.602800 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: Close
[0m19:39:48.604802 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22b3cfb7-b9eb-4d0a-b535-21e2654f78ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223B3ED2060>]}
[0m19:39:48.605801 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.18s]
[0m19:39:48.606800 [debug] [Thread-1 (]: Finished running node model.test_project.my_first_dbt_model
[0m19:39:48.608798 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:48.608798 [debug] [MainThread]: On master: BEGIN
[0m19:39:48.609798 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:39:48.691317 [debug] [MainThread]: SQL status: BEGIN in 0.081 seconds
[0m19:39:48.692316 [debug] [MainThread]: On master: COMMIT
[0m19:39:48.692316 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:48.693315 [debug] [MainThread]: On master: COMMIT
[0m19:39:48.693315 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:39:48.694315 [debug] [MainThread]: On master: Close
[0m19:39:48.695315 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:39:48.696315 [debug] [MainThread]: Connection 'list_test_db' was properly closed.
[0m19:39:48.696315 [debug] [MainThread]: Connection 'list_test_db_public' was properly closed.
[0m19:39:48.697318 [debug] [MainThread]: Connection 'model.test_project.my_first_dbt_model' was properly closed.
[0m19:39:48.697318 [info ] [MainThread]: 
[0m19:39:48.698823 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m19:39:48.699828 [debug] [MainThread]: Command end result
[0m19:39:48.731440 [info ] [MainThread]: 
[0m19:39:48.731440 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:39:48.733001 [info ] [MainThread]: 
[0m19:39:48.733952 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:39:48.735951 [debug] [MainThread]: Command `dbt run` succeeded at 19:39:48.735951 after 1.80 seconds
[0m19:39:48.735951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223B62AFC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223B7A8ACC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223B7B833B0>]}
[0m19:39:48.736952 [debug] [MainThread]: Flushing usage events
[0m19:39:55.050421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5FEDD8DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5814ACE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5FFE92D20>]}


============================== 19:39:55.055426 | 5dbc7dba-a9e0-476d-acdc-b6f836f16f5e ==============================
[0m19:39:55.055426 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:39:55.056429 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:39:55.259186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5dbc7dba-a9e0-476d-acdc-b6f836f16f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5FEDD8DA0>]}
[0m19:39:55.306768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5dbc7dba-a9e0-476d-acdc-b6f836f16f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C58197F6E0>]}
[0m19:39:55.307768 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:39:55.316791 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m19:39:55.500213 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:39:55.501214 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:39:55.530484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dbc7dba-a9e0-476d-acdc-b6f836f16f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C581C63650>]}
[0m19:39:55.633551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dbc7dba-a9e0-476d-acdc-b6f836f16f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C582F7D3D0>]}
[0m19:39:55.634557 [info ] [MainThread]: Found 3 models, 4 data tests, 417 macros
[0m19:39:55.635560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dbc7dba-a9e0-476d-acdc-b6f836f16f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C581C063F0>]}
[0m19:39:55.638558 [info ] [MainThread]: 
[0m19:39:55.639557 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:39:55.643556 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_db_public'
[0m19:39:55.821901 [debug] [ThreadPool]: Using postgres connection "list_test_db_public"
[0m19:39:55.822901 [debug] [ThreadPool]: On list_test_db_public: BEGIN
[0m19:39:55.822901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:56.007293 [debug] [ThreadPool]: SQL status: BEGIN in 0.184 seconds
[0m19:39:56.007293 [debug] [ThreadPool]: Using postgres connection "list_test_db_public"
[0m19:39:56.008290 [debug] [ThreadPool]: On list_test_db_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "list_test_db_public"} */
select
      'test_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'test_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:39:56.013295 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m19:39:56.014800 [debug] [ThreadPool]: On list_test_db_public: ROLLBACK
[0m19:39:56.015805 [debug] [ThreadPool]: On list_test_db_public: Close
[0m19:39:56.020858 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:56.021856 [debug] [MainThread]: On master: BEGIN
[0m19:39:56.021856 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:39:56.096176 [debug] [MainThread]: SQL status: BEGIN in 0.074 seconds
[0m19:39:56.097176 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:56.098177 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:39:56.103172 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m19:39:56.105177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dbc7dba-a9e0-476d-acdc-b6f836f16f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C581AC7710>]}
[0m19:39:56.105177 [debug] [MainThread]: On master: ROLLBACK
[0m19:39:56.106245 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:56.107173 [debug] [MainThread]: On master: BEGIN
[0m19:39:56.107173 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:39:56.108426 [debug] [MainThread]: On master: COMMIT
[0m19:39:56.109424 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:56.109424 [debug] [MainThread]: On master: COMMIT
[0m19:39:56.110423 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:39:56.110423 [debug] [MainThread]: On master: Close
[0m19:39:56.111424 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:39:56.112428 [info ] [MainThread]: 
[0m19:39:56.117427 [debug] [Thread-1 (]: Began running node test.test_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:39:56.117427 [info ] [Thread-1 (]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m19:39:56.118424 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.test_project.not_null_my_first_dbt_model_id.5fb22c2710'
[0m19:39:56.119423 [debug] [Thread-1 (]: Began compiling node test.test_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:39:56.133450 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:39:56.135449 [debug] [Thread-1 (]: Began executing node test.test_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:39:56.148971 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:39:56.151969 [debug] [Thread-1 (]: Using postgres connection "test.test_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:39:56.151969 [debug] [Thread-1 (]: On test.test_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m19:39:56.152969 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:39:56.226215 [debug] [Thread-1 (]: SQL status: BEGIN in 0.073 seconds
[0m19:39:56.226271 [debug] [Thread-1 (]: Using postgres connection "test.test_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:39:56.227216 [debug] [Thread-1 (]: On test.test_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "test.test_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "test_db"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m19:39:56.228215 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:39:56.232215 [debug] [Thread-1 (]: On test.test_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m19:39:56.233212 [debug] [Thread-1 (]: On test.test_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m19:39:56.233212 [error] [Thread-1 (]: 1 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.11s]
[0m19:39:56.235271 [debug] [Thread-1 (]: Finished running node test.test_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:39:56.235271 [debug] [Thread-1 (]: Began running node test.test_project.not_null_my_second_dbt_model_id.151b76d778
[0m19:39:56.236271 [info ] [Thread-1 (]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m19:39:56.237272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_project.not_null_my_first_dbt_model_id.5fb22c2710, now test.test_project.not_null_my_second_dbt_model_id.151b76d778)
[0m19:39:56.238272 [debug] [Thread-1 (]: Began compiling node test.test_project.not_null_my_second_dbt_model_id.151b76d778
[0m19:39:56.241548 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_project.not_null_my_second_dbt_model_id.151b76d778"
[0m19:39:56.243549 [debug] [Thread-1 (]: Began executing node test.test_project.not_null_my_second_dbt_model_id.151b76d778
[0m19:39:56.245610 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_project.not_null_my_second_dbt_model_id.151b76d778"
[0m19:39:56.247552 [debug] [Thread-1 (]: Using postgres connection "test.test_project.not_null_my_second_dbt_model_id.151b76d778"
[0m19:39:56.247552 [debug] [Thread-1 (]: On test.test_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m19:39:56.249057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:56.325776 [debug] [Thread-1 (]: SQL status: BEGIN in 0.076 seconds
[0m19:39:56.326782 [debug] [Thread-1 (]: Using postgres connection "test.test_project.not_null_my_second_dbt_model_id.151b76d778"
[0m19:39:56.326782 [debug] [Thread-1 (]: On test.test_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "test.test_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "test_db"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m19:39:56.328784 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.my_second_dbt_model" does not exist
LINE 14: from "test_db"."public"."my_second_dbt_model"
              ^

[0m19:39:56.328784 [debug] [Thread-1 (]: On test.test_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m19:39:56.329783 [debug] [Thread-1 (]: On test.test_project.not_null_my_second_dbt_model_id.151b76d778: Close
[0m19:39:56.336921 [debug] [Thread-1 (]: Database Error in test not_null_my_second_dbt_model_id (test_project/models\example\schema.yml)
  relation "public.my_second_dbt_model" does not exist
  LINE 14: from "test_db"."public"."my_second_dbt_model"
                ^
  compiled Code at target\run\test_project\test_project/models\example\schema.yml\not_null_my_second_dbt_model_id.sql
[0m19:39:56.336921 [error] [Thread-1 (]: 2 of 4 ERROR not_null_my_second_dbt_model_id ................................... [[31mERROR[0m in 0.10s]
[0m19:39:56.338922 [debug] [Thread-1 (]: Finished running node test.test_project.not_null_my_second_dbt_model_id.151b76d778
[0m19:39:56.338922 [debug] [Thread-1 (]: Began running node test.test_project.unique_my_first_dbt_model_id.16e066b321
[0m19:39:56.339921 [info ] [Thread-1 (]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m19:39:56.340924 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_project.not_null_my_second_dbt_model_id.151b76d778, now test.test_project.unique_my_first_dbt_model_id.16e066b321)
[0m19:39:56.341922 [debug] [Thread-1 (]: Began compiling node test.test_project.unique_my_first_dbt_model_id.16e066b321
[0m19:39:56.348430 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_project.unique_my_first_dbt_model_id.16e066b321"
[0m19:39:56.350436 [debug] [Thread-1 (]: Began executing node test.test_project.unique_my_first_dbt_model_id.16e066b321
[0m19:39:56.352432 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_project.unique_my_first_dbt_model_id.16e066b321"
[0m19:39:56.355432 [debug] [Thread-1 (]: Using postgres connection "test.test_project.unique_my_first_dbt_model_id.16e066b321"
[0m19:39:56.356481 [debug] [Thread-1 (]: On test.test_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m19:39:56.356481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:56.432316 [debug] [Thread-1 (]: SQL status: BEGIN in 0.075 seconds
[0m19:39:56.433317 [debug] [Thread-1 (]: Using postgres connection "test.test_project.unique_my_first_dbt_model_id.16e066b321"
[0m19:39:56.433317 [debug] [Thread-1 (]: On test.test_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "test.test_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "test_db"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:39:56.435833 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:39:56.437831 [debug] [Thread-1 (]: On test.test_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m19:39:56.438834 [debug] [Thread-1 (]: On test.test_project.unique_my_first_dbt_model_id.16e066b321: Close
[0m19:39:56.438834 [info ] [Thread-1 (]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.10s]
[0m19:39:56.440833 [debug] [Thread-1 (]: Finished running node test.test_project.unique_my_first_dbt_model_id.16e066b321
[0m19:39:56.441830 [debug] [Thread-1 (]: Began running node test.test_project.unique_my_second_dbt_model_id.57a0f8c493
[0m19:39:56.441830 [info ] [Thread-1 (]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m19:39:56.442832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_project.unique_my_first_dbt_model_id.16e066b321, now test.test_project.unique_my_second_dbt_model_id.57a0f8c493)
[0m19:39:56.443831 [debug] [Thread-1 (]: Began compiling node test.test_project.unique_my_second_dbt_model_id.57a0f8c493
[0m19:39:56.447344 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:39:56.449342 [debug] [Thread-1 (]: Began executing node test.test_project.unique_my_second_dbt_model_id.57a0f8c493
[0m19:39:56.452344 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:39:56.454345 [debug] [Thread-1 (]: Using postgres connection "test.test_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:39:56.454345 [debug] [Thread-1 (]: On test.test_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m19:39:56.455347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:56.635872 [debug] [Thread-1 (]: SQL status: BEGIN in 0.180 seconds
[0m19:39:56.636922 [debug] [Thread-1 (]: Using postgres connection "test.test_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:39:56.637443 [debug] [Thread-1 (]: On test.test_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "test.test_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "test_db"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:39:56.638486 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.my_second_dbt_model" does not exist
LINE 15: from "test_db"."public"."my_second_dbt_model"
              ^

[0m19:39:56.639005 [debug] [Thread-1 (]: On test.test_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m19:39:56.640051 [debug] [Thread-1 (]: On test.test_project.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m19:39:56.643740 [debug] [Thread-1 (]: Database Error in test unique_my_second_dbt_model_id (test_project/models\example\schema.yml)
  relation "public.my_second_dbt_model" does not exist
  LINE 15: from "test_db"."public"."my_second_dbt_model"
                ^
  compiled Code at target\run\test_project\test_project/models\example\schema.yml\unique_my_second_dbt_model_id.sql
[0m19:39:56.644794 [error] [Thread-1 (]: 4 of 4 ERROR unique_my_second_dbt_model_id ..................................... [[31mERROR[0m in 0.20s]
[0m19:39:56.645845 [debug] [Thread-1 (]: Finished running node test.test_project.unique_my_second_dbt_model_id.57a0f8c493
[0m19:39:56.647426 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:56.647949 [debug] [MainThread]: On master: BEGIN
[0m19:39:56.648467 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:39:56.742378 [debug] [MainThread]: SQL status: BEGIN in 0.094 seconds
[0m19:39:56.742378 [debug] [MainThread]: On master: COMMIT
[0m19:39:56.743378 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:56.743378 [debug] [MainThread]: On master: COMMIT
[0m19:39:56.744883 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:39:56.745889 [debug] [MainThread]: On master: Close
[0m19:39:56.745948 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:39:56.746892 [debug] [MainThread]: Connection 'list_test_db_public' was properly closed.
[0m19:39:56.746892 [debug] [MainThread]: Connection 'test.test_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m19:39:56.747891 [info ] [MainThread]: 
[0m19:39:56.748888 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 1.11 seconds (1.11s).
[0m19:39:56.749889 [debug] [MainThread]: Command end result
[0m19:39:56.781461 [info ] [MainThread]: 
[0m19:39:56.782462 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m19:39:56.783458 [info ] [MainThread]: 
[0m19:39:56.784459 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (test_project/models\example\schema.yml)[0m
[0m19:39:56.785538 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m19:39:56.785538 [info ] [MainThread]: 
[0m19:39:56.786538 [info ] [MainThread]:   compiled code at target\compiled\test_project\test_project/models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m19:39:56.787537 [info ] [MainThread]: 
[0m19:39:56.788541 [error] [MainThread]:   Database Error in test not_null_my_second_dbt_model_id (test_project/models\example\schema.yml)
  relation "public.my_second_dbt_model" does not exist
  LINE 14: from "test_db"."public"."my_second_dbt_model"
                ^
  compiled Code at target\run\test_project\test_project/models\example\schema.yml\not_null_my_second_dbt_model_id.sql
[0m19:39:56.789540 [info ] [MainThread]: 
[0m19:39:56.790538 [error] [MainThread]:   Database Error in test unique_my_second_dbt_model_id (test_project/models\example\schema.yml)
  relation "public.my_second_dbt_model" does not exist
  LINE 15: from "test_db"."public"."my_second_dbt_model"
                ^
  compiled Code at target\run\test_project\test_project/models\example\schema.yml\unique_my_second_dbt_model_id.sql
[0m19:39:56.791538 [info ] [MainThread]: 
[0m19:39:56.792537 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=0 TOTAL=4
[0m19:39:56.794538 [debug] [MainThread]: Command `dbt test` failed at 19:39:56.793537 after 1.89 seconds
[0m19:39:56.794538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5816D7E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C582DBB9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5FF3D3BF0>]}
[0m19:39:56.795541 [debug] [MainThread]: Flushing usage events
[0m19:41:02.476084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027079718F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002707BE43200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002707C049610>]}


============================== 19:41:02.480083 | 8279c9e0-57f1-4515-a310-a8426ad87080 ==============================
[0m19:41:02.480083 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:41:02.480589 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models my_first_dbt_model', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:41:02.684750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8279c9e0-57f1-4515-a310-a8426ad87080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002707B262000>]}
[0m19:41:02.731228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8279c9e0-57f1-4515-a310-a8426ad87080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002707BE15670>]}
[0m19:41:02.733227 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:41:02.741248 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m19:41:02.944905 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:41:02.945928 [debug] [MainThread]: Partial parsing: updated file: test_project://test_project/models\example\my_first_dbt_model.sql
[0m19:41:03.278478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8279c9e0-57f1-4515-a310-a8426ad87080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002707D7E0BC0>]}
[0m19:41:03.369814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8279c9e0-57f1-4515-a310-a8426ad87080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002707C4F6C90>]}
[0m19:41:03.369814 [info ] [MainThread]: Found 3 models, 4 data tests, 417 macros
[0m19:41:03.370811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8279c9e0-57f1-4515-a310-a8426ad87080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002707C594E30>]}
[0m19:41:03.372813 [info ] [MainThread]: 
[0m19:41:03.373813 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:41:03.375318 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_db'
[0m19:41:03.548716 [debug] [ThreadPool]: Using postgres connection "list_test_db"
[0m19:41:03.548716 [debug] [ThreadPool]: On list_test_db: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "list_test_db"} */

    select distinct nspname from pg_namespace
  
[0m19:41:03.549716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:41:03.628330 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.078 seconds
[0m19:41:03.629331 [debug] [ThreadPool]: On list_test_db: Close
[0m19:41:03.633330 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_db_public'
[0m19:41:03.638842 [debug] [ThreadPool]: Using postgres connection "list_test_db_public"
[0m19:41:03.639844 [debug] [ThreadPool]: On list_test_db_public: BEGIN
[0m19:41:03.639844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:41:03.714279 [debug] [ThreadPool]: SQL status: BEGIN in 0.074 seconds
[0m19:41:03.715278 [debug] [ThreadPool]: Using postgres connection "list_test_db_public"
[0m19:41:03.715784 [debug] [ThreadPool]: On list_test_db_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "list_test_db_public"} */
select
      'test_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'test_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:41:03.720294 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m19:41:03.722302 [debug] [ThreadPool]: On list_test_db_public: ROLLBACK
[0m19:41:03.722302 [debug] [ThreadPool]: On list_test_db_public: Close
[0m19:41:03.727300 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:03.727300 [debug] [MainThread]: On master: BEGIN
[0m19:41:03.728300 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:41:03.807023 [debug] [MainThread]: SQL status: BEGIN in 0.079 seconds
[0m19:41:03.808023 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:03.809022 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:41:03.815023 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m19:41:03.815529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8279c9e0-57f1-4515-a310-a8426ad87080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002707C2F4230>]}
[0m19:41:03.816534 [debug] [MainThread]: On master: ROLLBACK
[0m19:41:03.817536 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:03.817536 [debug] [MainThread]: On master: BEGIN
[0m19:41:03.818536 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:41:03.818536 [debug] [MainThread]: On master: COMMIT
[0m19:41:03.820041 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:03.820041 [debug] [MainThread]: On master: COMMIT
[0m19:41:03.821049 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:41:03.822048 [debug] [MainThread]: On master: Close
[0m19:41:03.822048 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:41:03.823125 [info ] [MainThread]: 
[0m19:41:03.826099 [debug] [Thread-1 (]: Began running node model.test_project.my_first_dbt_model
[0m19:41:03.827605 [info ] [Thread-1 (]: 1 of 1 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m19:41:03.828611 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.test_project.my_first_dbt_model'
[0m19:41:03.829612 [debug] [Thread-1 (]: Began compiling node model.test_project.my_first_dbt_model
[0m19:41:03.835118 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_project.my_first_dbt_model"
[0m19:41:03.837125 [debug] [Thread-1 (]: Began executing node model.test_project.my_first_dbt_model
[0m19:41:03.872796 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_project.my_first_dbt_model"
[0m19:41:03.875311 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_first_dbt_model"
[0m19:41:03.875311 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: BEGIN
[0m19:41:03.876317 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:41:03.948940 [debug] [Thread-1 (]: SQL status: BEGIN in 0.073 seconds
[0m19:41:03.949941 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_first_dbt_model"
[0m19:41:03.950941 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.my_first_dbt_model"} */

  
    

  create  table "test_db"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

where id is not null
  );
  
[0m19:41:03.954939 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:41:03.960965 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_first_dbt_model"
[0m19:41:03.960965 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.my_first_dbt_model"} */
alter table "test_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:41:03.961964 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:41:03.964962 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_first_dbt_model"
[0m19:41:03.964962 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.my_first_dbt_model"} */
alter table "test_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:41:03.966962 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:41:03.983981 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: COMMIT
[0m19:41:03.984982 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_first_dbt_model"
[0m19:41:03.986035 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: COMMIT
[0m19:41:03.986981 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:41:03.991979 [debug] [Thread-1 (]: Applying DROP to: "test_db"."public"."my_first_dbt_model__dbt_backup"
[0m19:41:03.996489 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_first_dbt_model"
[0m19:41:03.997489 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.my_first_dbt_model"} */
drop table if exists "test_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m19:41:04.001001 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m19:41:04.003509 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: Close
[0m19:41:04.004516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8279c9e0-57f1-4515-a310-a8426ad87080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027079C2E5A0>]}
[0m19:41:04.004516 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 1[0m in 0.17s]
[0m19:41:04.006022 [debug] [Thread-1 (]: Finished running node model.test_project.my_first_dbt_model
[0m19:41:04.008543 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:04.008543 [debug] [MainThread]: On master: BEGIN
[0m19:41:04.009541 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:41:04.085612 [debug] [MainThread]: SQL status: BEGIN in 0.076 seconds
[0m19:41:04.086557 [debug] [MainThread]: On master: COMMIT
[0m19:41:04.087556 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:04.087556 [debug] [MainThread]: On master: COMMIT
[0m19:41:04.088557 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:41:04.088557 [debug] [MainThread]: On master: Close
[0m19:41:04.089557 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:41:04.090557 [debug] [MainThread]: Connection 'list_test_db' was properly closed.
[0m19:41:04.091557 [debug] [MainThread]: Connection 'list_test_db_public' was properly closed.
[0m19:41:04.091557 [debug] [MainThread]: Connection 'model.test_project.my_first_dbt_model' was properly closed.
[0m19:41:04.092556 [info ] [MainThread]: 
[0m19:41:04.092556 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m19:41:04.093556 [debug] [MainThread]: Command end result
[0m19:41:04.124706 [info ] [MainThread]: 
[0m19:41:04.125708 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:41:04.126707 [info ] [MainThread]: 
[0m19:41:04.127213 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:41:04.128220 [debug] [MainThread]: Command `dbt run` succeeded at 19:41:04.128220 after 1.80 seconds
[0m19:41:04.129218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002707C1D6330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002707B4E3BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002707BED60C0>]}
[0m19:41:04.130221 [debug] [MainThread]: Flushing usage events
[0m19:41:10.240191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF239162A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF2388FBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF22FF4D70>]}


============================== 19:41:10.245709 | e958a25a-1dcc-4b2b-8402-837daa8a8590 ==============================
[0m19:41:10.245709 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:41:10.246709 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:41:10.482864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e958a25a-1dcc-4b2b-8402-837daa8a8590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF23B4B8C0>]}
[0m19:41:10.531455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e958a25a-1dcc-4b2b-8402-837daa8a8590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF236B5790>]}
[0m19:41:10.533458 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:41:10.541489 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m19:41:10.723609 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:41:10.724576 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:41:10.755115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e958a25a-1dcc-4b2b-8402-837daa8a8590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF23D97380>]}
[0m19:41:10.862108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e958a25a-1dcc-4b2b-8402-837daa8a8590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF2515D490>]}
[0m19:41:10.863109 [info ] [MainThread]: Found 3 models, 4 data tests, 417 macros
[0m19:41:10.864107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e958a25a-1dcc-4b2b-8402-837daa8a8590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF23D5FEF0>]}
[0m19:41:10.866169 [info ] [MainThread]: 
[0m19:41:10.867108 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:41:10.870108 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_db_public'
[0m19:41:11.046189 [debug] [ThreadPool]: Using postgres connection "list_test_db_public"
[0m19:41:11.047125 [debug] [ThreadPool]: On list_test_db_public: BEGIN
[0m19:41:11.047125 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:41:11.126410 [debug] [ThreadPool]: SQL status: BEGIN in 0.079 seconds
[0m19:41:11.127320 [debug] [ThreadPool]: Using postgres connection "list_test_db_public"
[0m19:41:11.128318 [debug] [ThreadPool]: On list_test_db_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "list_test_db_public"} */
select
      'test_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'test_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:41:11.133318 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m19:41:11.134822 [debug] [ThreadPool]: On list_test_db_public: ROLLBACK
[0m19:41:11.134822 [debug] [ThreadPool]: On list_test_db_public: Close
[0m19:41:11.139828 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:11.139828 [debug] [MainThread]: On master: BEGIN
[0m19:41:11.141129 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:41:11.213878 [debug] [MainThread]: SQL status: BEGIN in 0.073 seconds
[0m19:41:11.214878 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:11.215387 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:41:11.220904 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m19:41:11.222905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e958a25a-1dcc-4b2b-8402-837daa8a8590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF23BE7770>]}
[0m19:41:11.223905 [debug] [MainThread]: On master: ROLLBACK
[0m19:41:11.224906 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:11.224906 [debug] [MainThread]: On master: BEGIN
[0m19:41:11.225957 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:41:11.226904 [debug] [MainThread]: On master: COMMIT
[0m19:41:11.226904 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:11.227903 [debug] [MainThread]: On master: COMMIT
[0m19:41:11.227903 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:41:11.228906 [debug] [MainThread]: On master: Close
[0m19:41:11.229903 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:41:11.230905 [info ] [MainThread]: 
[0m19:41:11.234903 [debug] [Thread-1 (]: Began running node test.test_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:41:11.235959 [info ] [Thread-1 (]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m19:41:11.236961 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.test_project.not_null_my_first_dbt_model_id.5fb22c2710'
[0m19:41:11.237961 [debug] [Thread-1 (]: Began compiling node test.test_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:41:11.252473 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:41:11.254978 [debug] [Thread-1 (]: Began executing node test.test_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:41:11.269514 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:41:11.271514 [debug] [Thread-1 (]: Using postgres connection "test.test_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:41:11.272516 [debug] [Thread-1 (]: On test.test_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m19:41:11.273518 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:41:11.441804 [debug] [Thread-1 (]: SQL status: BEGIN in 0.168 seconds
[0m19:41:11.442805 [debug] [Thread-1 (]: Using postgres connection "test.test_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:41:11.443309 [debug] [Thread-1 (]: On test.test_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "test.test_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "test_db"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m19:41:11.444315 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:41:11.447820 [debug] [Thread-1 (]: On test.test_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m19:41:11.448826 [debug] [Thread-1 (]: On test.test_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m19:41:11.449826 [info ] [Thread-1 (]: 1 of 4 PASS not_null_my_first_dbt_model_id ..................................... [[32mPASS[0m in 0.21s]
[0m19:41:11.450826 [debug] [Thread-1 (]: Finished running node test.test_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:41:11.451826 [debug] [Thread-1 (]: Began running node test.test_project.not_null_my_second_dbt_model_id.151b76d778
[0m19:41:11.452826 [info ] [Thread-1 (]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m19:41:11.453826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_project.not_null_my_first_dbt_model_id.5fb22c2710, now test.test_project.not_null_my_second_dbt_model_id.151b76d778)
[0m19:41:11.453826 [debug] [Thread-1 (]: Began compiling node test.test_project.not_null_my_second_dbt_model_id.151b76d778
[0m19:41:11.458336 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_project.not_null_my_second_dbt_model_id.151b76d778"
[0m19:41:11.460337 [debug] [Thread-1 (]: Began executing node test.test_project.not_null_my_second_dbt_model_id.151b76d778
[0m19:41:11.461850 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_project.not_null_my_second_dbt_model_id.151b76d778"
[0m19:41:11.463851 [debug] [Thread-1 (]: Using postgres connection "test.test_project.not_null_my_second_dbt_model_id.151b76d778"
[0m19:41:11.464852 [debug] [Thread-1 (]: On test.test_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m19:41:11.465912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:41:11.541280 [debug] [Thread-1 (]: SQL status: BEGIN in 0.075 seconds
[0m19:41:11.542277 [debug] [Thread-1 (]: Using postgres connection "test.test_project.not_null_my_second_dbt_model_id.151b76d778"
[0m19:41:11.543277 [debug] [Thread-1 (]: On test.test_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "test.test_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "test_db"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m19:41:11.544276 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.my_second_dbt_model" does not exist
LINE 14: from "test_db"."public"."my_second_dbt_model"
              ^

[0m19:41:11.544276 [debug] [Thread-1 (]: On test.test_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m19:41:11.545276 [debug] [Thread-1 (]: On test.test_project.not_null_my_second_dbt_model_id.151b76d778: Close
[0m19:41:11.552277 [debug] [Thread-1 (]: Database Error in test not_null_my_second_dbt_model_id (test_project/models\example\schema.yml)
  relation "public.my_second_dbt_model" does not exist
  LINE 14: from "test_db"."public"."my_second_dbt_model"
                ^
  compiled Code at target\run\test_project\test_project/models\example\schema.yml\not_null_my_second_dbt_model_id.sql
[0m19:41:11.553276 [error] [Thread-1 (]: 2 of 4 ERROR not_null_my_second_dbt_model_id ................................... [[31mERROR[0m in 0.10s]
[0m19:41:11.554276 [debug] [Thread-1 (]: Finished running node test.test_project.not_null_my_second_dbt_model_id.151b76d778
[0m19:41:11.555276 [debug] [Thread-1 (]: Began running node test.test_project.unique_my_first_dbt_model_id.16e066b321
[0m19:41:11.556702 [info ] [Thread-1 (]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m19:41:11.557700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_project.not_null_my_second_dbt_model_id.151b76d778, now test.test_project.unique_my_first_dbt_model_id.16e066b321)
[0m19:41:11.557700 [debug] [Thread-1 (]: Began compiling node test.test_project.unique_my_first_dbt_model_id.16e066b321
[0m19:41:11.563722 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_project.unique_my_first_dbt_model_id.16e066b321"
[0m19:41:11.566727 [debug] [Thread-1 (]: Began executing node test.test_project.unique_my_first_dbt_model_id.16e066b321
[0m19:41:11.568296 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_project.unique_my_first_dbt_model_id.16e066b321"
[0m19:41:11.570397 [debug] [Thread-1 (]: Using postgres connection "test.test_project.unique_my_first_dbt_model_id.16e066b321"
[0m19:41:11.571449 [debug] [Thread-1 (]: On test.test_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m19:41:11.571975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:41:11.645867 [debug] [Thread-1 (]: SQL status: BEGIN in 0.074 seconds
[0m19:41:11.646809 [debug] [Thread-1 (]: Using postgres connection "test.test_project.unique_my_first_dbt_model_id.16e066b321"
[0m19:41:11.647810 [debug] [Thread-1 (]: On test.test_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "test.test_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "test_db"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:41:11.649808 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:41:11.650810 [debug] [Thread-1 (]: On test.test_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m19:41:11.651810 [debug] [Thread-1 (]: On test.test_project.unique_my_first_dbt_model_id.16e066b321: Close
[0m19:41:11.652808 [info ] [Thread-1 (]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.10s]
[0m19:41:11.653809 [debug] [Thread-1 (]: Finished running node test.test_project.unique_my_first_dbt_model_id.16e066b321
[0m19:41:11.655315 [debug] [Thread-1 (]: Began running node test.test_project.unique_my_second_dbt_model_id.57a0f8c493
[0m19:41:11.655315 [info ] [Thread-1 (]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m19:41:11.656321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_project.unique_my_first_dbt_model_id.16e066b321, now test.test_project.unique_my_second_dbt_model_id.57a0f8c493)
[0m19:41:11.657319 [debug] [Thread-1 (]: Began compiling node test.test_project.unique_my_second_dbt_model_id.57a0f8c493
[0m19:41:11.660323 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:41:11.662596 [debug] [Thread-1 (]: Began executing node test.test_project.unique_my_second_dbt_model_id.57a0f8c493
[0m19:41:11.664596 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:41:11.666595 [debug] [Thread-1 (]: Using postgres connection "test.test_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:41:11.667594 [debug] [Thread-1 (]: On test.test_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m19:41:11.667594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:41:11.742622 [debug] [Thread-1 (]: SQL status: BEGIN in 0.075 seconds
[0m19:41:11.743694 [debug] [Thread-1 (]: Using postgres connection "test.test_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:41:11.744664 [debug] [Thread-1 (]: On test.test_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "test.test_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "test_db"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:41:11.745665 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.my_second_dbt_model" does not exist
LINE 15: from "test_db"."public"."my_second_dbt_model"
              ^

[0m19:41:11.745665 [debug] [Thread-1 (]: On test.test_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m19:41:11.746665 [debug] [Thread-1 (]: On test.test_project.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m19:41:11.751178 [debug] [Thread-1 (]: Database Error in test unique_my_second_dbt_model_id (test_project/models\example\schema.yml)
  relation "public.my_second_dbt_model" does not exist
  LINE 15: from "test_db"."public"."my_second_dbt_model"
                ^
  compiled Code at target\run\test_project\test_project/models\example\schema.yml\unique_my_second_dbt_model_id.sql
[0m19:41:11.752177 [error] [Thread-1 (]: 4 of 4 ERROR unique_my_second_dbt_model_id ..................................... [[31mERROR[0m in 0.10s]
[0m19:41:11.753177 [debug] [Thread-1 (]: Finished running node test.test_project.unique_my_second_dbt_model_id.57a0f8c493
[0m19:41:11.754178 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:11.755176 [debug] [MainThread]: On master: BEGIN
[0m19:41:11.755681 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:41:11.831310 [debug] [MainThread]: SQL status: BEGIN in 0.075 seconds
[0m19:41:11.832308 [debug] [MainThread]: On master: COMMIT
[0m19:41:11.832308 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:11.833310 [debug] [MainThread]: On master: COMMIT
[0m19:41:11.834309 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:41:11.834309 [debug] [MainThread]: On master: Close
[0m19:41:11.835814 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:41:11.835814 [debug] [MainThread]: Connection 'list_test_db_public' was properly closed.
[0m19:41:11.836821 [debug] [MainThread]: Connection 'test.test_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m19:41:11.837821 [info ] [MainThread]: 
[0m19:41:11.837821 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.97 seconds (0.97s).
[0m19:41:11.838820 [debug] [MainThread]: Command end result
[0m19:41:11.868916 [info ] [MainThread]: 
[0m19:41:11.869915 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:41:11.870914 [info ] [MainThread]: 
[0m19:41:11.870914 [error] [MainThread]:   Database Error in test not_null_my_second_dbt_model_id (test_project/models\example\schema.yml)
  relation "public.my_second_dbt_model" does not exist
  LINE 14: from "test_db"."public"."my_second_dbt_model"
                ^
  compiled Code at target\run\test_project\test_project/models\example\schema.yml\not_null_my_second_dbt_model_id.sql
[0m19:41:11.871914 [info ] [MainThread]: 
[0m19:41:11.872916 [error] [MainThread]:   Database Error in test unique_my_second_dbt_model_id (test_project/models\example\schema.yml)
  relation "public.my_second_dbt_model" does not exist
  LINE 15: from "test_db"."public"."my_second_dbt_model"
                ^
  compiled Code at target\run\test_project\test_project/models\example\schema.yml\unique_my_second_dbt_model_id.sql
[0m19:41:11.873917 [info ] [MainThread]: 
[0m19:41:11.874915 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m19:41:11.876931 [debug] [MainThread]: Command `dbt test` failed at 19:41:11.875930 after 1.79 seconds
[0m19:41:11.876931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF23956C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF238E5010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF24F9F710>]}
[0m19:41:11.877930 [debug] [MainThread]: Flushing usage events
[0m19:41:17.156205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E97DD8D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E9A571700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E99B6E420>]}


============================== 19:41:17.160204 | 12bfe2ec-7a33-4524-8b4f-67e5209ce5eb ==============================
[0m19:41:17.160204 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:41:17.161522 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test\\logs', 'profiles_dir': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:41:17.371545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12bfe2ec-7a33-4524-8b4f-67e5209ce5eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E9A8C7890>]}
[0m19:41:17.419147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12bfe2ec-7a33-4524-8b4f-67e5209ce5eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E99941F10>]}
[0m19:41:17.420652 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:41:17.429657 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m19:41:17.621269 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:41:17.622268 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:41:17.652866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12bfe2ec-7a33-4524-8b4f-67e5209ce5eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E9AC5AA50>]}
[0m19:41:17.747629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12bfe2ec-7a33-4524-8b4f-67e5209ce5eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E9AC954C0>]}
[0m19:41:17.747629 [info ] [MainThread]: Found 3 models, 4 data tests, 417 macros
[0m19:41:17.748639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12bfe2ec-7a33-4524-8b4f-67e5209ce5eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E9BDEECF0>]}
[0m19:41:17.750639 [info ] [MainThread]: 
[0m19:41:17.751637 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:41:17.755200 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_db'
[0m19:41:17.928180 [debug] [ThreadPool]: Using postgres connection "list_test_db"
[0m19:41:17.929185 [debug] [ThreadPool]: On list_test_db: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "list_test_db"} */

    select distinct nspname from pg_namespace
  
[0m19:41:17.929185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:41:18.009802 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.080 seconds
[0m19:41:18.010805 [debug] [ThreadPool]: On list_test_db: Close
[0m19:41:18.012803 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_db_public'
[0m19:41:18.018333 [debug] [ThreadPool]: Using postgres connection "list_test_db_public"
[0m19:41:18.019837 [debug] [ThreadPool]: On list_test_db_public: BEGIN
[0m19:41:18.019837 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:41:18.091952 [debug] [ThreadPool]: SQL status: BEGIN in 0.072 seconds
[0m19:41:18.092954 [debug] [ThreadPool]: Using postgres connection "list_test_db_public"
[0m19:41:18.093953 [debug] [ThreadPool]: On list_test_db_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "list_test_db_public"} */
select
      'test_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'test_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:41:18.098465 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m19:41:18.099972 [debug] [ThreadPool]: On list_test_db_public: ROLLBACK
[0m19:41:18.100978 [debug] [ThreadPool]: On list_test_db_public: Close
[0m19:41:18.105032 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:18.106031 [debug] [MainThread]: On master: BEGIN
[0m19:41:18.106031 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:41:18.181659 [debug] [MainThread]: SQL status: BEGIN in 0.075 seconds
[0m19:41:18.182656 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:18.182656 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:41:18.189656 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m19:41:18.190656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12bfe2ec-7a33-4524-8b4f-67e5209ce5eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E9BDE91C0>]}
[0m19:41:18.191656 [debug] [MainThread]: On master: ROLLBACK
[0m19:41:18.191656 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:18.192658 [debug] [MainThread]: On master: BEGIN
[0m19:41:18.193656 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:41:18.193656 [debug] [MainThread]: On master: COMMIT
[0m19:41:18.193656 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:18.195160 [debug] [MainThread]: On master: COMMIT
[0m19:41:18.195160 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:41:18.196166 [debug] [MainThread]: On master: Close
[0m19:41:18.197165 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:41:18.198166 [info ] [MainThread]: 
[0m19:41:18.201316 [debug] [Thread-1 (]: Began running node model.test_project.example_model
[0m19:41:18.202313 [info ] [Thread-1 (]: 1 of 3 START sql view model public.example_model ............................... [RUN]
[0m19:41:18.203316 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.test_project.example_model'
[0m19:41:18.203316 [debug] [Thread-1 (]: Began compiling node model.test_project.example_model
[0m19:41:18.209315 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_project.example_model"
[0m19:41:18.211315 [debug] [Thread-1 (]: Began executing node model.test_project.example_model
[0m19:41:18.241132 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_project.example_model"
[0m19:41:18.243132 [debug] [Thread-1 (]: Using postgres connection "model.test_project.example_model"
[0m19:41:18.244134 [debug] [Thread-1 (]: On model.test_project.example_model: BEGIN
[0m19:41:18.245134 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:41:18.316715 [debug] [Thread-1 (]: SQL status: BEGIN in 0.072 seconds
[0m19:41:18.317715 [debug] [Thread-1 (]: Using postgres connection "model.test_project.example_model"
[0m19:41:18.318715 [debug] [Thread-1 (]: On model.test_project.example_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.example_model"} */

  create view "test_db"."public"."example_model__dbt_tmp"
    
    
  as (
    -- models/example_model.sql

select 1 as id, 'dbt' as name
  );
[0m19:41:18.321226 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:41:18.328225 [debug] [Thread-1 (]: Using postgres connection "model.test_project.example_model"
[0m19:41:18.328225 [debug] [Thread-1 (]: On model.test_project.example_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.example_model"} */
alter table "test_db"."public"."example_model" rename to "example_model__dbt_backup"
[0m19:41:18.329224 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:41:18.332226 [debug] [Thread-1 (]: Using postgres connection "model.test_project.example_model"
[0m19:41:18.332226 [debug] [Thread-1 (]: On model.test_project.example_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.example_model"} */
alter table "test_db"."public"."example_model__dbt_tmp" rename to "example_model"
[0m19:41:18.333224 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:41:18.348803 [debug] [Thread-1 (]: On model.test_project.example_model: COMMIT
[0m19:41:18.348803 [debug] [Thread-1 (]: Using postgres connection "model.test_project.example_model"
[0m19:41:18.349803 [debug] [Thread-1 (]: On model.test_project.example_model: COMMIT
[0m19:41:18.351371 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:41:18.356890 [debug] [Thread-1 (]: Applying DROP to: "test_db"."public"."example_model__dbt_backup"
[0m19:41:18.361399 [debug] [Thread-1 (]: Using postgres connection "model.test_project.example_model"
[0m19:41:18.362400 [debug] [Thread-1 (]: On model.test_project.example_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.example_model"} */
drop view if exists "test_db"."public"."example_model__dbt_backup" cascade
[0m19:41:18.363403 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m19:41:18.365399 [debug] [Thread-1 (]: On model.test_project.example_model: Close
[0m19:41:18.367407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12bfe2ec-7a33-4524-8b4f-67e5209ce5eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E982FE390>]}
[0m19:41:18.368402 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.example_model .......................... [[32mCREATE VIEW[0m in 0.16s]
[0m19:41:18.369401 [debug] [Thread-1 (]: Finished running node model.test_project.example_model
[0m19:41:18.369401 [debug] [Thread-1 (]: Began running node model.test_project.my_first_dbt_model
[0m19:41:18.370403 [info ] [Thread-1 (]: 2 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m19:41:18.371400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.test_project.example_model, now model.test_project.my_first_dbt_model)
[0m19:41:18.372400 [debug] [Thread-1 (]: Began compiling node model.test_project.my_first_dbt_model
[0m19:41:18.374904 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_project.my_first_dbt_model"
[0m19:41:18.376911 [debug] [Thread-1 (]: Began executing node model.test_project.my_first_dbt_model
[0m19:41:18.395938 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_project.my_first_dbt_model"
[0m19:41:18.397934 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_first_dbt_model"
[0m19:41:18.398935 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: BEGIN
[0m19:41:18.399938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:41:18.478557 [debug] [Thread-1 (]: SQL status: BEGIN in 0.079 seconds
[0m19:41:18.480064 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_first_dbt_model"
[0m19:41:18.480064 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.my_first_dbt_model"} */

  
    

  create  table "test_db"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

where id is not null
  );
  
[0m19:41:18.484072 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m19:41:18.487073 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_first_dbt_model"
[0m19:41:18.487073 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.my_first_dbt_model"} */
alter table "test_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m19:41:18.488069 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:41:18.491069 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_first_dbt_model"
[0m19:41:18.491069 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.my_first_dbt_model"} */
alter table "test_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:41:18.493070 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:41:18.498098 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: COMMIT
[0m19:41:18.498098 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_first_dbt_model"
[0m19:41:18.499100 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: COMMIT
[0m19:41:18.504613 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m19:41:18.506614 [debug] [Thread-1 (]: Applying DROP to: "test_db"."public"."my_first_dbt_model__dbt_backup"
[0m19:41:18.509613 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_first_dbt_model"
[0m19:41:18.510612 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.my_first_dbt_model"} */
drop table if exists "test_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m19:41:18.512617 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m19:41:18.513615 [debug] [Thread-1 (]: On model.test_project.my_first_dbt_model: Close
[0m19:41:18.515121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12bfe2ec-7a33-4524-8b4f-67e5209ce5eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E9C23E6F0>]}
[0m19:41:18.516638 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 1[0m in 0.14s]
[0m19:41:18.517645 [debug] [Thread-1 (]: Finished running node model.test_project.my_first_dbt_model
[0m19:41:18.518646 [debug] [Thread-1 (]: Began running node model.test_project.my_second_dbt_model
[0m19:41:18.518646 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m19:41:18.520153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.test_project.my_first_dbt_model, now model.test_project.my_second_dbt_model)
[0m19:41:18.521158 [debug] [Thread-1 (]: Began compiling node model.test_project.my_second_dbt_model
[0m19:41:18.524201 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_project.my_second_dbt_model"
[0m19:41:18.526206 [debug] [Thread-1 (]: Began executing node model.test_project.my_second_dbt_model
[0m19:41:18.529716 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_project.my_second_dbt_model"
[0m19:41:18.531717 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_second_dbt_model"
[0m19:41:18.532716 [debug] [Thread-1 (]: On model.test_project.my_second_dbt_model: BEGIN
[0m19:41:18.532716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:41:18.706022 [debug] [Thread-1 (]: SQL status: BEGIN in 0.174 seconds
[0m19:41:18.707525 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_second_dbt_model"
[0m19:41:18.708530 [debug] [Thread-1 (]: On model.test_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.my_second_dbt_model"} */

  create view "test_db"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "test_db"."public"."my_first_dbt_model"
where id = 1
  );
[0m19:41:18.711529 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:41:18.715033 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_second_dbt_model"
[0m19:41:18.715033 [debug] [Thread-1 (]: On model.test_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.my_second_dbt_model"} */
alter table "test_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:41:18.716554 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:41:18.718559 [debug] [Thread-1 (]: On model.test_project.my_second_dbt_model: COMMIT
[0m19:41:18.718559 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_second_dbt_model"
[0m19:41:18.720120 [debug] [Thread-1 (]: On model.test_project.my_second_dbt_model: COMMIT
[0m19:41:18.720625 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:41:18.722629 [debug] [Thread-1 (]: Applying DROP to: "test_db"."public"."my_second_dbt_model__dbt_backup"
[0m19:41:18.723632 [debug] [Thread-1 (]: Using postgres connection "model.test_project.my_second_dbt_model"
[0m19:41:18.724630 [debug] [Thread-1 (]: On model.test_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.my_second_dbt_model"} */
drop view if exists "test_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m19:41:18.725630 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m19:41:18.726629 [debug] [Thread-1 (]: On model.test_project.my_second_dbt_model: Close
[0m19:41:18.727629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12bfe2ec-7a33-4524-8b4f-67e5209ce5eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E9C5E3410>]}
[0m19:41:18.728631 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.21s]
[0m19:41:18.729636 [debug] [Thread-1 (]: Finished running node model.test_project.my_second_dbt_model
[0m19:41:18.730630 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:18.731634 [debug] [MainThread]: On master: BEGIN
[0m19:41:18.731634 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:41:18.808773 [debug] [MainThread]: SQL status: BEGIN in 0.076 seconds
[0m19:41:18.809778 [debug] [MainThread]: On master: COMMIT
[0m19:41:18.809778 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:18.810777 [debug] [MainThread]: On master: COMMIT
[0m19:41:18.810777 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:41:18.811774 [debug] [MainThread]: On master: Close
[0m19:41:18.812772 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:41:18.813774 [debug] [MainThread]: Connection 'list_test_db' was properly closed.
[0m19:41:18.813774 [debug] [MainThread]: Connection 'list_test_db_public' was properly closed.
[0m19:41:18.814773 [debug] [MainThread]: Connection 'model.test_project.my_second_dbt_model' was properly closed.
[0m19:41:18.814773 [info ] [MainThread]: 
[0m19:41:18.816634 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 1.06 seconds (1.06s).
[0m19:41:18.817644 [debug] [MainThread]: Command end result
[0m19:41:18.846735 [info ] [MainThread]: 
[0m19:41:18.846735 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:41:18.847737 [info ] [MainThread]: 
[0m19:41:18.848738 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m19:41:18.850736 [debug] [MainThread]: Command `dbt run` succeeded at 19:41:18.850736 after 1.84 seconds
[0m19:41:18.851737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E99B6E420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E998CD130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026E998CC4A0>]}
[0m19:41:18.851737 [debug] [MainThread]: Flushing usage events
[0m19:41:24.195945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA8E678CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA8EEB46E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA90E13560>]}


============================== 19:41:24.200452 | 2cad94e8-2c2d-4c83-8108-08ad2004a4f4 ==============================
[0m19:41:24.200452 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:41:24.201458 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test', 'log_path': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:41:24.409423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2cad94e8-2c2d-4c83-8108-08ad2004a4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA91284230>]}
[0m19:41:24.457073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2cad94e8-2c2d-4c83-8108-08ad2004a4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA8EC16510>]}
[0m19:41:24.459074 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:41:24.468193 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m19:41:24.662161 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:41:24.662161 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:41:24.693237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cad94e8-2c2d-4c83-8108-08ad2004a4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA8B2A2720>]}
[0m19:41:24.802845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cad94e8-2c2d-4c83-8108-08ad2004a4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA9278D820>]}
[0m19:41:24.803847 [info ] [MainThread]: Found 3 models, 4 data tests, 417 macros
[0m19:41:24.804844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cad94e8-2c2d-4c83-8108-08ad2004a4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA913D8290>]}
[0m19:41:24.806850 [info ] [MainThread]: 
[0m19:41:24.807850 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:41:24.810850 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_db_public'
[0m19:41:24.986323 [debug] [ThreadPool]: Using postgres connection "list_test_db_public"
[0m19:41:24.987270 [debug] [ThreadPool]: On list_test_db_public: BEGIN
[0m19:41:24.987270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:41:25.066609 [debug] [ThreadPool]: SQL status: BEGIN in 0.079 seconds
[0m19:41:25.067609 [debug] [ThreadPool]: Using postgres connection "list_test_db_public"
[0m19:41:25.067609 [debug] [ThreadPool]: On list_test_db_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "list_test_db_public"} */
select
      'test_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'test_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:41:25.072908 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m19:41:25.074907 [debug] [ThreadPool]: On list_test_db_public: ROLLBACK
[0m19:41:25.075411 [debug] [ThreadPool]: On list_test_db_public: Close
[0m19:41:25.079920 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:25.080925 [debug] [MainThread]: On master: BEGIN
[0m19:41:25.081926 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:41:25.153894 [debug] [MainThread]: SQL status: BEGIN in 0.073 seconds
[0m19:41:25.154894 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:25.154894 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:41:25.161311 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m19:41:25.163312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cad94e8-2c2d-4c83-8108-08ad2004a4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA913F6CC0>]}
[0m19:41:25.164312 [debug] [MainThread]: On master: ROLLBACK
[0m19:41:25.164312 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:25.165311 [debug] [MainThread]: On master: BEGIN
[0m19:41:25.166373 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:41:25.166373 [debug] [MainThread]: On master: COMMIT
[0m19:41:25.167310 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:25.168311 [debug] [MainThread]: On master: COMMIT
[0m19:41:25.168311 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:41:25.169311 [debug] [MainThread]: On master: Close
[0m19:41:25.170312 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:41:25.171312 [info ] [MainThread]: 
[0m19:41:25.175310 [debug] [Thread-1 (]: Began running node test.test_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:41:25.176575 [info ] [Thread-1 (]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m19:41:25.177575 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.test_project.not_null_my_first_dbt_model_id.5fb22c2710'
[0m19:41:25.178575 [debug] [Thread-1 (]: Began compiling node test.test_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:41:25.193088 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:41:25.196318 [debug] [Thread-1 (]: Began executing node test.test_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:41:25.210582 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:41:25.212582 [debug] [Thread-1 (]: Using postgres connection "test.test_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:41:25.213581 [debug] [Thread-1 (]: On test.test_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m19:41:25.213581 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:41:25.287330 [debug] [Thread-1 (]: SQL status: BEGIN in 0.074 seconds
[0m19:41:25.288330 [debug] [Thread-1 (]: Using postgres connection "test.test_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:41:25.289329 [debug] [Thread-1 (]: On test.test_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "test.test_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "test_db"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m19:41:25.290331 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:41:25.294329 [debug] [Thread-1 (]: On test.test_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m19:41:25.295332 [debug] [Thread-1 (]: On test.test_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m19:41:25.295332 [info ] [Thread-1 (]: 1 of 4 PASS not_null_my_first_dbt_model_id ..................................... [[32mPASS[0m in 0.12s]
[0m19:41:25.297394 [debug] [Thread-1 (]: Finished running node test.test_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:41:25.297394 [debug] [Thread-1 (]: Began running node test.test_project.not_null_my_second_dbt_model_id.151b76d778
[0m19:41:25.298393 [info ] [Thread-1 (]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m19:41:25.298393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_project.not_null_my_first_dbt_model_id.5fb22c2710, now test.test_project.not_null_my_second_dbt_model_id.151b76d778)
[0m19:41:25.299898 [debug] [Thread-1 (]: Began compiling node test.test_project.not_null_my_second_dbt_model_id.151b76d778
[0m19:41:25.303410 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_project.not_null_my_second_dbt_model_id.151b76d778"
[0m19:41:25.305416 [debug] [Thread-1 (]: Began executing node test.test_project.not_null_my_second_dbt_model_id.151b76d778
[0m19:41:25.307922 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_project.not_null_my_second_dbt_model_id.151b76d778"
[0m19:41:25.309927 [debug] [Thread-1 (]: Using postgres connection "test.test_project.not_null_my_second_dbt_model_id.151b76d778"
[0m19:41:25.310929 [debug] [Thread-1 (]: On test.test_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m19:41:25.311928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:41:25.385017 [debug] [Thread-1 (]: SQL status: BEGIN in 0.074 seconds
[0m19:41:25.386079 [debug] [Thread-1 (]: Using postgres connection "test.test_project.not_null_my_second_dbt_model_id.151b76d778"
[0m19:41:25.387018 [debug] [Thread-1 (]: On test.test_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "test.test_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "test_db"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m19:41:25.389019 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:41:25.390018 [debug] [Thread-1 (]: On test.test_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m19:41:25.391019 [debug] [Thread-1 (]: On test.test_project.not_null_my_second_dbt_model_id.151b76d778: Close
[0m19:41:25.392019 [info ] [Thread-1 (]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.09s]
[0m19:41:25.393018 [debug] [Thread-1 (]: Finished running node test.test_project.not_null_my_second_dbt_model_id.151b76d778
[0m19:41:25.394018 [debug] [Thread-1 (]: Began running node test.test_project.unique_my_first_dbt_model_id.16e066b321
[0m19:41:25.395020 [info ] [Thread-1 (]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m19:41:25.395020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_project.not_null_my_second_dbt_model_id.151b76d778, now test.test_project.unique_my_first_dbt_model_id.16e066b321)
[0m19:41:25.396460 [debug] [Thread-1 (]: Began compiling node test.test_project.unique_my_first_dbt_model_id.16e066b321
[0m19:41:25.401976 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_project.unique_my_first_dbt_model_id.16e066b321"
[0m19:41:25.403975 [debug] [Thread-1 (]: Began executing node test.test_project.unique_my_first_dbt_model_id.16e066b321
[0m19:41:25.406059 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_project.unique_my_first_dbt_model_id.16e066b321"
[0m19:41:25.407979 [debug] [Thread-1 (]: Using postgres connection "test.test_project.unique_my_first_dbt_model_id.16e066b321"
[0m19:41:25.408977 [debug] [Thread-1 (]: On test.test_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m19:41:25.409976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:41:25.483923 [debug] [Thread-1 (]: SQL status: BEGIN in 0.074 seconds
[0m19:41:25.484923 [debug] [Thread-1 (]: Using postgres connection "test.test_project.unique_my_first_dbt_model_id.16e066b321"
[0m19:41:25.484923 [debug] [Thread-1 (]: On test.test_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "test.test_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "test_db"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:41:25.486925 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:41:25.488991 [debug] [Thread-1 (]: On test.test_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m19:41:25.489990 [debug] [Thread-1 (]: On test.test_project.unique_my_first_dbt_model_id.16e066b321: Close
[0m19:41:25.489990 [info ] [Thread-1 (]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.09s]
[0m19:41:25.491988 [debug] [Thread-1 (]: Finished running node test.test_project.unique_my_first_dbt_model_id.16e066b321
[0m19:41:25.491988 [debug] [Thread-1 (]: Began running node test.test_project.unique_my_second_dbt_model_id.57a0f8c493
[0m19:41:25.492990 [info ] [Thread-1 (]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m19:41:25.493989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_project.unique_my_first_dbt_model_id.16e066b321, now test.test_project.unique_my_second_dbt_model_id.57a0f8c493)
[0m19:41:25.494990 [debug] [Thread-1 (]: Began compiling node test.test_project.unique_my_second_dbt_model_id.57a0f8c493
[0m19:41:25.498500 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:41:25.500005 [debug] [Thread-1 (]: Began executing node test.test_project.unique_my_second_dbt_model_id.57a0f8c493
[0m19:41:25.502011 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:41:25.505014 [debug] [Thread-1 (]: Using postgres connection "test.test_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:41:25.505014 [debug] [Thread-1 (]: On test.test_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m19:41:25.506074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:41:25.579145 [debug] [Thread-1 (]: SQL status: BEGIN in 0.073 seconds
[0m19:41:25.580145 [debug] [Thread-1 (]: Using postgres connection "test.test_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:41:25.580651 [debug] [Thread-1 (]: On test.test_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "test.test_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "test_db"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:41:25.582659 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:41:25.584658 [debug] [Thread-1 (]: On test.test_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m19:41:25.585658 [debug] [Thread-1 (]: On test.test_project.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m19:41:25.585714 [info ] [Thread-1 (]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.09s]
[0m19:41:25.587657 [debug] [Thread-1 (]: Finished running node test.test_project.unique_my_second_dbt_model_id.57a0f8c493
[0m19:41:25.588657 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:25.589657 [debug] [MainThread]: On master: BEGIN
[0m19:41:25.589657 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:41:25.664358 [debug] [MainThread]: SQL status: BEGIN in 0.075 seconds
[0m19:41:25.665357 [debug] [MainThread]: On master: COMMIT
[0m19:41:25.665357 [debug] [MainThread]: Using postgres connection "master"
[0m19:41:25.666938 [debug] [MainThread]: On master: COMMIT
[0m19:41:25.667871 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:41:25.667871 [debug] [MainThread]: On master: Close
[0m19:41:25.668872 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:41:25.669871 [debug] [MainThread]: Connection 'list_test_db_public' was properly closed.
[0m19:41:25.669871 [debug] [MainThread]: Connection 'test.test_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m19:41:25.670870 [info ] [MainThread]: 
[0m19:41:25.671871 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m19:41:25.672871 [debug] [MainThread]: Command end result
[0m19:41:25.703532 [info ] [MainThread]: 
[0m19:41:25.704534 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:41:25.705615 [info ] [MainThread]: 
[0m19:41:25.706532 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:41:25.707533 [debug] [MainThread]: Command `dbt test` succeeded at 19:41:25.707533 after 1.66 seconds
[0m19:41:25.708532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA90463B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA915FBDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA910063C0>]}
[0m19:41:25.709536 [debug] [MainThread]: Flushing usage events
[0m21:06:41.608896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A876A5E0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A875E9CBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A876A5E000>]}


============================== 21:06:41.614779 | 57567f29-f1bd-4811-8349-3b8a6b0ab5a5 ==============================
[0m21:06:41.614779 [info ] [MainThread]: Running with dbt=1.8.6
[0m21:06:41.615779 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test\\logs', 'profiles_dir': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:06:41.856494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57567f29-f1bd-4811-8349-3b8a6b0ab5a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A870CD0DA0>]}
[0m21:06:41.903111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57567f29-f1bd-4811-8349-3b8a6b0ab5a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A87463F500>]}
[0m21:06:41.904111 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:06:41.914340 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m21:06:42.125286 [debug] [MainThread]: Partial parsing enabled: 4 files deleted, 3 files added, 0 files changed.
[0m21:06:42.126373 [debug] [MainThread]: Partial parsing: added file: test_project://test_project/models\sales\schema.yml
[0m21:06:42.126878 [debug] [MainThread]: Partial parsing: added file: test_project://test_project/models\sales\sales_summary_by_customer.sql
[0m21:06:42.127933 [debug] [MainThread]: Partial parsing: added file: test_project://test_project/models\sales\sales_summary_by_date.sql
[0m21:06:42.128459 [debug] [MainThread]: Partial parsing: deleted file: test_project://test_project/models\example\my_first_dbt_model.sql
[0m21:06:42.129501 [debug] [MainThread]: Partial parsing: deleted file: test_project://test_project/models\example\my_second_dbt_model.sql
[0m21:06:42.130019 [debug] [MainThread]: Partial parsing: deleted file: test_project://test_project/models\example_model.sql
[0m21:06:42.326434 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:06:42.327480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '57567f29-f1bd-4811-8349-3b8a6b0ab5a5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A875C71280>]}
[0m21:06:42.466602 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.test_project.example
[0m21:06:42.471600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57567f29-f1bd-4811-8349-3b8a6b0ab5a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A878199F10>]}
[0m21:06:42.580076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57567f29-f1bd-4811-8349-3b8a6b0ab5a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A876EFA600>]}
[0m21:06:42.581076 [info ] [MainThread]: Found 2 models, 3 data tests, 417 macros
[0m21:06:42.582076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57567f29-f1bd-4811-8349-3b8a6b0ab5a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A877081340>]}
[0m21:06:42.584076 [info ] [MainThread]: 
[0m21:06:42.585581 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:06:42.588594 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_db'
[0m21:06:42.840701 [debug] [ThreadPool]: Using postgres connection "list_test_db"
[0m21:06:42.841700 [debug] [ThreadPool]: On list_test_db: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "list_test_db"} */

    select distinct nspname from pg_namespace
  
[0m21:06:42.841700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:06:42.933420 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.091 seconds
[0m21:06:42.935422 [debug] [ThreadPool]: On list_test_db: Close
[0m21:06:42.936935 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_db_public'
[0m21:06:42.942932 [debug] [ThreadPool]: Using postgres connection "list_test_db_public"
[0m21:06:42.943933 [debug] [ThreadPool]: On list_test_db_public: BEGIN
[0m21:06:42.943933 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:06:43.020227 [debug] [ThreadPool]: SQL status: BEGIN in 0.076 seconds
[0m21:06:43.021227 [debug] [ThreadPool]: Using postgres connection "list_test_db_public"
[0m21:06:43.021227 [debug] [ThreadPool]: On list_test_db_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "list_test_db_public"} */
select
      'test_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'test_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:06:43.029203 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.007 seconds
[0m21:06:43.031202 [debug] [ThreadPool]: On list_test_db_public: ROLLBACK
[0m21:06:43.032204 [debug] [ThreadPool]: On list_test_db_public: Close
[0m21:06:43.036711 [debug] [MainThread]: Using postgres connection "master"
[0m21:06:43.037711 [debug] [MainThread]: On master: BEGIN
[0m21:06:43.038714 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:06:43.223236 [debug] [MainThread]: SQL status: BEGIN in 0.185 seconds
[0m21:06:43.224239 [debug] [MainThread]: Using postgres connection "master"
[0m21:06:43.225237 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:06:43.232753 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m21:06:43.235255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57567f29-f1bd-4811-8349-3b8a6b0ab5a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A87828BA70>]}
[0m21:06:43.235255 [debug] [MainThread]: On master: ROLLBACK
[0m21:06:43.236262 [debug] [MainThread]: Using postgres connection "master"
[0m21:06:43.237262 [debug] [MainThread]: On master: BEGIN
[0m21:06:43.238263 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:06:43.238263 [debug] [MainThread]: On master: COMMIT
[0m21:06:43.239262 [debug] [MainThread]: Using postgres connection "master"
[0m21:06:43.239262 [debug] [MainThread]: On master: COMMIT
[0m21:06:43.240262 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:06:43.241264 [debug] [MainThread]: On master: Close
[0m21:06:43.241264 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:06:43.242263 [info ] [MainThread]: 
[0m21:06:43.246772 [debug] [Thread-1 (]: Began running node model.test_project.sales_summary_by_customer
[0m21:06:43.247772 [info ] [Thread-1 (]: 1 of 2 START sql view model public.sales_summary_by_customer ................... [RUN]
[0m21:06:43.248772 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.test_project.sales_summary_by_customer'
[0m21:06:43.249774 [debug] [Thread-1 (]: Began compiling node model.test_project.sales_summary_by_customer
[0m21:06:43.255275 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_project.sales_summary_by_customer"
[0m21:06:43.258793 [debug] [Thread-1 (]: Began executing node model.test_project.sales_summary_by_customer
[0m21:06:43.291337 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_project.sales_summary_by_customer"
[0m21:06:43.295334 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_customer"
[0m21:06:43.295839 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_customer: BEGIN
[0m21:06:43.296845 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:06:43.373700 [debug] [Thread-1 (]: SQL status: BEGIN in 0.077 seconds
[0m21:06:43.375207 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_customer"
[0m21:06:43.375207 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.sales_summary_by_customer"} */

  create view "test_db"."public"."sales_summary_by_customer__dbt_tmp"
    
    
  as (
    CREATE OR REPLACE VIEW sales_summary_by_customer AS
SELECT
    c.c_custkey AS customer_id,
    c.c_name AS customer_name,
    SUM(l.l_extendedprice) AS total_sales,
    SUM(l.l_discount) AS total_discount,
    SUM(l.l_quantity) AS total_quantity_purchased
FROM
    lineitem l
JOIN
    orders o ON l.l_orderkey = o.o_orderkey
JOIN
    customer c ON o.o_custkey = c.c_custkey
GROUP BY
    c.c_custkey, c.c_name
ORDER BY
    total_sales DESC;
  );
[0m21:06:43.377213 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "CREATE"
LINE 7:     CREATE OR REPLACE VIEW sales_summary_by_customer AS
            ^

[0m21:06:43.377213 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_customer: ROLLBACK
[0m21:06:43.378218 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_customer: Close
[0m21:06:43.388733 [debug] [Thread-1 (]: Database Error in model sales_summary_by_customer (test_project/models\sales\sales_summary_by_customer.sql)
  syntax error at or near "CREATE"
  LINE 7:     CREATE OR REPLACE VIEW sales_summary_by_customer AS
              ^
  compiled Code at target\run\test_project\test_project/models\sales\sales_summary_by_customer.sql
[0m21:06:43.390732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57567f29-f1bd-4811-8349-3b8a6b0ab5a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A87819A600>]}
[0m21:06:43.391733 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public.sales_summary_by_customer .......... [[31mERROR[0m in 0.14s]
[0m21:06:43.392736 [debug] [Thread-1 (]: Finished running node model.test_project.sales_summary_by_customer
[0m21:06:43.392736 [debug] [Thread-1 (]: Began running node model.test_project.sales_summary_by_date
[0m21:06:43.393733 [info ] [Thread-1 (]: 2 of 2 START sql view model public.sales_summary_by_date ....................... [RUN]
[0m21:06:43.395238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.test_project.sales_summary_by_customer, now model.test_project.sales_summary_by_date)
[0m21:06:43.395238 [debug] [Thread-1 (]: Began compiling node model.test_project.sales_summary_by_date
[0m21:06:43.397246 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_project.sales_summary_by_date"
[0m21:06:43.400245 [debug] [Thread-1 (]: Began executing node model.test_project.sales_summary_by_date
[0m21:06:43.404243 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_project.sales_summary_by_date"
[0m21:06:43.407752 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_date"
[0m21:06:43.407752 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_date: BEGIN
[0m21:06:43.408757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:06:43.487642 [debug] [Thread-1 (]: SQL status: BEGIN in 0.078 seconds
[0m21:06:43.487642 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_date"
[0m21:06:43.488640 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_date: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.sales_summary_by_date"} */

  create view "test_db"."public"."sales_summary_by_date__dbt_tmp"
    
    
  as (
    CREATE OR REPLACE VIEW sales_summary_by_date AS
SELECT
    o.o_orderdate AS order_date,
    SUM(l.l_extendedprice) AS total_sales,
    SUM(l.l_discount) AS total_discount,
    SUM(l.l_quantity) AS total_quantity_sold
FROM
    lineitem l
JOIN
    orders o ON l.l_orderkey = o.o_orderkey
GROUP BY
    o.o_orderdate
ORDER BY
    o.o_orderdate;
  );
[0m21:06:43.489642 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "CREATE"
LINE 7:     CREATE OR REPLACE VIEW sales_summary_by_date AS
            ^

[0m21:06:43.490640 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_date: ROLLBACK
[0m21:06:43.491641 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_date: Close
[0m21:06:43.495640 [debug] [Thread-1 (]: Database Error in model sales_summary_by_date (test_project/models\sales\sales_summary_by_date.sql)
  syntax error at or near "CREATE"
  LINE 7:     CREATE OR REPLACE VIEW sales_summary_by_date AS
              ^
  compiled Code at target\run\test_project\test_project/models\sales\sales_summary_by_date.sql
[0m21:06:43.496697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57567f29-f1bd-4811-8349-3b8a6b0ab5a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A878746F00>]}
[0m21:06:43.496697 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model public.sales_summary_by_date .............. [[31mERROR[0m in 0.10s]
[0m21:06:43.497695 [debug] [Thread-1 (]: Finished running node model.test_project.sales_summary_by_date
[0m21:06:43.499693 [debug] [MainThread]: Using postgres connection "master"
[0m21:06:43.499693 [debug] [MainThread]: On master: BEGIN
[0m21:06:43.500694 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:06:43.576458 [debug] [MainThread]: SQL status: BEGIN in 0.075 seconds
[0m21:06:43.577456 [debug] [MainThread]: On master: COMMIT
[0m21:06:43.577456 [debug] [MainThread]: Using postgres connection "master"
[0m21:06:43.578457 [debug] [MainThread]: On master: COMMIT
[0m21:06:43.579456 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:06:43.579456 [debug] [MainThread]: On master: Close
[0m21:06:43.580456 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:06:43.581457 [debug] [MainThread]: Connection 'list_test_db' was properly closed.
[0m21:06:43.582456 [debug] [MainThread]: Connection 'list_test_db_public' was properly closed.
[0m21:06:43.582456 [debug] [MainThread]: Connection 'model.test_project.sales_summary_by_date' was properly closed.
[0m21:06:43.583456 [info ] [MainThread]: 
[0m21:06:43.584457 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.00 seconds (1.00s).
[0m21:06:43.585457 [debug] [MainThread]: Command end result
[0m21:06:43.614063 [info ] [MainThread]: 
[0m21:06:43.615568 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m21:06:43.615568 [info ] [MainThread]: 
[0m21:06:43.616575 [error] [MainThread]:   Database Error in model sales_summary_by_customer (test_project/models\sales\sales_summary_by_customer.sql)
  syntax error at or near "CREATE"
  LINE 7:     CREATE OR REPLACE VIEW sales_summary_by_customer AS
              ^
  compiled Code at target\run\test_project\test_project/models\sales\sales_summary_by_customer.sql
[0m21:06:43.617575 [info ] [MainThread]: 
[0m21:06:43.617575 [error] [MainThread]:   Database Error in model sales_summary_by_date (test_project/models\sales\sales_summary_by_date.sql)
  syntax error at or near "CREATE"
  LINE 7:     CREATE OR REPLACE VIEW sales_summary_by_date AS
              ^
  compiled Code at target\run\test_project\test_project/models\sales\sales_summary_by_date.sql
[0m21:06:43.618581 [info ] [MainThread]: 
[0m21:06:43.619581 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m21:06:43.621726 [debug] [MainThread]: Command `dbt run` failed at 21:06:43.621726 after 2.19 seconds
[0m21:06:43.622233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8781164E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A87820F050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8781020C0>]}
[0m21:06:43.623240 [debug] [MainThread]: Flushing usage events
[0m21:08:42.930470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C0326C8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C05BD8E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C05BD9640>]}


============================== 21:08:42.934471 | 32828cef-cf11-4b46-97a5-fca4868fe95b ==============================
[0m21:08:42.934471 [info ] [MainThread]: Running with dbt=1.8.6
[0m21:08:42.935470 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:08:43.146582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32828cef-cf11-4b46-97a5-fca4868fe95b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C05CF67E0>]}
[0m21:08:43.192618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32828cef-cf11-4b46-97a5-fca4868fe95b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C05DCFFB0>]}
[0m21:08:43.195178 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:08:43.202648 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m21:08:43.383923 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m21:08:43.383923 [debug] [MainThread]: Partial parsing: updated file: test_project://test_project/models\sales\sales_summary_by_date.sql
[0m21:08:43.385430 [debug] [MainThread]: Partial parsing: updated file: test_project://test_project/models\sales\sales_summary_by_customer.sql
[0m21:08:43.575549 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:08:43.576555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '32828cef-cf11-4b46-97a5-fca4868fe95b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C05D170B0>]}
[0m21:08:43.705311 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.test_project.example
[0m21:08:43.711321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32828cef-cf11-4b46-97a5-fca4868fe95b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C0718DFA0>]}
[0m21:08:43.803032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32828cef-cf11-4b46-97a5-fca4868fe95b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C072E9550>]}
[0m21:08:43.804043 [info ] [MainThread]: Found 2 models, 3 data tests, 417 macros
[0m21:08:43.804043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32828cef-cf11-4b46-97a5-fca4868fe95b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C073D6810>]}
[0m21:08:43.807564 [info ] [MainThread]: 
[0m21:08:43.808566 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:08:43.811561 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_db'
[0m21:08:43.993453 [debug] [ThreadPool]: Using postgres connection "list_test_db"
[0m21:08:43.994456 [debug] [ThreadPool]: On list_test_db: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "list_test_db"} */

    select distinct nspname from pg_namespace
  
[0m21:08:43.994456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:08:44.074659 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.080 seconds
[0m21:08:44.077170 [debug] [ThreadPool]: On list_test_db: Close
[0m21:08:44.078172 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_db_public'
[0m21:08:44.085677 [debug] [ThreadPool]: Using postgres connection "list_test_db_public"
[0m21:08:44.085677 [debug] [ThreadPool]: On list_test_db_public: BEGIN
[0m21:08:44.086685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:08:44.162067 [debug] [ThreadPool]: SQL status: BEGIN in 0.075 seconds
[0m21:08:44.163068 [debug] [ThreadPool]: Using postgres connection "list_test_db_public"
[0m21:08:44.163068 [debug] [ThreadPool]: On list_test_db_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "list_test_db_public"} */
select
      'test_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'test_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:08:44.168578 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m21:08:44.169581 [debug] [ThreadPool]: On list_test_db_public: ROLLBACK
[0m21:08:44.170581 [debug] [ThreadPool]: On list_test_db_public: Close
[0m21:08:44.175580 [debug] [MainThread]: Using postgres connection "master"
[0m21:08:44.176086 [debug] [MainThread]: On master: BEGIN
[0m21:08:44.177093 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:08:44.253387 [debug] [MainThread]: SQL status: BEGIN in 0.077 seconds
[0m21:08:44.254387 [debug] [MainThread]: Using postgres connection "master"
[0m21:08:44.255387 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:08:44.261802 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m21:08:44.262802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32828cef-cf11-4b46-97a5-fca4868fe95b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C037E6570>]}
[0m21:08:44.263805 [debug] [MainThread]: On master: ROLLBACK
[0m21:08:44.263805 [debug] [MainThread]: Using postgres connection "master"
[0m21:08:44.265311 [debug] [MainThread]: On master: BEGIN
[0m21:08:44.266319 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:08:44.266319 [debug] [MainThread]: On master: COMMIT
[0m21:08:44.267320 [debug] [MainThread]: Using postgres connection "master"
[0m21:08:44.268320 [debug] [MainThread]: On master: COMMIT
[0m21:08:44.269318 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:08:44.269318 [debug] [MainThread]: On master: Close
[0m21:08:44.270317 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:08:44.271317 [info ] [MainThread]: 
[0m21:08:44.275318 [debug] [Thread-1 (]: Began running node model.test_project.sales_summary_by_customer
[0m21:08:44.275318 [info ] [Thread-1 (]: 1 of 2 START sql view model public.sales_summary_by_customer ................... [RUN]
[0m21:08:44.276375 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.test_project.sales_summary_by_customer'
[0m21:08:44.277377 [debug] [Thread-1 (]: Began compiling node model.test_project.sales_summary_by_customer
[0m21:08:44.283375 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_project.sales_summary_by_customer"
[0m21:08:44.285376 [debug] [Thread-1 (]: Began executing node model.test_project.sales_summary_by_customer
[0m21:08:44.318888 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_project.sales_summary_by_customer"
[0m21:08:44.320986 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_customer"
[0m21:08:44.321504 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_customer: BEGIN
[0m21:08:44.322553 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:08:44.402994 [debug] [Thread-1 (]: SQL status: BEGIN in 0.081 seconds
[0m21:08:44.403993 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_customer"
[0m21:08:44.403993 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.sales_summary_by_customer"} */

  create view "test_db"."public"."sales_summary_by_customer__dbt_tmp"
    
    
  as (
    -- models/sales/sales_summary_by_customer.sql

SELECT
    c.c_custkey AS customer_id,
    c.c_name AS customer_name,
    SUM(l.l_extendedprice) AS total_sales,
    SUM(l.l_discount) AS total_discount,
    SUM(l.l_quantity) AS total_quantity_purchased
FROM
    lineitem l
JOIN
    orders o ON l.l_orderkey = o.o_orderkey
JOIN
    customer c ON o.o_custkey = c.c_custkey
GROUP BY
    c.c_custkey, c.c_name
ORDER BY
    total_sales DESC;
  );
[0m21:08:44.405499 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 24:     total_sales DESC;
                             ^

[0m21:08:44.406506 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_customer: ROLLBACK
[0m21:08:44.407507 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_customer: Close
[0m21:08:44.414103 [debug] [Thread-1 (]: Database Error in model sales_summary_by_customer (test_project/models\sales\sales_summary_by_customer.sql)
  syntax error at or near ";"
  LINE 24:     total_sales DESC;
                               ^
  compiled Code at target\run\test_project\test_project/models\sales\sales_summary_by_customer.sql
[0m21:08:44.416616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32828cef-cf11-4b46-97a5-fca4868fe95b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C072EB440>]}
[0m21:08:44.416616 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model public.sales_summary_by_customer .......... [[31mERROR[0m in 0.14s]
[0m21:08:44.418615 [debug] [Thread-1 (]: Finished running node model.test_project.sales_summary_by_customer
[0m21:08:44.419120 [debug] [Thread-1 (]: Began running node model.test_project.sales_summary_by_date
[0m21:08:44.420126 [info ] [Thread-1 (]: 2 of 2 START sql view model public.sales_summary_by_date ....................... [RUN]
[0m21:08:44.421127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.test_project.sales_summary_by_customer, now model.test_project.sales_summary_by_date)
[0m21:08:44.422128 [debug] [Thread-1 (]: Began compiling node model.test_project.sales_summary_by_date
[0m21:08:44.424127 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_project.sales_summary_by_date"
[0m21:08:44.426638 [debug] [Thread-1 (]: Began executing node model.test_project.sales_summary_by_date
[0m21:08:44.429638 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_project.sales_summary_by_date"
[0m21:08:44.431638 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_date"
[0m21:08:44.432638 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_date: BEGIN
[0m21:08:44.433638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:08:44.512345 [debug] [Thread-1 (]: SQL status: BEGIN in 0.079 seconds
[0m21:08:44.513347 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_date"
[0m21:08:44.514346 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_date: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.sales_summary_by_date"} */

  create view "test_db"."public"."sales_summary_by_date__dbt_tmp"
    
    
  as (
    -- models/sales/sales_summary_by_date.sql

SELECT
    o.o_orderdate AS order_date,
    SUM(l.l_extendedprice) AS total_sales,
    SUM(l.l_discount) AS total_discount,
    SUM(l.l_quantity) AS total_quantity_sold
FROM
    lineitem l
JOIN
    orders o ON l.l_orderkey = o.o_orderkey
GROUP BY
    o.o_orderdate
ORDER BY
    o.o_orderdate;
  );
[0m21:08:44.515345 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 21:     o.o_orderdate;
                          ^

[0m21:08:44.515345 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_date: ROLLBACK
[0m21:08:44.516474 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_date: Close
[0m21:08:44.519983 [debug] [Thread-1 (]: Database Error in model sales_summary_by_date (test_project/models\sales\sales_summary_by_date.sql)
  syntax error at or near ";"
  LINE 21:     o.o_orderdate;
                            ^
  compiled Code at target\run\test_project\test_project/models\sales\sales_summary_by_date.sql
[0m21:08:44.520984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32828cef-cf11-4b46-97a5-fca4868fe95b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C07893EC0>]}
[0m21:08:44.521983 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model public.sales_summary_by_date .............. [[31mERROR[0m in 0.10s]
[0m21:08:44.522983 [debug] [Thread-1 (]: Finished running node model.test_project.sales_summary_by_date
[0m21:08:44.523984 [debug] [MainThread]: Using postgres connection "master"
[0m21:08:44.525492 [debug] [MainThread]: On master: BEGIN
[0m21:08:44.525492 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:08:44.608295 [debug] [MainThread]: SQL status: BEGIN in 0.082 seconds
[0m21:08:44.609022 [debug] [MainThread]: On master: COMMIT
[0m21:08:44.609834 [debug] [MainThread]: Using postgres connection "master"
[0m21:08:44.609834 [debug] [MainThread]: On master: COMMIT
[0m21:08:44.611401 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:08:44.611401 [debug] [MainThread]: On master: Close
[0m21:08:44.612912 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:08:44.612912 [debug] [MainThread]: Connection 'list_test_db' was properly closed.
[0m21:08:44.613917 [debug] [MainThread]: Connection 'list_test_db_public' was properly closed.
[0m21:08:44.613917 [debug] [MainThread]: Connection 'model.test_project.sales_summary_by_date' was properly closed.
[0m21:08:44.615421 [info ] [MainThread]: 
[0m21:08:44.616426 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m21:08:44.617426 [debug] [MainThread]: Command end result
[0m21:08:44.648491 [info ] [MainThread]: 
[0m21:08:44.649490 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m21:08:44.650490 [info ] [MainThread]: 
[0m21:08:44.651492 [error] [MainThread]:   Database Error in model sales_summary_by_customer (test_project/models\sales\sales_summary_by_customer.sql)
  syntax error at or near ";"
  LINE 24:     total_sales DESC;
                               ^
  compiled Code at target\run\test_project\test_project/models\sales\sales_summary_by_customer.sql
[0m21:08:44.652490 [info ] [MainThread]: 
[0m21:08:44.653491 [error] [MainThread]:   Database Error in model sales_summary_by_date (test_project/models\sales\sales_summary_by_date.sql)
  syntax error at or near ";"
  LINE 21:     o.o_orderdate;
                            ^
  compiled Code at target\run\test_project\test_project/models\sales\sales_summary_by_date.sql
[0m21:08:44.654490 [info ] [MainThread]: 
[0m21:08:44.654490 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m21:08:44.656560 [debug] [MainThread]: Command `dbt run` failed at 21:08:44.656560 after 1.88 seconds
[0m21:08:44.657561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C05B96180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C04D3C860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C05F9BBF0>]}
[0m21:08:44.658561 [debug] [MainThread]: Flushing usage events
[0m21:11:24.481343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF1C0382F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF1BBA1970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF19606600>]}


============================== 21:11:24.486029 | 583c3966-a174-4076-a388-a471121c112f ==============================
[0m21:11:24.486029 [info ] [MainThread]: Running with dbt=1.8.6
[0m21:11:24.487069 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:11:24.706357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '583c3966-a174-4076-a388-a471121c112f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF1C543020>]}
[0m21:11:24.755161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '583c3966-a174-4076-a388-a471121c112f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF1B9D20C0>]}
[0m21:11:24.756680 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:11:24.766190 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m21:11:24.949897 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m21:11:24.950897 [debug] [MainThread]: Partial parsing: updated file: test_project://test_project/models\sales\sales_summary_by_customer.sql
[0m21:11:24.951893 [debug] [MainThread]: Partial parsing: updated file: test_project://test_project/models\sales\sales_summary_by_date.sql
[0m21:11:25.162345 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:11:25.163342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '583c3966-a174-4076-a388-a471121c112f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF1A1497F0>]}
[0m21:11:25.298372 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.test_project.example
[0m21:11:25.303371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '583c3966-a174-4076-a388-a471121c112f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF1DB89070>]}
[0m21:11:25.402687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '583c3966-a174-4076-a388-a471121c112f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF1C8EA660>]}
[0m21:11:25.403686 [info ] [MainThread]: Found 2 models, 3 data tests, 417 macros
[0m21:11:25.403686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '583c3966-a174-4076-a388-a471121c112f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF1DA09D30>]}
[0m21:11:25.406772 [info ] [MainThread]: 
[0m21:11:25.407778 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:11:25.411830 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_db'
[0m21:11:25.597997 [debug] [ThreadPool]: Using postgres connection "list_test_db"
[0m21:11:25.597997 [debug] [ThreadPool]: On list_test_db: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "list_test_db"} */

    select distinct nspname from pg_namespace
  
[0m21:11:25.598996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:11:25.682715 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.084 seconds
[0m21:11:25.683714 [debug] [ThreadPool]: On list_test_db: Close
[0m21:11:25.686227 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_db_public'
[0m21:11:25.693227 [debug] [ThreadPool]: Using postgres connection "list_test_db_public"
[0m21:11:25.694227 [debug] [ThreadPool]: On list_test_db_public: BEGIN
[0m21:11:25.694227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:11:25.884616 [debug] [ThreadPool]: SQL status: BEGIN in 0.190 seconds
[0m21:11:25.885616 [debug] [ThreadPool]: Using postgres connection "list_test_db_public"
[0m21:11:25.886123 [debug] [ThreadPool]: On list_test_db_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "list_test_db_public"} */
select
      'test_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'test_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:11:25.891136 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.004 seconds
[0m21:11:25.893136 [debug] [ThreadPool]: On list_test_db_public: ROLLBACK
[0m21:11:25.894136 [debug] [ThreadPool]: On list_test_db_public: Close
[0m21:11:25.899258 [debug] [MainThread]: Using postgres connection "master"
[0m21:11:25.899258 [debug] [MainThread]: On master: BEGIN
[0m21:11:25.900257 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:11:25.976618 [debug] [MainThread]: SQL status: BEGIN in 0.077 seconds
[0m21:11:25.977618 [debug] [MainThread]: Using postgres connection "master"
[0m21:11:25.978617 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:11:25.985367 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m21:11:25.986953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '583c3966-a174-4076-a388-a471121c112f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF1C5E3E30>]}
[0m21:11:25.987982 [debug] [MainThread]: On master: ROLLBACK
[0m21:11:25.989018 [debug] [MainThread]: Using postgres connection "master"
[0m21:11:25.989546 [debug] [MainThread]: On master: BEGIN
[0m21:11:25.990606 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:11:25.991123 [debug] [MainThread]: On master: COMMIT
[0m21:11:25.991646 [debug] [MainThread]: Using postgres connection "master"
[0m21:11:25.992163 [debug] [MainThread]: On master: COMMIT
[0m21:11:25.993216 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:11:25.993739 [debug] [MainThread]: On master: Close
[0m21:11:25.994261 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:11:25.995300 [info ] [MainThread]: 
[0m21:11:25.998828 [debug] [Thread-1 (]: Began running node model.test_project.sales_summary_by_customer
[0m21:11:25.999825 [info ] [Thread-1 (]: 1 of 2 START sql view model public.sales_summary_by_customer ................... [RUN]
[0m21:11:26.000825 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.test_project.sales_summary_by_customer'
[0m21:11:26.001825 [debug] [Thread-1 (]: Began compiling node model.test_project.sales_summary_by_customer
[0m21:11:26.008340 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_project.sales_summary_by_customer"
[0m21:11:26.010359 [debug] [Thread-1 (]: Began executing node model.test_project.sales_summary_by_customer
[0m21:11:26.041472 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_project.sales_summary_by_customer"
[0m21:11:26.044472 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_customer"
[0m21:11:26.045473 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_customer: BEGIN
[0m21:11:26.045473 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:11:26.124436 [debug] [Thread-1 (]: SQL status: BEGIN in 0.079 seconds
[0m21:11:26.125944 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_customer"
[0m21:11:26.125944 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.sales_summary_by_customer"} */

  create view "test_db"."public"."sales_summary_by_customer__dbt_tmp"
    
    
  as (
    -- models/sales/sales_summary_by_customer.sql

SELECT
    c.c_custkey AS customer_id,
    c.c_name AS customer_name,
    SUM(l.l_extendedprice) AS total_sales,
    SUM(l.l_discount) AS total_discount,
    SUM(l.l_quantity) AS total_quantity_purchased
FROM
    lineitem l
JOIN
    orders o ON l.l_orderkey = o.o_orderkey
JOIN
    customer c ON o.o_custkey = c.c_custkey
GROUP BY
    c.c_custkey, c.c_name
ORDER BY
    total_sales DESC
  );
[0m21:11:26.132440 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m21:11:26.138965 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_customer"
[0m21:11:26.138965 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.sales_summary_by_customer"} */
alter table "test_db"."public"."sales_summary_by_customer__dbt_tmp" rename to "sales_summary_by_customer"
[0m21:11:26.139965 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:11:26.153483 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_customer: COMMIT
[0m21:11:26.153483 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_customer"
[0m21:11:26.154484 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_customer: COMMIT
[0m21:11:26.155483 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:11:26.160924 [debug] [Thread-1 (]: Applying DROP to: "test_db"."public"."sales_summary_by_customer__dbt_backup"
[0m21:11:26.166433 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_customer"
[0m21:11:26.166433 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.sales_summary_by_customer"} */
drop view if exists "test_db"."public"."sales_summary_by_customer__dbt_backup" cascade
[0m21:11:26.167433 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m21:11:26.170435 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_customer: Close
[0m21:11:26.171435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '583c3966-a174-4076-a388-a471121c112f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF19F3E3C0>]}
[0m21:11:26.172434 [info ] [Thread-1 (]: 1 of 2 OK created sql view model public.sales_summary_by_customer .............. [[32mCREATE VIEW[0m in 0.17s]
[0m21:11:26.174434 [debug] [Thread-1 (]: Finished running node model.test_project.sales_summary_by_customer
[0m21:11:26.174434 [debug] [Thread-1 (]: Began running node model.test_project.sales_summary_by_date
[0m21:11:26.175433 [info ] [Thread-1 (]: 2 of 2 START sql view model public.sales_summary_by_date ....................... [RUN]
[0m21:11:26.176593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.test_project.sales_summary_by_customer, now model.test_project.sales_summary_by_date)
[0m21:11:26.177594 [debug] [Thread-1 (]: Began compiling node model.test_project.sales_summary_by_date
[0m21:11:26.179592 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_project.sales_summary_by_date"
[0m21:11:26.181595 [debug] [Thread-1 (]: Began executing node model.test_project.sales_summary_by_date
[0m21:11:26.185595 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_project.sales_summary_by_date"
[0m21:11:26.188114 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_date"
[0m21:11:26.189117 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_date: BEGIN
[0m21:11:26.189117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:26.266076 [debug] [Thread-1 (]: SQL status: BEGIN in 0.077 seconds
[0m21:11:26.267081 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_date"
[0m21:11:26.268085 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_date: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.sales_summary_by_date"} */

  create view "test_db"."public"."sales_summary_by_date__dbt_tmp"
    
    
  as (
    -- models/sales/sales_summary_by_date.sql

SELECT
    o.o_orderdate AS order_date,
    SUM(l.l_extendedprice) AS total_sales,
    SUM(l.l_discount) AS total_discount,
    SUM(l.l_quantity) AS total_quantity_sold
FROM
    lineitem l
JOIN
    orders o ON l.l_orderkey = o.o_orderkey
GROUP BY
    o.o_orderdate
ORDER BY
    o.o_orderdate
  );
[0m21:11:26.273087 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m21:11:26.275589 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_date"
[0m21:11:26.276594 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_date: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.sales_summary_by_date"} */
alter table "test_db"."public"."sales_summary_by_date__dbt_tmp" rename to "sales_summary_by_date"
[0m21:11:26.276594 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:11:26.278597 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_date: COMMIT
[0m21:11:26.280595 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_date"
[0m21:11:26.281595 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_date: COMMIT
[0m21:11:26.282595 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m21:11:26.285596 [debug] [Thread-1 (]: Applying DROP to: "test_db"."public"."sales_summary_by_date__dbt_backup"
[0m21:11:26.286100 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_date"
[0m21:11:26.287106 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_date: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.sales_summary_by_date"} */
drop view if exists "test_db"."public"."sales_summary_by_date__dbt_backup" cascade
[0m21:11:26.288107 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m21:11:26.289107 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_date: Close
[0m21:11:26.290106 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '583c3966-a174-4076-a388-a471121c112f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF1E0FF8F0>]}
[0m21:11:26.291107 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.sales_summary_by_date .................. [[32mCREATE VIEW[0m in 0.11s]
[0m21:11:26.292106 [debug] [Thread-1 (]: Finished running node model.test_project.sales_summary_by_date
[0m21:11:26.293106 [debug] [MainThread]: Using postgres connection "master"
[0m21:11:26.294107 [debug] [MainThread]: On master: BEGIN
[0m21:11:26.294107 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:11:26.377362 [debug] [MainThread]: SQL status: BEGIN in 0.082 seconds
[0m21:11:26.377362 [debug] [MainThread]: On master: COMMIT
[0m21:11:26.378361 [debug] [MainThread]: Using postgres connection "master"
[0m21:11:26.379361 [debug] [MainThread]: On master: COMMIT
[0m21:11:26.379361 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:11:26.380361 [debug] [MainThread]: On master: Close
[0m21:11:26.381362 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:11:26.381362 [debug] [MainThread]: Connection 'list_test_db' was properly closed.
[0m21:11:26.382362 [debug] [MainThread]: Connection 'list_test_db_public' was properly closed.
[0m21:11:26.383363 [debug] [MainThread]: Connection 'model.test_project.sales_summary_by_date' was properly closed.
[0m21:11:26.383363 [info ] [MainThread]: 
[0m21:11:26.384361 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.98 seconds (0.98s).
[0m21:11:26.385361 [debug] [MainThread]: Command end result
[0m21:11:26.415382 [info ] [MainThread]: 
[0m21:11:26.416388 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:11:26.417389 [info ] [MainThread]: 
[0m21:11:26.418394 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:11:26.420452 [debug] [MainThread]: Command `dbt run` succeeded at 21:11:26.420394 after 2.09 seconds
[0m21:11:26.420956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF1C0BFE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF1C425D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CF1DB891C0>]}
[0m21:11:26.421962 [debug] [MainThread]: Flushing usage events
[0m21:12:45.243025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD92086330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD8E812270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD91E93620>]}


============================== 21:12:45.249107 | b5b05c0a-c4ce-48dc-be75-ed94b17597d9 ==============================
[0m21:12:45.249107 [info ] [MainThread]: Running with dbt=1.8.6
[0m21:12:45.250107 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:12:45.467977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5b05c0a-c4ce-48dc-be75-ed94b17597d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD922D4560>]}
[0m21:12:45.515563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5b05c0a-c4ce-48dc-be75-ed94b17597d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD92232E70>]}
[0m21:12:45.517569 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:12:45.526072 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m21:12:45.705903 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:12:45.706909 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:12:45.710908 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.test_project.example
[0m21:12:45.739957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5b05c0a-c4ce-48dc-be75-ed94b17597d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD919028A0>]}
[0m21:12:45.848842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5b05c0a-c4ce-48dc-be75-ed94b17597d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD93801130>]}
[0m21:12:45.849841 [info ] [MainThread]: Found 2 models, 3 data tests, 417 macros
[0m21:12:45.850839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5b05c0a-c4ce-48dc-be75-ed94b17597d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD9230BB00>]}
[0m21:12:45.852839 [info ] [MainThread]: 
[0m21:12:45.853838 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:12:45.857918 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_db_public'
[0m21:12:46.039492 [debug] [ThreadPool]: Using postgres connection "list_test_db_public"
[0m21:12:46.040493 [debug] [ThreadPool]: On list_test_db_public: BEGIN
[0m21:12:46.040493 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:12:46.121997 [debug] [ThreadPool]: SQL status: BEGIN in 0.081 seconds
[0m21:12:46.123000 [debug] [ThreadPool]: Using postgres connection "list_test_db_public"
[0m21:12:46.123999 [debug] [ThreadPool]: On list_test_db_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "list_test_db_public"} */
select
      'test_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'test_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:12:46.129510 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m21:12:46.131512 [debug] [ThreadPool]: On list_test_db_public: ROLLBACK
[0m21:12:46.132511 [debug] [ThreadPool]: On list_test_db_public: Close
[0m21:12:46.137023 [debug] [MainThread]: Using postgres connection "master"
[0m21:12:46.138527 [debug] [MainThread]: On master: BEGIN
[0m21:12:46.138527 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:12:46.213999 [debug] [MainThread]: SQL status: BEGIN in 0.075 seconds
[0m21:12:46.213999 [debug] [MainThread]: Using postgres connection "master"
[0m21:12:46.213999 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:12:46.222512 [debug] [MainThread]: SQL status: SELECT 5 in 0.007 seconds
[0m21:12:46.225511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5b05c0a-c4ce-48dc-be75-ed94b17597d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD91902A20>]}
[0m21:12:46.226014 [debug] [MainThread]: On master: ROLLBACK
[0m21:12:46.227018 [debug] [MainThread]: Using postgres connection "master"
[0m21:12:46.228022 [debug] [MainThread]: On master: BEGIN
[0m21:12:46.229022 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:12:46.229022 [debug] [MainThread]: On master: COMMIT
[0m21:12:46.230021 [debug] [MainThread]: Using postgres connection "master"
[0m21:12:46.230021 [debug] [MainThread]: On master: COMMIT
[0m21:12:46.231021 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:12:46.232021 [debug] [MainThread]: On master: Close
[0m21:12:46.232021 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:12:46.233021 [info ] [MainThread]: 
[0m21:12:46.238532 [debug] [Thread-1 (]: Began running node test.test_project.not_null_sales_summary_by_customer_customer_id.c48f3694b9
[0m21:12:46.239040 [info ] [Thread-1 (]: 1 of 3 START test not_null_sales_summary_by_customer_customer_id ............... [RUN]
[0m21:12:46.240048 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.test_project.not_null_sales_summary_by_customer_customer_id.c48f3694b9'
[0m21:12:46.240048 [debug] [Thread-1 (]: Began compiling node test.test_project.not_null_sales_summary_by_customer_customer_id.c48f3694b9
[0m21:12:46.259066 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_project.not_null_sales_summary_by_customer_customer_id.c48f3694b9"
[0m21:12:46.263070 [debug] [Thread-1 (]: Began executing node test.test_project.not_null_sales_summary_by_customer_customer_id.c48f3694b9
[0m21:12:46.277675 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_project.not_null_sales_summary_by_customer_customer_id.c48f3694b9"
[0m21:12:46.281676 [debug] [Thread-1 (]: Using postgres connection "test.test_project.not_null_sales_summary_by_customer_customer_id.c48f3694b9"
[0m21:12:46.282676 [debug] [Thread-1 (]: On test.test_project.not_null_sales_summary_by_customer_customer_id.c48f3694b9: BEGIN
[0m21:12:46.283676 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:12:46.360197 [debug] [Thread-1 (]: SQL status: BEGIN in 0.076 seconds
[0m21:12:46.361236 [debug] [Thread-1 (]: Using postgres connection "test.test_project.not_null_sales_summary_by_customer_customer_id.c48f3694b9"
[0m21:12:46.361754 [debug] [Thread-1 (]: On test.test_project.not_null_sales_summary_by_customer_customer_id.c48f3694b9: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "test.test_project.not_null_sales_summary_by_customer_customer_id.c48f3694b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "test_db"."public"."sales_summary_by_customer"
where customer_id is null



      
    ) dbt_internal_test
[0m21:12:46.790136 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.428 seconds
[0m21:12:46.794135 [debug] [Thread-1 (]: On test.test_project.not_null_sales_summary_by_customer_customer_id.c48f3694b9: ROLLBACK
[0m21:12:46.795135 [debug] [Thread-1 (]: On test.test_project.not_null_sales_summary_by_customer_customer_id.c48f3694b9: Close
[0m21:12:46.796172 [info ] [Thread-1 (]: 1 of 3 PASS not_null_sales_summary_by_customer_customer_id ..................... [[32mPASS[0m in 0.56s]
[0m21:12:46.797171 [debug] [Thread-1 (]: Finished running node test.test_project.not_null_sales_summary_by_customer_customer_id.c48f3694b9
[0m21:12:46.798170 [debug] [Thread-1 (]: Began running node test.test_project.not_null_sales_summary_by_date_order_date.cc12b38f8e
[0m21:12:46.799171 [info ] [Thread-1 (]: 2 of 3 START test not_null_sales_summary_by_date_order_date .................... [RUN]
[0m21:12:46.800173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_project.not_null_sales_summary_by_customer_customer_id.c48f3694b9, now test.test_project.not_null_sales_summary_by_date_order_date.cc12b38f8e)
[0m21:12:46.800173 [debug] [Thread-1 (]: Began compiling node test.test_project.not_null_sales_summary_by_date_order_date.cc12b38f8e
[0m21:12:46.804174 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_project.not_null_sales_summary_by_date_order_date.cc12b38f8e"
[0m21:12:46.807209 [debug] [Thread-1 (]: Began executing node test.test_project.not_null_sales_summary_by_date_order_date.cc12b38f8e
[0m21:12:46.810208 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_project.not_null_sales_summary_by_date_order_date.cc12b38f8e"
[0m21:12:46.813211 [debug] [Thread-1 (]: Using postgres connection "test.test_project.not_null_sales_summary_by_date_order_date.cc12b38f8e"
[0m21:12:46.813211 [debug] [Thread-1 (]: On test.test_project.not_null_sales_summary_by_date_order_date.cc12b38f8e: BEGIN
[0m21:12:46.814208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:12:46.998226 [debug] [Thread-1 (]: SQL status: BEGIN in 0.184 seconds
[0m21:12:46.999229 [debug] [Thread-1 (]: Using postgres connection "test.test_project.not_null_sales_summary_by_date_order_date.cc12b38f8e"
[0m21:12:46.999229 [debug] [Thread-1 (]: On test.test_project.not_null_sales_summary_by_date_order_date.cc12b38f8e: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "test.test_project.not_null_sales_summary_by_date_order_date.cc12b38f8e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_date
from "test_db"."public"."sales_summary_by_date"
where order_date is null



      
    ) dbt_internal_test
[0m21:12:48.533039 [debug] [Thread-1 (]: SQL status: SELECT 1 in 1.532 seconds
[0m21:12:48.534040 [debug] [Thread-1 (]: On test.test_project.not_null_sales_summary_by_date_order_date.cc12b38f8e: ROLLBACK
[0m21:12:48.535545 [debug] [Thread-1 (]: On test.test_project.not_null_sales_summary_by_date_order_date.cc12b38f8e: Close
[0m21:12:48.535545 [info ] [Thread-1 (]: 2 of 3 PASS not_null_sales_summary_by_date_order_date .......................... [[32mPASS[0m in 1.74s]
[0m21:12:48.537551 [debug] [Thread-1 (]: Finished running node test.test_project.not_null_sales_summary_by_date_order_date.cc12b38f8e
[0m21:12:48.538551 [debug] [Thread-1 (]: Began running node test.test_project.unique_sales_summary_by_customer_customer_id.86e57d5912
[0m21:12:48.538551 [info ] [Thread-1 (]: 3 of 3 START test unique_sales_summary_by_customer_customer_id ................. [RUN]
[0m21:12:48.539552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_project.not_null_sales_summary_by_date_order_date.cc12b38f8e, now test.test_project.unique_sales_summary_by_customer_customer_id.86e57d5912)
[0m21:12:48.541060 [debug] [Thread-1 (]: Began compiling node test.test_project.unique_sales_summary_by_customer_customer_id.86e57d5912
[0m21:12:48.546582 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_project.unique_sales_summary_by_customer_customer_id.86e57d5912"
[0m21:12:48.550590 [debug] [Thread-1 (]: Began executing node test.test_project.unique_sales_summary_by_customer_customer_id.86e57d5912
[0m21:12:48.553591 [debug] [Thread-1 (]: Writing runtime sql for node "test.test_project.unique_sales_summary_by_customer_customer_id.86e57d5912"
[0m21:12:48.556653 [debug] [Thread-1 (]: Using postgres connection "test.test_project.unique_sales_summary_by_customer_customer_id.86e57d5912"
[0m21:12:48.557654 [debug] [Thread-1 (]: On test.test_project.unique_sales_summary_by_customer_customer_id.86e57d5912: BEGIN
[0m21:12:48.558654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:12:48.632951 [debug] [Thread-1 (]: SQL status: BEGIN in 0.075 seconds
[0m21:12:48.633950 [debug] [Thread-1 (]: Using postgres connection "test.test_project.unique_sales_summary_by_customer_customer_id.86e57d5912"
[0m21:12:48.633950 [debug] [Thread-1 (]: On test.test_project.unique_sales_summary_by_customer_customer_id.86e57d5912: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "test.test_project.unique_sales_summary_by_customer_customer_id.86e57d5912"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "test_db"."public"."sales_summary_by_customer"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:14:25.485588 [debug] [Thread-1 (]: SQL status: SELECT 1 in 96.851 seconds
[0m21:14:25.502615 [debug] [Thread-1 (]: On test.test_project.unique_sales_summary_by_customer_customer_id.86e57d5912: ROLLBACK
[0m21:14:25.503614 [debug] [Thread-1 (]: On test.test_project.unique_sales_summary_by_customer_customer_id.86e57d5912: Close
[0m21:14:25.504615 [info ] [Thread-1 (]: 3 of 3 PASS unique_sales_summary_by_customer_customer_id ....................... [[32mPASS[0m in 96.97s]
[0m21:14:25.505617 [debug] [Thread-1 (]: Finished running node test.test_project.unique_sales_summary_by_customer_customer_id.86e57d5912
[0m21:14:25.508018 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:25.508018 [debug] [MainThread]: On master: BEGIN
[0m21:14:25.509020 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:14:27.576166 [debug] [MainThread]: SQL status: BEGIN in 2.067 seconds
[0m21:14:27.577171 [debug] [MainThread]: On master: COMMIT
[0m21:14:27.577171 [debug] [MainThread]: Using postgres connection "master"
[0m21:14:27.578169 [debug] [MainThread]: On master: COMMIT
[0m21:14:27.579170 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:14:27.580167 [debug] [MainThread]: On master: Close
[0m21:14:27.580167 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:14:27.581167 [debug] [MainThread]: Connection 'list_test_db_public' was properly closed.
[0m21:14:27.582167 [debug] [MainThread]: Connection 'test.test_project.unique_sales_summary_by_customer_customer_id.86e57d5912' was properly closed.
[0m21:14:27.582167 [info ] [MainThread]: 
[0m21:14:27.583168 [info ] [MainThread]: Finished running 3 data tests in 0 hours 1 minutes and 41.73 seconds (101.73s).
[0m21:14:27.585166 [debug] [MainThread]: Command end result
[0m21:14:28.922373 [info ] [MainThread]: 
[0m21:14:28.923375 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:14:28.924373 [info ] [MainThread]: 
[0m21:14:28.924373 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:14:28.933402 [debug] [MainThread]: Command `dbt test` succeeded at 21:14:28.933402 after 103.84 seconds
[0m21:14:28.934402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD921E6270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD8C2A2720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD92086330>]}
[0m21:14:28.934402 [debug] [MainThread]: Flushing usage events
[0m21:16:41.038472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C1A858DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C1CA28710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C1CA29B50>]}


============================== 21:16:41.042502 | 516e2994-5906-42fd-b60a-4ad0a48f678a ==============================
[0m21:16:41.042502 [info ] [MainThread]: Running with dbt=1.8.6
[0m21:16:41.043501 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:16:41.073759 [info ] [MainThread]: dbt version: 1.8.6
[0m21:16:41.074762 [info ] [MainThread]: python version: 3.12.4
[0m21:16:41.075762 [info ] [MainThread]: python path: C:\Users\Thomas\anaconda3\envs\dbtTest\python.exe
[0m21:16:41.076832 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m21:16:41.175686 [info ] [MainThread]: Using profiles dir at C:\Users\Thomas\OneDrive - Aarhus universitet\Data Engineering\dbt-test
[0m21:16:41.177693 [info ] [MainThread]: Using profiles.yml file at C:\Users\Thomas\OneDrive - Aarhus universitet\Data Engineering\dbt-test\profiles.yml
[0m21:16:41.178693 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Thomas\OneDrive - Aarhus universitet\Data Engineering\dbt-test\dbt_project.yml
[0m21:16:41.254344 [info ] [MainThread]: Configuration:
[0m21:16:41.254344 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m21:16:41.255908 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:16:41.256854 [info ] [MainThread]: Required dependencies:
[0m21:16:41.257855 [debug] [MainThread]: Executing "git --help"
[0m21:16:41.340461 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:16:41.341504 [debug] [MainThread]: STDERR: "b''"
[0m21:16:41.342027 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:16:41.343069 [info ] [MainThread]: Connection test skipped since no profile was found
[0m21:16:41.344125 [info ] [MainThread]: [31m1 check failed:[0m
[0m21:16:41.344638 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "test_project", target "dev" invalid: 123456 is not of type 'string'


[0m21:16:41.346726 [debug] [MainThread]: Command `dbt debug` failed at 21:16:41.346726 after 0.46 seconds
[0m21:16:41.347892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C1C3C1F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C1A858DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C1C8A3260>]}
[0m21:16:41.348396 [debug] [MainThread]: Flushing usage events
[0m21:17:03.245315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB2766CE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB2AF361E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB2AF363F0>]}


============================== 21:17:03.249652 | d13e33b5-636e-40fd-acdf-d35e2245768a ==============================
[0m21:17:03.249652 [info ] [MainThread]: Running with dbt=1.8.6
[0m21:17:03.250650 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m21:17:03.272768 [info ] [MainThread]: dbt version: 1.8.6
[0m21:17:03.273770 [info ] [MainThread]: python version: 3.12.4
[0m21:17:03.273770 [info ] [MainThread]: python path: C:\Users\Thomas\anaconda3\envs\dbtTest\python.exe
[0m21:17:03.275277 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m21:17:03.367122 [info ] [MainThread]: Using profiles dir at C:\Users\Thomas\OneDrive - Aarhus universitet\Data Engineering\dbt-test
[0m21:17:03.368122 [info ] [MainThread]: Using profiles.yml file at C:\Users\Thomas\OneDrive - Aarhus universitet\Data Engineering\dbt-test\profiles.yml
[0m21:17:03.369124 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Thomas\OneDrive - Aarhus universitet\Data Engineering\dbt-test\dbt_project.yml
[0m21:17:03.371123 [info ] [MainThread]: adapter type: postgres
[0m21:17:03.372122 [info ] [MainThread]: adapter version: 1.8.2
[0m21:17:03.448200 [info ] [MainThread]: Configuration:
[0m21:17:03.449200 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:17:03.450200 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:17:03.451200 [info ] [MainThread]: Required dependencies:
[0m21:17:03.451200 [debug] [MainThread]: Executing "git --help"
[0m21:17:03.521291 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:17:03.522292 [debug] [MainThread]: STDERR: "b''"
[0m21:17:03.522292 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:17:03.523293 [info ] [MainThread]: Connection:
[0m21:17:03.524291 [info ] [MainThread]:   host: localhost
[0m21:17:03.525291 [info ] [MainThread]:   port: 5432
[0m21:17:03.525291 [info ] [MainThread]:   user: postgres
[0m21:17:03.526478 [info ] [MainThread]:   database: test_db
[0m21:17:03.527476 [info ] [MainThread]:   schema: public
[0m21:17:03.527476 [info ] [MainThread]:   connect_timeout: 10
[0m21:17:03.528478 [info ] [MainThread]:   role: None
[0m21:17:03.529478 [info ] [MainThread]:   search_path: None
[0m21:17:03.530478 [info ] [MainThread]:   keepalives_idle: 0
[0m21:17:03.530478 [info ] [MainThread]:   sslmode: None
[0m21:17:03.531477 [info ] [MainThread]:   sslcert: None
[0m21:17:03.532476 [info ] [MainThread]:   sslkey: None
[0m21:17:03.533477 [info ] [MainThread]:   sslrootcert: None
[0m21:17:03.534479 [info ] [MainThread]:   application_name: dbt
[0m21:17:03.534479 [info ] [MainThread]:   retries: 1
[0m21:17:03.535478 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:17:03.536716 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:17:03.706732 [debug] [MainThread]: Using postgres connection "debug"
[0m21:17:03.707733 [debug] [MainThread]: On debug: select 1 as id
[0m21:17:03.708739 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:17:03.787357 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "postgres"

[0m21:17:03.860892 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m21:17:03.861890 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m21:17:03.862892 [debug] [MainThread]: On debug: No close available on handle
[0m21:17:03.863891 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m21:17:03.863891 [info ] [MainThread]: [31m1 check failed:[0m
[0m21:17:03.865395 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "postgres"
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m21:17:03.867402 [debug] [MainThread]: Command `dbt debug` failed at 21:17:03.867402 after 0.77 seconds
[0m21:17:03.868401 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:17:03.869401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB2766CE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB2B0E2F60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB2B15F680>]}
[0m21:17:03.870401 [debug] [MainThread]: Flushing usage events
[0m21:18:20.119250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169B6B2D9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169B8F11340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169B97C7860>]}


============================== 21:18:20.123250 | 0931b2c3-5812-4223-b0f1-5d924fe6060a ==============================
[0m21:18:20.123250 [info ] [MainThread]: Running with dbt=1.8.6
[0m21:18:20.124252 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:18:20.146291 [info ] [MainThread]: dbt version: 1.8.6
[0m21:18:20.147295 [info ] [MainThread]: python version: 3.12.4
[0m21:18:20.148292 [info ] [MainThread]: python path: C:\Users\Thomas\anaconda3\envs\dbtTest\python.exe
[0m21:18:20.149298 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m21:18:20.244017 [info ] [MainThread]: Using profiles dir at C:\Users\Thomas\OneDrive - Aarhus universitet\Data Engineering\dbt-test
[0m21:18:20.245017 [info ] [MainThread]: Using profiles.yml file at C:\Users\Thomas\OneDrive - Aarhus universitet\Data Engineering\dbt-test\profiles.yml
[0m21:18:20.246247 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Thomas\OneDrive - Aarhus universitet\Data Engineering\dbt-test\dbt_project.yml
[0m21:18:20.248247 [info ] [MainThread]: adapter type: postgres
[0m21:18:20.249247 [info ] [MainThread]: adapter version: 1.8.2
[0m21:18:20.327102 [info ] [MainThread]: Configuration:
[0m21:18:20.328107 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:18:20.329108 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:18:20.330107 [info ] [MainThread]: Required dependencies:
[0m21:18:20.331107 [debug] [MainThread]: Executing "git --help"
[0m21:18:20.400626 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:18:20.401628 [debug] [MainThread]: STDERR: "b''"
[0m21:18:20.402627 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:18:20.403629 [info ] [MainThread]: Connection:
[0m21:18:20.404626 [info ] [MainThread]:   host: localhost
[0m21:18:20.404626 [info ] [MainThread]:   port: 5432
[0m21:18:20.405626 [info ] [MainThread]:   user: postgres
[0m21:18:20.406627 [info ] [MainThread]:   database: test_db
[0m21:18:20.407627 [info ] [MainThread]:   schema: public
[0m21:18:20.407627 [info ] [MainThread]:   connect_timeout: 10
[0m21:18:20.408626 [info ] [MainThread]:   role: None
[0m21:18:20.409626 [info ] [MainThread]:   search_path: None
[0m21:18:20.409626 [info ] [MainThread]:   keepalives_idle: 0
[0m21:18:20.410628 [info ] [MainThread]:   sslmode: None
[0m21:18:20.411626 [info ] [MainThread]:   sslcert: None
[0m21:18:20.411626 [info ] [MainThread]:   sslkey: None
[0m21:18:20.412627 [info ] [MainThread]:   sslrootcert: None
[0m21:18:20.413628 [info ] [MainThread]:   application_name: dbt
[0m21:18:20.414630 [info ] [MainThread]:   retries: 1
[0m21:18:20.415627 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:18:20.416626 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:18:20.585860 [debug] [MainThread]: Using postgres connection "debug"
[0m21:18:20.585860 [debug] [MainThread]: On debug: select 1 as id
[0m21:18:20.586862 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:18:20.670942 [debug] [MainThread]: SQL status: SELECT 1 in 0.084 seconds
[0m21:18:20.672939 [debug] [MainThread]: On debug: Close
[0m21:18:20.672939 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:18:20.674941 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:18:20.675939 [debug] [MainThread]: Command `dbt debug` succeeded at 21:18:20.675939 after 0.71 seconds
[0m21:18:20.676940 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:18:20.677945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169B6B2D9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169B99F6540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169B8E54740>]}
[0m21:18:20.677945 [debug] [MainThread]: Flushing usage events
[0m21:21:16.617505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209DDECD9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209DFEDCC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209DFC094C0>]}


============================== 21:21:16.621695 | d96d3a7e-fbf8-46bb-b68b-957fc5547620 ==============================
[0m21:21:16.621695 [info ] [MainThread]: Running with dbt=1.8.6
[0m21:21:16.623285 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:21:16.840423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd96d3a7e-fbf8-46bb-b68b-957fc5547620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209DFEB64E0>]}
[0m21:21:16.890301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd96d3a7e-fbf8-46bb-b68b-957fc5547620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209DE6E63C0>]}
[0m21:21:16.892307 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:21:16.901306 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m21:21:17.089537 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m21:21:17.090537 [debug] [MainThread]: Partial parsing: added file: test_project://test_project/models\fact_tables\fact_sales.sql
[0m21:21:17.276182 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.test_project.example
[0m21:21:17.281694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd96d3a7e-fbf8-46bb-b68b-957fc5547620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209E22353D0>]}
[0m21:21:17.375431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd96d3a7e-fbf8-46bb-b68b-957fc5547620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209E220EC60>]}
[0m21:21:17.375431 [info ] [MainThread]: Found 3 models, 3 data tests, 417 macros
[0m21:21:17.376434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd96d3a7e-fbf8-46bb-b68b-957fc5547620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209E037D8B0>]}
[0m21:21:17.378434 [info ] [MainThread]: 
[0m21:21:17.379433 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:21:17.382435 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_db'
[0m21:21:17.556490 [debug] [ThreadPool]: Using postgres connection "list_test_db"
[0m21:21:17.556490 [debug] [ThreadPool]: On list_test_db: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "list_test_db"} */

    select distinct nspname from pg_namespace
  
[0m21:21:17.557491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:21:17.635677 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.079 seconds
[0m21:21:17.637677 [debug] [ThreadPool]: On list_test_db: Close
[0m21:21:17.639678 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_db_public'
[0m21:21:17.644677 [debug] [ThreadPool]: Using postgres connection "list_test_db_public"
[0m21:21:17.645677 [debug] [ThreadPool]: On list_test_db_public: BEGIN
[0m21:21:17.646184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:21:17.717939 [debug] [ThreadPool]: SQL status: BEGIN in 0.072 seconds
[0m21:21:17.718942 [debug] [ThreadPool]: Using postgres connection "list_test_db_public"
[0m21:21:17.718942 [debug] [ThreadPool]: On list_test_db_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "list_test_db_public"} */
select
      'test_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'test_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:21:17.723940 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m21:21:17.725446 [debug] [ThreadPool]: On list_test_db_public: ROLLBACK
[0m21:21:17.726452 [debug] [ThreadPool]: On list_test_db_public: Close
[0m21:21:17.732963 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:17.732963 [debug] [MainThread]: On master: BEGIN
[0m21:21:17.733962 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:21:17.805551 [debug] [MainThread]: SQL status: BEGIN in 0.071 seconds
[0m21:21:17.806057 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:17.806057 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:21:17.812572 [debug] [MainThread]: SQL status: SELECT 5 in 0.006 seconds
[0m21:21:17.815089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd96d3a7e-fbf8-46bb-b68b-957fc5547620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209E0DA73E0>]}
[0m21:21:17.816087 [debug] [MainThread]: On master: ROLLBACK
[0m21:21:17.816087 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:17.817088 [debug] [MainThread]: On master: BEGIN
[0m21:21:17.818087 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:21:17.818087 [debug] [MainThread]: On master: COMMIT
[0m21:21:17.819223 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:17.819223 [debug] [MainThread]: On master: COMMIT
[0m21:21:17.820224 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:21:17.821223 [debug] [MainThread]: On master: Close
[0m21:21:17.821223 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:21:17.822224 [info ] [MainThread]: 
[0m21:21:17.826586 [debug] [Thread-1 (]: Began running node model.test_project.fact_sales
[0m21:21:17.826586 [info ] [Thread-1 (]: 1 of 3 START sql view model public.fact_sales .................................. [RUN]
[0m21:21:17.827588 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.test_project.fact_sales'
[0m21:21:17.828587 [debug] [Thread-1 (]: Began compiling node model.test_project.fact_sales
[0m21:21:17.834097 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_project.fact_sales"
[0m21:21:17.837101 [debug] [Thread-1 (]: Began executing node model.test_project.fact_sales
[0m21:21:17.867631 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_project.fact_sales"
[0m21:21:17.870136 [debug] [Thread-1 (]: Using postgres connection "model.test_project.fact_sales"
[0m21:21:17.871146 [debug] [Thread-1 (]: On model.test_project.fact_sales: BEGIN
[0m21:21:17.872143 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:21:17.944142 [debug] [Thread-1 (]: SQL status: BEGIN in 0.073 seconds
[0m21:21:17.945647 [debug] [Thread-1 (]: Using postgres connection "model.test_project.fact_sales"
[0m21:21:17.946653 [debug] [Thread-1 (]: On model.test_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.fact_sales"} */

  create view "test_db"."public"."fact_sales__dbt_tmp"
    
    
  as (
    -- models/fact_sales.sql

WITH customer_sales AS (
    SELECT
        c.c_custkey AS customer_id,
        o.o_orderdate AS order_date,
        SUM(l.l_extendedprice) AS total_sales,
        SUM(l.l_discount) AS total_discount,
        SUM(l.l_quantity) AS total_quantity
    FROM
        lineitem l
    JOIN
        orders o ON l.l_orderkey = o.o_orderkey
    JOIN
        customer c ON o.o_custkey = c.c_custkey
    GROUP BY
        c.c_custkey, o.o_orderdate
)

SELECT
    customer_id,
    order_date,
    total_sales,
    total_discount,
    total_quantity
FROM
    customer_sales
ORDER BY
    order_date, customer_id;
  );
[0m21:21:17.947655 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 35:     order_date, customer_id;
                                    ^

[0m21:21:17.948654 [debug] [Thread-1 (]: On model.test_project.fact_sales: ROLLBACK
[0m21:21:17.949654 [debug] [Thread-1 (]: On model.test_project.fact_sales: Close
[0m21:21:17.958305 [debug] [Thread-1 (]: Database Error in model fact_sales (test_project/models\fact_tables\fact_sales.sql)
  syntax error at or near ";"
  LINE 35:     order_date, customer_id;
                                      ^
  compiled Code at target\run\test_project\test_project/models\fact_tables\fact_sales.sql
[0m21:21:17.960309 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd96d3a7e-fbf8-46bb-b68b-957fc5547620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209E246F800>]}
[0m21:21:17.961309 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public.fact_sales ......................... [[31mERROR[0m in 0.13s]
[0m21:21:17.962305 [debug] [Thread-1 (]: Finished running node model.test_project.fact_sales
[0m21:21:17.963305 [debug] [Thread-1 (]: Began running node model.test_project.sales_summary_by_customer
[0m21:21:17.964306 [info ] [Thread-1 (]: 2 of 3 START sql view model public.sales_summary_by_customer ................... [RUN]
[0m21:21:17.964306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.test_project.fact_sales, now model.test_project.sales_summary_by_customer)
[0m21:21:17.965811 [debug] [Thread-1 (]: Began compiling node model.test_project.sales_summary_by_customer
[0m21:21:17.967816 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_project.sales_summary_by_customer"
[0m21:21:17.969817 [debug] [Thread-1 (]: Began executing node model.test_project.sales_summary_by_customer
[0m21:21:17.972896 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_project.sales_summary_by_customer"
[0m21:21:17.975896 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_customer"
[0m21:21:17.975896 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_customer: BEGIN
[0m21:21:17.976892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:21:18.062341 [debug] [Thread-1 (]: SQL status: BEGIN in 0.086 seconds
[0m21:21:18.063346 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_customer"
[0m21:21:18.064345 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.sales_summary_by_customer"} */

  create view "test_db"."public"."sales_summary_by_customer__dbt_tmp"
    
    
  as (
    -- models/sales/sales_summary_by_customer.sql

SELECT
    c.c_custkey AS customer_id,
    c.c_name AS customer_name,
    SUM(l.l_extendedprice) AS total_sales,
    SUM(l.l_discount) AS total_discount,
    SUM(l.l_quantity) AS total_quantity_purchased
FROM
    lineitem l
JOIN
    orders o ON l.l_orderkey = o.o_orderkey
JOIN
    customer c ON o.o_custkey = c.c_custkey
GROUP BY
    c.c_custkey, c.c_name
ORDER BY
    total_sales DESC
  );
[0m21:21:18.068855 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m21:21:18.075378 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_customer"
[0m21:21:18.075378 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.sales_summary_by_customer"} */
alter table "test_db"."public"."sales_summary_by_customer" rename to "sales_summary_by_customer__dbt_backup"
[0m21:21:18.076378 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:21:18.079378 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_customer"
[0m21:21:18.079378 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.sales_summary_by_customer"} */
alter table "test_db"."public"."sales_summary_by_customer__dbt_tmp" rename to "sales_summary_by_customer"
[0m21:21:18.080378 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:21:18.094991 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_customer: COMMIT
[0m21:21:18.094991 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_customer"
[0m21:21:18.096042 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_customer: COMMIT
[0m21:21:18.097337 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:21:18.102348 [debug] [Thread-1 (]: Applying DROP to: "test_db"."public"."sales_summary_by_customer__dbt_backup"
[0m21:21:18.106857 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_customer"
[0m21:21:18.107858 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.sales_summary_by_customer"} */
drop view if exists "test_db"."public"."sales_summary_by_customer__dbt_backup" cascade
[0m21:21:18.109857 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m21:21:18.111363 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_customer: Close
[0m21:21:18.112368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd96d3a7e-fbf8-46bb-b68b-957fc5547620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209DE672120>]}
[0m21:21:18.113370 [info ] [Thread-1 (]: 2 of 3 OK created sql view model public.sales_summary_by_customer .............. [[32mCREATE VIEW[0m in 0.15s]
[0m21:21:18.114883 [debug] [Thread-1 (]: Finished running node model.test_project.sales_summary_by_customer
[0m21:21:18.114883 [debug] [Thread-1 (]: Began running node model.test_project.sales_summary_by_date
[0m21:21:18.115883 [info ] [Thread-1 (]: 3 of 3 START sql view model public.sales_summary_by_date ....................... [RUN]
[0m21:21:18.116882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.test_project.sales_summary_by_customer, now model.test_project.sales_summary_by_date)
[0m21:21:18.116882 [debug] [Thread-1 (]: Began compiling node model.test_project.sales_summary_by_date
[0m21:21:18.119393 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_project.sales_summary_by_date"
[0m21:21:18.121397 [debug] [Thread-1 (]: Began executing node model.test_project.sales_summary_by_date
[0m21:21:18.125399 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_project.sales_summary_by_date"
[0m21:21:18.128510 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_date"
[0m21:21:18.128510 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_date: BEGIN
[0m21:21:18.129510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:21:18.203210 [debug] [Thread-1 (]: SQL status: BEGIN in 0.074 seconds
[0m21:21:18.204210 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_date"
[0m21:21:18.204210 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_date: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.sales_summary_by_date"} */

  create view "test_db"."public"."sales_summary_by_date__dbt_tmp"
    
    
  as (
    -- models/sales/sales_summary_by_date.sql

SELECT
    o.o_orderdate AS order_date,
    SUM(l.l_extendedprice) AS total_sales,
    SUM(l.l_discount) AS total_discount,
    SUM(l.l_quantity) AS total_quantity_sold
FROM
    lineitem l
JOIN
    orders o ON l.l_orderkey = o.o_orderkey
GROUP BY
    o.o_orderdate
ORDER BY
    o.o_orderdate
  );
[0m21:21:18.208722 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:21:18.212233 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_date"
[0m21:21:18.213233 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_date: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.sales_summary_by_date"} */
alter table "test_db"."public"."sales_summary_by_date" rename to "sales_summary_by_date__dbt_backup"
[0m21:21:18.214233 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:21:18.216290 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_date"
[0m21:21:18.217236 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_date: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.sales_summary_by_date"} */
alter table "test_db"."public"."sales_summary_by_date__dbt_tmp" rename to "sales_summary_by_date"
[0m21:21:18.218234 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:21:18.219234 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_date: COMMIT
[0m21:21:18.220233 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_date"
[0m21:21:18.221233 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_date: COMMIT
[0m21:21:18.222234 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m21:21:18.224235 [debug] [Thread-1 (]: Applying DROP to: "test_db"."public"."sales_summary_by_date__dbt_backup"
[0m21:21:18.225235 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_date"
[0m21:21:18.225740 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_date: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.sales_summary_by_date"} */
drop view if exists "test_db"."public"."sales_summary_by_date__dbt_backup" cascade
[0m21:21:18.227746 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m21:21:18.228745 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_date: Close
[0m21:21:18.228745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd96d3a7e-fbf8-46bb-b68b-957fc5547620', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209E2A49CA0>]}
[0m21:21:18.230251 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.sales_summary_by_date .................. [[32mCREATE VIEW[0m in 0.11s]
[0m21:21:18.231258 [debug] [Thread-1 (]: Finished running node model.test_project.sales_summary_by_date
[0m21:21:18.233321 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:18.233321 [debug] [MainThread]: On master: BEGIN
[0m21:21:18.234321 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:21:18.416600 [debug] [MainThread]: SQL status: BEGIN in 0.182 seconds
[0m21:21:18.416600 [debug] [MainThread]: On master: COMMIT
[0m21:21:18.417600 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:18.418107 [debug] [MainThread]: On master: COMMIT
[0m21:21:18.419112 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:21:18.419112 [debug] [MainThread]: On master: Close
[0m21:21:18.420112 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:21:18.420112 [debug] [MainThread]: Connection 'list_test_db' was properly closed.
[0m21:21:18.421114 [debug] [MainThread]: Connection 'list_test_db_public' was properly closed.
[0m21:21:18.421114 [debug] [MainThread]: Connection 'model.test_project.sales_summary_by_date' was properly closed.
[0m21:21:18.422114 [info ] [MainThread]: 
[0m21:21:18.423113 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 1.04 seconds (1.04s).
[0m21:21:18.424115 [debug] [MainThread]: Command end result
[0m21:21:18.451733 [info ] [MainThread]: 
[0m21:21:18.452733 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:21:18.453733 [info ] [MainThread]: 
[0m21:21:18.454734 [error] [MainThread]:   Database Error in model fact_sales (test_project/models\fact_tables\fact_sales.sql)
  syntax error at or near ";"
  LINE 35:     order_date, customer_id;
                                      ^
  compiled Code at target\run\test_project\test_project/models\fact_tables\fact_sales.sql
[0m21:21:18.455737 [info ] [MainThread]: 
[0m21:21:18.456812 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m21:21:18.458735 [debug] [MainThread]: Command `dbt run` failed at 21:21:18.458735 after 1.99 seconds
[0m21:21:18.459734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209DDECD9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209E1119E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209E258A330>]}
[0m21:21:18.459734 [debug] [MainThread]: Flushing usage events
[0m21:21:33.192779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002889A8FF170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002889ABB3770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002889ABB3E00>]}


============================== 21:21:33.197420 | 89afcdc9-b029-46a0-9c49-d421dbd5500e ==============================
[0m21:21:33.197420 [info ] [MainThread]: Running with dbt=1.8.6
[0m21:21:33.198473 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:21:33.405899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89afcdc9-b029-46a0-9c49-d421dbd5500e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002889887A510>]}
[0m21:21:33.453503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89afcdc9-b029-46a0-9c49-d421dbd5500e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028899D3AC60>]}
[0m21:21:33.455502 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:21:33.463502 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m21:21:33.647776 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:21:33.648776 [debug] [MainThread]: Partial parsing: updated file: test_project://test_project/models\fact_tables\fact_sales.sql
[0m21:21:33.831753 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.test_project.example
[0m21:21:33.838759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89afcdc9-b029-46a0-9c49-d421dbd5500e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002889C348E60>]}
[0m21:21:33.930983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89afcdc9-b029-46a0-9c49-d421dbd5500e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002889B0DB110>]}
[0m21:21:33.931984 [info ] [MainThread]: Found 3 models, 3 data tests, 417 macros
[0m21:21:33.932984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89afcdc9-b029-46a0-9c49-d421dbd5500e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002889B14B350>]}
[0m21:21:33.934985 [info ] [MainThread]: 
[0m21:21:33.935983 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:21:33.938983 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_db'
[0m21:21:34.109281 [debug] [ThreadPool]: Using postgres connection "list_test_db"
[0m21:21:34.109281 [debug] [ThreadPool]: On list_test_db: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "list_test_db"} */

    select distinct nspname from pg_namespace
  
[0m21:21:34.110784 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:21:34.188604 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.078 seconds
[0m21:21:34.190108 [debug] [ThreadPool]: On list_test_db: Close
[0m21:21:34.192339 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_db_public'
[0m21:21:34.197865 [debug] [ThreadPool]: Using postgres connection "list_test_db_public"
[0m21:21:34.198870 [debug] [ThreadPool]: On list_test_db_public: BEGIN
[0m21:21:34.198870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:21:34.271529 [debug] [ThreadPool]: SQL status: BEGIN in 0.072 seconds
[0m21:21:34.272529 [debug] [ThreadPool]: Using postgres connection "list_test_db_public"
[0m21:21:34.272529 [debug] [ThreadPool]: On list_test_db_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "list_test_db_public"} */
select
      'test_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'test_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:21:34.277528 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.004 seconds
[0m21:21:34.279529 [debug] [ThreadPool]: On list_test_db_public: ROLLBACK
[0m21:21:34.279529 [debug] [ThreadPool]: On list_test_db_public: Close
[0m21:21:34.285031 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:34.285031 [debug] [MainThread]: On master: BEGIN
[0m21:21:34.286035 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:21:34.358371 [debug] [MainThread]: SQL status: BEGIN in 0.072 seconds
[0m21:21:34.358371 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:34.359372 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:21:34.365873 [debug] [MainThread]: SQL status: SELECT 5 in 0.006 seconds
[0m21:21:34.367878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89afcdc9-b029-46a0-9c49-d421dbd5500e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002889B264C80>]}
[0m21:21:34.368878 [debug] [MainThread]: On master: ROLLBACK
[0m21:21:34.368878 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:34.370384 [debug] [MainThread]: On master: BEGIN
[0m21:21:34.370384 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:21:34.371391 [debug] [MainThread]: On master: COMMIT
[0m21:21:34.372391 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:34.372391 [debug] [MainThread]: On master: COMMIT
[0m21:21:34.373390 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:21:34.373390 [debug] [MainThread]: On master: Close
[0m21:21:34.374555 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:21:34.375557 [info ] [MainThread]: 
[0m21:21:34.379066 [debug] [Thread-1 (]: Began running node model.test_project.fact_sales
[0m21:21:34.379066 [info ] [Thread-1 (]: 1 of 3 START sql view model public.fact_sales .................................. [RUN]
[0m21:21:34.380068 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.test_project.fact_sales'
[0m21:21:34.381069 [debug] [Thread-1 (]: Began compiling node model.test_project.fact_sales
[0m21:21:34.388576 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_project.fact_sales"
[0m21:21:34.390576 [debug] [Thread-1 (]: Began executing node model.test_project.fact_sales
[0m21:21:34.419841 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_project.fact_sales"
[0m21:21:34.422841 [debug] [Thread-1 (]: Using postgres connection "model.test_project.fact_sales"
[0m21:21:34.422841 [debug] [Thread-1 (]: On model.test_project.fact_sales: BEGIN
[0m21:21:34.423841 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:21:34.499683 [debug] [Thread-1 (]: SQL status: BEGIN in 0.076 seconds
[0m21:21:34.500682 [debug] [Thread-1 (]: Using postgres connection "model.test_project.fact_sales"
[0m21:21:34.500682 [debug] [Thread-1 (]: On model.test_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.fact_sales"} */

  create view "test_db"."public"."fact_sales__dbt_tmp"
    
    
  as (
    -- models/fact_sales.sql

WITH customer_sales AS (
    SELECT
        c.c_custkey AS customer_id,
        o.o_orderdate AS order_date,
        SUM(l.l_extendedprice) AS total_sales,
        SUM(l.l_discount) AS total_discount,
        SUM(l.l_quantity) AS total_quantity
    FROM
        lineitem l
    JOIN
        orders o ON l.l_orderkey = o.o_orderkey
    JOIN
        customer c ON o.o_custkey = c.c_custkey
    GROUP BY
        c.c_custkey, o.o_orderdate
)

SELECT
    customer_id,
    order_date,
    total_sales,
    total_discount,
    total_quantity
FROM
    customer_sales
ORDER BY
    order_date, customer_id
  );
[0m21:21:34.505187 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m21:21:34.510699 [debug] [Thread-1 (]: Using postgres connection "model.test_project.fact_sales"
[0m21:21:34.511706 [debug] [Thread-1 (]: On model.test_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.fact_sales"} */
alter table "test_db"."public"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m21:21:34.512705 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:21:34.526216 [debug] [Thread-1 (]: On model.test_project.fact_sales: COMMIT
[0m21:21:34.526216 [debug] [Thread-1 (]: Using postgres connection "model.test_project.fact_sales"
[0m21:21:34.527217 [debug] [Thread-1 (]: On model.test_project.fact_sales: COMMIT
[0m21:21:34.529217 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:21:34.536326 [debug] [Thread-1 (]: Applying DROP to: "test_db"."public"."fact_sales__dbt_backup"
[0m21:21:34.541267 [debug] [Thread-1 (]: Using postgres connection "model.test_project.fact_sales"
[0m21:21:34.542267 [debug] [Thread-1 (]: On model.test_project.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.fact_sales"} */
drop view if exists "test_db"."public"."fact_sales__dbt_backup" cascade
[0m21:21:34.543267 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m21:21:34.545266 [debug] [Thread-1 (]: On model.test_project.fact_sales: Close
[0m21:21:34.546480 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89afcdc9-b029-46a0-9c49-d421dbd5500e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288987B2420>]}
[0m21:21:34.547480 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.fact_sales ............................. [[32mCREATE VIEW[0m in 0.17s]
[0m21:21:34.548480 [debug] [Thread-1 (]: Finished running node model.test_project.fact_sales
[0m21:21:34.549480 [debug] [Thread-1 (]: Began running node model.test_project.sales_summary_by_customer
[0m21:21:34.550478 [info ] [Thread-1 (]: 2 of 3 START sql view model public.sales_summary_by_customer ................... [RUN]
[0m21:21:34.550982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.test_project.fact_sales, now model.test_project.sales_summary_by_customer)
[0m21:21:34.551986 [debug] [Thread-1 (]: Began compiling node model.test_project.sales_summary_by_customer
[0m21:21:34.553488 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_project.sales_summary_by_customer"
[0m21:21:34.555495 [debug] [Thread-1 (]: Began executing node model.test_project.sales_summary_by_customer
[0m21:21:34.558878 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_project.sales_summary_by_customer"
[0m21:21:34.561880 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_customer"
[0m21:21:34.562878 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_customer: BEGIN
[0m21:21:34.563881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:21:34.654727 [debug] [Thread-1 (]: SQL status: BEGIN in 0.092 seconds
[0m21:21:34.655726 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_customer"
[0m21:21:34.656796 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.sales_summary_by_customer"} */

  create view "test_db"."public"."sales_summary_by_customer__dbt_tmp"
    
    
  as (
    -- models/sales/sales_summary_by_customer.sql

SELECT
    c.c_custkey AS customer_id,
    c.c_name AS customer_name,
    SUM(l.l_extendedprice) AS total_sales,
    SUM(l.l_discount) AS total_discount,
    SUM(l.l_quantity) AS total_quantity_purchased
FROM
    lineitem l
JOIN
    orders o ON l.l_orderkey = o.o_orderkey
JOIN
    customer c ON o.o_custkey = c.c_custkey
GROUP BY
    c.c_custkey, c.c_name
ORDER BY
    total_sales DESC
  );
[0m21:21:34.661726 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m21:21:34.664725 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_customer"
[0m21:21:34.666228 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.sales_summary_by_customer"} */
alter table "test_db"."public"."sales_summary_by_customer" rename to "sales_summary_by_customer__dbt_backup"
[0m21:21:34.667232 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:21:34.669234 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_customer"
[0m21:21:34.670738 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.sales_summary_by_customer"} */
alter table "test_db"."public"."sales_summary_by_customer__dbt_tmp" rename to "sales_summary_by_customer"
[0m21:21:34.670738 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:21:34.674785 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_customer: COMMIT
[0m21:21:34.674785 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_customer"
[0m21:21:34.675787 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_customer: COMMIT
[0m21:21:34.677362 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:21:34.679297 [debug] [Thread-1 (]: Applying DROP to: "test_db"."public"."sales_summary_by_customer__dbt_backup"
[0m21:21:34.681298 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_customer"
[0m21:21:34.682296 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_customer: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.sales_summary_by_customer"} */
drop view if exists "test_db"."public"."sales_summary_by_customer__dbt_backup" cascade
[0m21:21:34.683298 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m21:21:34.684297 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_customer: Close
[0m21:21:34.685801 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89afcdc9-b029-46a0-9c49-d421dbd5500e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002889CAF0740>]}
[0m21:21:34.686806 [info ] [Thread-1 (]: 2 of 3 OK created sql view model public.sales_summary_by_customer .............. [[32mCREATE VIEW[0m in 0.13s]
[0m21:21:34.687806 [debug] [Thread-1 (]: Finished running node model.test_project.sales_summary_by_customer
[0m21:21:34.688806 [debug] [Thread-1 (]: Began running node model.test_project.sales_summary_by_date
[0m21:21:34.688806 [info ] [Thread-1 (]: 3 of 3 START sql view model public.sales_summary_by_date ....................... [RUN]
[0m21:21:34.689806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.test_project.sales_summary_by_customer, now model.test_project.sales_summary_by_date)
[0m21:21:34.690805 [debug] [Thread-1 (]: Began compiling node model.test_project.sales_summary_by_date
[0m21:21:34.692311 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_project.sales_summary_by_date"
[0m21:21:34.694311 [debug] [Thread-1 (]: Began executing node model.test_project.sales_summary_by_date
[0m21:21:34.697819 [debug] [Thread-1 (]: Writing runtime sql for node "model.test_project.sales_summary_by_date"
[0m21:21:34.699819 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_date"
[0m21:21:34.699819 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_date: BEGIN
[0m21:21:34.700820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:21:34.996184 [debug] [Thread-1 (]: SQL status: BEGIN in 0.296 seconds
[0m21:21:34.997191 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_date"
[0m21:21:34.998189 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_date: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.sales_summary_by_date"} */

  create view "test_db"."public"."sales_summary_by_date__dbt_tmp"
    
    
  as (
    -- models/sales/sales_summary_by_date.sql

SELECT
    o.o_orderdate AS order_date,
    SUM(l.l_extendedprice) AS total_sales,
    SUM(l.l_discount) AS total_discount,
    SUM(l.l_quantity) AS total_quantity_sold
FROM
    lineitem l
JOIN
    orders o ON l.l_orderkey = o.o_orderkey
GROUP BY
    o.o_orderdate
ORDER BY
    o.o_orderdate
  );
[0m21:21:35.002188 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m21:21:35.004190 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_date"
[0m21:21:35.005697 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_date: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.sales_summary_by_date"} */
alter table "test_db"."public"."sales_summary_by_date" rename to "sales_summary_by_date__dbt_backup"
[0m21:21:35.006703 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:21:35.008704 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_date"
[0m21:21:35.009704 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_date: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.sales_summary_by_date"} */
alter table "test_db"."public"."sales_summary_by_date__dbt_tmp" rename to "sales_summary_by_date"
[0m21:21:35.010703 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:21:35.011839 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_date: COMMIT
[0m21:21:35.012839 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_date"
[0m21:21:35.013838 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_date: COMMIT
[0m21:21:35.014837 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:21:35.016839 [debug] [Thread-1 (]: Applying DROP to: "test_db"."public"."sales_summary_by_date__dbt_backup"
[0m21:21:35.017839 [debug] [Thread-1 (]: Using postgres connection "model.test_project.sales_summary_by_date"
[0m21:21:35.017839 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_date: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "node_id": "model.test_project.sales_summary_by_date"} */
drop view if exists "test_db"."public"."sales_summary_by_date__dbt_backup" cascade
[0m21:21:35.019839 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m21:21:35.020839 [debug] [Thread-1 (]: On model.test_project.sales_summary_by_date: Close
[0m21:21:35.021838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89afcdc9-b029-46a0-9c49-d421dbd5500e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002889CAD3D40>]}
[0m21:21:35.022837 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.sales_summary_by_date .................. [[32mCREATE VIEW[0m in 0.33s]
[0m21:21:35.023841 [debug] [Thread-1 (]: Finished running node model.test_project.sales_summary_by_date
[0m21:21:35.025346 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:35.025346 [debug] [MainThread]: On master: BEGIN
[0m21:21:35.026353 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:21:35.212992 [debug] [MainThread]: SQL status: BEGIN in 0.187 seconds
[0m21:21:35.214283 [debug] [MainThread]: On master: COMMIT
[0m21:21:35.214283 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:35.215284 [debug] [MainThread]: On master: COMMIT
[0m21:21:35.215284 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:21:35.216284 [debug] [MainThread]: On master: Close
[0m21:21:35.217285 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:21:35.217285 [debug] [MainThread]: Connection 'list_test_db' was properly closed.
[0m21:21:35.218318 [debug] [MainThread]: Connection 'list_test_db_public' was properly closed.
[0m21:21:35.219318 [debug] [MainThread]: Connection 'model.test_project.sales_summary_by_date' was properly closed.
[0m21:21:35.219318 [info ] [MainThread]: 
[0m21:21:35.220317 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 1.28 seconds (1.28s).
[0m21:21:35.222318 [debug] [MainThread]: Command end result
[0m21:21:35.251512 [info ] [MainThread]: 
[0m21:21:35.252512 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:21:35.252512 [info ] [MainThread]: 
[0m21:21:35.253513 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:21:35.255512 [debug] [MainThread]: Command `dbt run` succeeded at 21:21:35.255512 after 2.20 seconds
[0m21:21:35.256579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002889AC65D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002889A921760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002889A9219D0>]}
[0m21:21:35.256579 [debug] [MainThread]: Flushing usage events
[0m21:23:43.305534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2DC8F1D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2DF469580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2DC8F2390>]}


============================== 21:23:43.310540 | 948bd89b-4905-4eec-86fa-6ecfb36e1457 ==============================
[0m21:23:43.310540 [info ] [MainThread]: Running with dbt=1.8.6
[0m21:23:43.311544 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:23:43.530264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '948bd89b-4905-4eec-86fa-6ecfb36e1457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2DF341F70>]}
[0m21:23:43.577414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '948bd89b-4905-4eec-86fa-6ecfb36e1457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E03B02F0>]}
[0m21:23:43.578414 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:23:43.586937 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m21:23:43.769033 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m21:23:43.769033 [debug] [MainThread]: Partial parsing: added file: test_project://test_project/models\fact_tables\schema.yml
[0m21:23:43.816585 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:23:43.818586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '948bd89b-4905-4eec-86fa-6ecfb36e1457', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E0548CE0>]}
[0m21:23:43.932887 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.test_project.relationships_fact_sales_total_sales__customer_id__ref_customers_.ccfe017bcb' (test_project/models\fact_tables\schema.yml) depends on a node named 'customers' in package '' which was not found
[0m21:23:43.977248 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.test_project.example
[0m21:23:43.982249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '948bd89b-4905-4eec-86fa-6ecfb36e1457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E1805820>]}
[0m21:23:44.017313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '948bd89b-4905-4eec-86fa-6ecfb36e1457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E1859C70>]}
[0m21:23:44.018312 [info ] [MainThread]: Found 3 models, 6 data tests, 417 macros
[0m21:23:44.019312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '948bd89b-4905-4eec-86fa-6ecfb36e1457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E1628D70>]}
[0m21:23:44.021313 [info ] [MainThread]: 
[0m21:23:44.022310 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:23:44.025312 [debug] [ThreadPool]: Acquiring new postgres connection 'list_test_db_public'
[0m21:23:44.204623 [debug] [ThreadPool]: Using postgres connection "list_test_db_public"
[0m21:23:44.205625 [debug] [ThreadPool]: On list_test_db_public: BEGIN
[0m21:23:44.206133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:23:44.286757 [debug] [ThreadPool]: SQL status: BEGIN in 0.081 seconds
[0m21:23:44.287758 [debug] [ThreadPool]: Using postgres connection "list_test_db_public"
[0m21:23:44.287758 [debug] [ThreadPool]: On list_test_db_public: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "list_test_db_public"} */
select
      'test_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'test_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'test_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:23:44.292757 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.005 seconds
[0m21:23:44.295266 [debug] [ThreadPool]: On list_test_db_public: ROLLBACK
[0m21:23:44.296273 [debug] [ThreadPool]: On list_test_db_public: Close
[0m21:23:44.302272 [debug] [MainThread]: Using postgres connection "master"
[0m21:23:44.303275 [debug] [MainThread]: On master: BEGIN
[0m21:23:44.303275 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:23:44.377070 [debug] [MainThread]: SQL status: BEGIN in 0.074 seconds
[0m21:23:44.378073 [debug] [MainThread]: Using postgres connection "master"
[0m21:23:44.379071 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:23:44.386582 [debug] [MainThread]: SQL status: SELECT 8 in 0.006 seconds
[0m21:23:44.388582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '948bd89b-4905-4eec-86fa-6ecfb36e1457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E17DA6C0>]}
[0m21:23:44.389583 [debug] [MainThread]: On master: ROLLBACK
[0m21:23:44.390584 [debug] [MainThread]: On master: Close
[0m21:23:44.391584 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:23:44.392585 [info ] [MainThread]: 
[0m21:23:44.395583 [debug] [Thread-1 (]: Began running node model.test_project.fact_sales
[0m21:23:44.396832 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.test_project.fact_sales'
[0m21:23:44.397831 [debug] [Thread-1 (]: Began compiling node model.test_project.fact_sales
[0m21:23:44.403836 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_project.fact_sales"
[0m21:23:44.406348 [debug] [Thread-1 (]: Began executing node model.test_project.fact_sales
[0m21:23:44.407348 [debug] [Thread-1 (]: Finished running node model.test_project.fact_sales
[0m21:23:44.408348 [debug] [Thread-1 (]: Began running node model.test_project.sales_summary_by_customer
[0m21:23:44.409349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.test_project.fact_sales, now model.test_project.sales_summary_by_customer)
[0m21:23:44.410349 [debug] [Thread-1 (]: Began compiling node model.test_project.sales_summary_by_customer
[0m21:23:44.413349 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_project.sales_summary_by_customer"
[0m21:23:44.415852 [debug] [Thread-1 (]: Began executing node model.test_project.sales_summary_by_customer
[0m21:23:44.416857 [debug] [Thread-1 (]: Finished running node model.test_project.sales_summary_by_customer
[0m21:23:44.417862 [debug] [Thread-1 (]: Began running node model.test_project.sales_summary_by_date
[0m21:23:44.417862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.test_project.sales_summary_by_customer, now model.test_project.sales_summary_by_date)
[0m21:23:44.418862 [debug] [Thread-1 (]: Began compiling node model.test_project.sales_summary_by_date
[0m21:23:44.420863 [debug] [Thread-1 (]: Writing injected SQL for node "model.test_project.sales_summary_by_date"
[0m21:23:44.422862 [debug] [Thread-1 (]: Began executing node model.test_project.sales_summary_by_date
[0m21:23:44.423861 [debug] [Thread-1 (]: Finished running node model.test_project.sales_summary_by_date
[0m21:23:44.425366 [debug] [Thread-1 (]: Began running node test.test_project.not_null_fact_sales_customer_id.39febb61fd
[0m21:23:44.425366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.test_project.sales_summary_by_date, now test.test_project.not_null_fact_sales_customer_id.39febb61fd)
[0m21:23:44.426372 [debug] [Thread-1 (]: Began compiling node test.test_project.not_null_fact_sales_customer_id.39febb61fd
[0m21:23:44.435879 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_project.not_null_fact_sales_customer_id.39febb61fd"
[0m21:23:44.439885 [debug] [Thread-1 (]: Began executing node test.test_project.not_null_fact_sales_customer_id.39febb61fd
[0m21:23:44.440887 [debug] [Thread-1 (]: Finished running node test.test_project.not_null_fact_sales_customer_id.39febb61fd
[0m21:23:44.441886 [debug] [Thread-1 (]: Began running node test.test_project.not_null_fact_sales_order_date.d04f309174
[0m21:23:44.442886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_project.not_null_fact_sales_customer_id.39febb61fd, now test.test_project.not_null_fact_sales_order_date.d04f309174)
[0m21:23:44.443885 [debug] [Thread-1 (]: Began compiling node test.test_project.not_null_fact_sales_order_date.d04f309174
[0m21:23:44.447397 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_project.not_null_fact_sales_order_date.d04f309174"
[0m21:23:44.450397 [debug] [Thread-1 (]: Began executing node test.test_project.not_null_fact_sales_order_date.d04f309174
[0m21:23:44.451399 [debug] [Thread-1 (]: Finished running node test.test_project.not_null_fact_sales_order_date.d04f309174
[0m21:23:44.452398 [debug] [Thread-1 (]: Began running node test.test_project.not_null_fact_sales_total_sales.2feb308531
[0m21:23:44.452398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_project.not_null_fact_sales_order_date.d04f309174, now test.test_project.not_null_fact_sales_total_sales.2feb308531)
[0m21:23:44.453399 [debug] [Thread-1 (]: Began compiling node test.test_project.not_null_fact_sales_total_sales.2feb308531
[0m21:23:44.457909 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_project.not_null_fact_sales_total_sales.2feb308531"
[0m21:23:44.460910 [debug] [Thread-1 (]: Began executing node test.test_project.not_null_fact_sales_total_sales.2feb308531
[0m21:23:44.461915 [debug] [Thread-1 (]: Finished running node test.test_project.not_null_fact_sales_total_sales.2feb308531
[0m21:23:44.461915 [debug] [Thread-1 (]: Began running node test.test_project.not_null_sales_summary_by_customer_customer_id.c48f3694b9
[0m21:23:44.462914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_project.not_null_fact_sales_total_sales.2feb308531, now test.test_project.not_null_sales_summary_by_customer_customer_id.c48f3694b9)
[0m21:23:44.463915 [debug] [Thread-1 (]: Began compiling node test.test_project.not_null_sales_summary_by_customer_customer_id.c48f3694b9
[0m21:23:44.467938 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_project.not_null_sales_summary_by_customer_customer_id.c48f3694b9"
[0m21:23:44.469946 [debug] [Thread-1 (]: Began executing node test.test_project.not_null_sales_summary_by_customer_customer_id.c48f3694b9
[0m21:23:44.470946 [debug] [Thread-1 (]: Finished running node test.test_project.not_null_sales_summary_by_customer_customer_id.c48f3694b9
[0m21:23:44.471946 [debug] [Thread-1 (]: Began running node test.test_project.unique_sales_summary_by_customer_customer_id.86e57d5912
[0m21:23:44.471946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_project.not_null_sales_summary_by_customer_customer_id.c48f3694b9, now test.test_project.unique_sales_summary_by_customer_customer_id.86e57d5912)
[0m21:23:44.472946 [debug] [Thread-1 (]: Began compiling node test.test_project.unique_sales_summary_by_customer_customer_id.86e57d5912
[0m21:23:44.479457 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_project.unique_sales_summary_by_customer_customer_id.86e57d5912"
[0m21:23:44.482459 [debug] [Thread-1 (]: Began executing node test.test_project.unique_sales_summary_by_customer_customer_id.86e57d5912
[0m21:23:44.483462 [debug] [Thread-1 (]: Finished running node test.test_project.unique_sales_summary_by_customer_customer_id.86e57d5912
[0m21:23:44.484462 [debug] [Thread-1 (]: Began running node test.test_project.not_null_sales_summary_by_date_order_date.cc12b38f8e
[0m21:23:44.484462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.test_project.unique_sales_summary_by_customer_customer_id.86e57d5912, now test.test_project.not_null_sales_summary_by_date_order_date.cc12b38f8e)
[0m21:23:44.485973 [debug] [Thread-1 (]: Began compiling node test.test_project.not_null_sales_summary_by_date_order_date.cc12b38f8e
[0m21:23:44.489979 [debug] [Thread-1 (]: Writing injected SQL for node "test.test_project.not_null_sales_summary_by_date_order_date.cc12b38f8e"
[0m21:23:44.491983 [debug] [Thread-1 (]: Began executing node test.test_project.not_null_sales_summary_by_date_order_date.cc12b38f8e
[0m21:23:44.492982 [debug] [Thread-1 (]: Finished running node test.test_project.not_null_sales_summary_by_date_order_date.cc12b38f8e
[0m21:23:44.493982 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:23:44.495547 [debug] [MainThread]: Connection 'list_test_db_public' was properly closed.
[0m21:23:44.496497 [debug] [MainThread]: Connection 'test.test_project.not_null_sales_summary_by_date_order_date.cc12b38f8e' was properly closed.
[0m21:23:44.498495 [debug] [MainThread]: Command end result
[0m21:23:44.575003 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m21:23:44.575519 [info ] [MainThread]: Building catalog
[0m21:23:44.582527 [debug] [ThreadPool]: Acquiring new postgres connection 'test_db.information_schema'
[0m21:23:44.589042 [debug] [ThreadPool]: Using postgres connection "test_db.information_schema"
[0m21:23:44.589042 [debug] [ThreadPool]: On test_db.information_schema: BEGIN
[0m21:23:44.590639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:23:44.668257 [debug] [ThreadPool]: SQL status: BEGIN in 0.078 seconds
[0m21:23:44.669265 [debug] [ThreadPool]: Using postgres connection "test_db.information_schema"
[0m21:23:44.671263 [debug] [ThreadPool]: On test_db.information_schema: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "test_project", "target_name": "dev", "connection_name": "test_db.information_schema"} */

    
    

    select
        'test_db' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('fact_sales')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('sales_summary_by_date')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('sales_summary_by_customer')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m21:23:44.678779 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.007 seconds
[0m21:23:44.682774 [debug] [ThreadPool]: On test_db.information_schema: ROLLBACK
[0m21:23:44.683775 [debug] [ThreadPool]: On test_db.information_schema: Close
[0m21:23:44.716418 [info ] [MainThread]: Catalog written to C:\Users\Thomas\OneDrive - Aarhus universitet\Data Engineering\dbt-test\target\catalog.json
[0m21:23:44.719421 [debug] [MainThread]: Command `dbt docs generate` succeeded at 21:23:44.719421 after 1.57 seconds
[0m21:23:44.719421 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m21:23:44.720421 [debug] [MainThread]: Connection 'test_db.information_schema' was properly closed.
[0m21:23:44.721420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E03930E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2E17319A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2DF7EFE60>]}
[0m21:23:44.721420 [debug] [MainThread]: Flushing usage events
[0m21:23:59.354073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C687F3DBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C689C0CD40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C689C0C770>]}


============================== 21:23:59.358745 | c467dab5-b94a-4f92-8d79-61c4fbf2c2d7 ==============================
[0m21:23:59.358745 [info ] [MainThread]: Running with dbt=1.8.6
[0m21:23:59.359793 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Thomas\\OneDrive - Aarhus universitet\\Data Engineering\\dbt-test\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:23:59.571689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c467dab5-b94a-4f92-8d79-61c4fbf2c2d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C68AC073E0>]}
[0m21:23:59.617882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c467dab5-b94a-4f92-8d79-61c4fbf2c2d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C68AF6B1A0>]}
[0m21:25:20.198415 [error] [MainThread]: Encountered an error:

[0m21:25:20.203759 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Thomas\anaconda3\envs\dbtTest\Lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Thomas\anaconda3\envs\dbtTest\Lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Thomas\anaconda3\envs\dbtTest\Lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Thomas\anaconda3\envs\dbtTest\Lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Thomas\anaconda3\envs\dbtTest\Lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Thomas\anaconda3\envs\dbtTest\Lib\site-packages\dbt\cli\main.py", line 303, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\Thomas\anaconda3\envs\dbtTest\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\Thomas\anaconda3\envs\dbtTest\Lib\socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Thomas\anaconda3\envs\dbtTest\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Thomas\anaconda3\envs\dbtTest\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m21:25:20.207273 [debug] [MainThread]: Command `dbt docs serve` failed at 21:25:20.207273 after 81.00 seconds
[0m21:25:20.208278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C68AADD3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C68AFE58E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C68ACF2810>]}
[0m21:25:20.209279 [debug] [MainThread]: Flushing usage events
